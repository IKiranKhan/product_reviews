[0m22:29:21.994062 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column reviews_stag.review_likes does not exist
LINE 23: reviews_stag.review_likes as review_likes,
         ^

[0m22:29:22.002780 [debug] [Thread-1 (]: Timing info for model.Product_Reviews_DWH.product_reviews_fact (execute): 2023-04-03 22:29:21.909642 => 2023-04-03 22:29:22.002780
[0m22:29:22.003781 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: Close
[0m22:29:22.041968 [debug] [Thread-1 (]: Database Error in model product_reviews_fact (models\fact\product_reviews_fact.sql)
  column reviews_stag.review_likes does not exist
  LINE 23: reviews_stag.review_likes as review_likes,
           ^
[0m22:29:22.046099 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40662b93-10f4-49d7-997c-990f5e59eb38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017292B6D300>]}
[0m22:29:22.047058 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model justeattakeaway.product_reviews_fact  [[31mERROR[0m in 0.62s]
[0m22:29:22.049746 [debug] [Thread-1 (]: Finished running node model.Product_Reviews_DWH.product_reviews_fact
[0m22:29:22.051902 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:29:22.053134 [debug] [MainThread]: Using postgres connection "master"
[0m22:29:22.053134 [debug] [MainThread]: On master: BEGIN
[0m22:29:22.053134 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:29:22.112552 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:29:22.114068 [debug] [MainThread]: On master: COMMIT
[0m22:29:22.114068 [debug] [MainThread]: Using postgres connection "master"
[0m22:29:22.114068 [debug] [MainThread]: On master: COMMIT
[0m22:29:22.115624 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:29:22.115624 [debug] [MainThread]: On master: Close
[0m22:29:22.116632 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:29:22.116632 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m22:29:22.117627 [debug] [MainThread]: Connection 'list_postgres_justeattakeaway' was properly closed.
[0m22:29:22.117627 [debug] [MainThread]: Connection 'model.Product_Reviews_DWH.product_reviews_fact' was properly closed.
[0m22:29:22.118622 [info ] [MainThread]: 
[0m22:29:22.119626 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 1.10 seconds (1.10s).
[0m22:29:22.120836 [debug] [MainThread]: Command end result
[0m22:29:22.135143 [info ] [MainThread]: 
[0m22:29:22.137146 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:29:22.138149 [info ] [MainThread]: 
[0m22:29:22.138459 [error] [MainThread]: [33mDatabase Error in model product_reviews_fact (models\fact\product_reviews_fact.sql)[0m
[0m22:29:22.139732 [error] [MainThread]:   column reviews_stag.review_likes does not exist
[0m22:29:22.140734 [error] [MainThread]:   LINE 23: reviews_stag.review_likes as review_likes,
[0m22:29:22.142732 [error] [MainThread]:            ^
[0m22:29:22.143735 [info ] [MainThread]: 
[0m22:29:22.143735 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m22:29:22.145740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000172927A0EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001728ED6A9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017292B6D120>]}
[0m22:29:22.146741 [debug] [MainThread]: Flushing usage events


============================== 2023-04-03 22:33:05.245745 | 75d8bd80-f151-4598-9796-8eacb180beda ==============================
[0m22:33:05.245745 [info ] [MainThread]: Running with dbt=1.4.5
[0m22:33:05.253427 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Furqan\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['fact'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m22:33:05.254478 [debug] [MainThread]: Tracking: tracking
[0m22:33:05.279486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DEEBDFCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DEEBDE500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DEEBDED10>]}
[0m22:33:05.294650 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m22:33:05.437196 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:33:05.437196 [debug] [MainThread]: Partial parsing: updated file: Product_Reviews_DWH://models\fact\product_reviews_fact.sql
[0m22:33:05.450796 [debug] [MainThread]: 1603: static parser failed on fact\product_reviews_fact.sql
[0m22:33:05.482683 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fact\product_reviews_fact.sql
[0m22:33:05.545659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '75d8bd80-f151-4598-9796-8eacb180beda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DEB5280D0>]}
[0m22:33:05.568136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '75d8bd80-f151-4598-9796-8eacb180beda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DEEEA9240>]}
[0m22:33:05.572035 [info ] [MainThread]: Found 6 models, 59 tests, 1 snapshot, 0 analyses, 403 macros, 0 operations, 0 seed files, 10 sources, 0 exposures, 0 metrics
[0m22:33:05.574232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75d8bd80-f151-4598-9796-8eacb180beda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DEB45AA10>]}
[0m22:33:05.576786 [info ] [MainThread]: 
[0m22:33:05.580235 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:33:05.582239 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m22:33:05.601826 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m22:33:05.601826 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m22:33:05.602869 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:33:05.670913 [debug] [ThreadPool]: SQL status: SELECT 25 in 0 seconds
[0m22:33:05.674024 [debug] [ThreadPool]: On list_postgres: Close
[0m22:33:05.677204 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_justeattakeaway'
[0m22:33:05.685081 [debug] [ThreadPool]: Using postgres connection "list_postgres_justeattakeaway"
[0m22:33:05.685962 [debug] [ThreadPool]: On list_postgres_justeattakeaway: BEGIN
[0m22:33:05.685962 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:33:05.744326 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m22:33:05.745327 [debug] [ThreadPool]: Using postgres connection "list_postgres_justeattakeaway"
[0m22:33:05.745327 [debug] [ThreadPool]: On list_postgres_justeattakeaway: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "connection_name": "list_postgres_justeattakeaway"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'justeattakeaway'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'justeattakeaway'
  
[0m22:33:05.755579 [debug] [ThreadPool]: SQL status: SELECT 492 in 0 seconds
[0m22:33:05.758443 [debug] [ThreadPool]: On list_postgres_justeattakeaway: ROLLBACK
[0m22:33:05.768408 [debug] [ThreadPool]: On list_postgres_justeattakeaway: Close
[0m22:33:05.870960 [debug] [MainThread]: Using postgres connection "master"
[0m22:33:05.870960 [debug] [MainThread]: On master: BEGIN
[0m22:33:05.876259 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:33:05.935416 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:33:05.937045 [debug] [MainThread]: Using postgres connection "master"
[0m22:33:05.937045 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:33:05.984822 [debug] [MainThread]: SQL status: SELECT 9 in 0 seconds
[0m22:33:05.984822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75d8bd80-f151-4598-9796-8eacb180beda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DEECC9D50>]}
[0m22:33:05.984822 [debug] [MainThread]: On master: ROLLBACK
[0m22:33:05.993246 [debug] [MainThread]: Using postgres connection "master"
[0m22:33:05.993246 [debug] [MainThread]: On master: BEGIN
[0m22:33:05.994368 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:33:05.995368 [debug] [MainThread]: On master: COMMIT
[0m22:33:05.995368 [debug] [MainThread]: Using postgres connection "master"
[0m22:33:05.996370 [debug] [MainThread]: On master: COMMIT
[0m22:33:05.997368 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:33:05.998371 [debug] [MainThread]: On master: Close
[0m22:33:05.999562 [info ] [MainThread]: Concurrency: 3 threads (target='prod')
[0m22:33:05.999943 [info ] [MainThread]: 
[0m22:33:06.008052 [debug] [Thread-1 (]: Began running node model.Product_Reviews_DWH.product_reviews_fact
[0m22:33:06.009052 [info ] [Thread-1 (]: 1 of 1 START sql incremental model justeattakeaway.product_reviews_fact ........ [RUN]
[0m22:33:06.011107 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Product_Reviews_DWH.product_reviews_fact'
[0m22:33:06.011107 [debug] [Thread-1 (]: Began compiling node model.Product_Reviews_DWH.product_reviews_fact
[0m22:33:06.034271 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.product_reviews_fact"
[0m22:33:06.034271 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "node_id": "model.Product_Reviews_DWH.product_reviews_fact"} */

        select coalesce(max(sk_product_reviews_fact),0) from  "postgres"."justeattakeaway"."product_reviews_fact"
    
[0m22:33:06.039504 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:33:06.528654 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0 seconds
[0m22:33:06.528654 [debug] [Thread-1 (]: Writing injected SQL for node "model.Product_Reviews_DWH.product_reviews_fact"
[0m22:33:06.528654 [debug] [Thread-1 (]: Timing info for model.Product_Reviews_DWH.product_reviews_fact (compile): 2023-04-03 22:33:06.012104 => 2023-04-03 22:33:06.528654
[0m22:33:06.528654 [debug] [Thread-1 (]: Began executing node model.Product_Reviews_DWH.product_reviews_fact
[0m22:33:06.602785 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.product_reviews_fact"
[0m22:33:06.602785 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "node_id": "model.Product_Reviews_DWH.product_reviews_fact"} */

    
  
    

  create temporary table "product_reviews_fact__dbt_tmp013306572141"
  as (
    

    

SELECT  
row_number() over()+0 as sk_product_reviews_fact,
'2004-01-01' as date,
prd_dim.sk_product_dim as sk_product_dim,
category.sk_category_dim as sk_category_dim,
prd_bucket.sk_price_bucket_dim as sk_price_bucket_dim,
reviewer_dim.sk_reviewer_dim as sk_reviewer_dim,
prd_dim_stg.price as product_price,
prd_dim_stg.sales_rank as sales_rank,
reviews_stag.overall as overall_rating,
reviews_stag.up_votes as review_likes,
reviews_stag.down_votes as review_dislikes,
prd_dim_stg.viewed_and_bought_count as viewed_and_bought_count
-- products dim table
FROM "postgres"."justeattakeaway"."products_dimension"  prd_dim
-- products staging table
JOIN "postgres"."justeattakeaway"."products_dim_staging"  prd_dim_stg 
ON prd_dim.asin = prd_dim_stg.asin
-- products category dim table
left join "postgres"."justeattakeaway"."product_category_dimension"  category
ON prd_dim_stg.category= category.category and prd_dim_stg.sub_category = category.sub_category 
-- price bucket dim table
LEFT JOIN "postgres"."justeattakeaway"."price_bucket_dimension"  prd_bucket
ON prd_dim_stg.price >= prd_bucket.bucket_lower_limit  and  prd_dim_stg.price<=prd_bucket.bucket_upper_limit
-- reviews staging table
LEFT JOIN "postgres"."justeattakeaway"."reviews_dim_staging"  as reviews_stag
ON prd_dim.asin = reviews_stag.asin and reviews_stag.review_date = '2004-01-01'
-- reviewer dim table
LEFT JOIN "postgres"."justeattakeaway"."reviewer_dimension"  reviewer_dim
ON reviews_stag.reviewerid =reviewer_dim.reviewerid and reviews_stag.review_date >=reviewer_dim.valid_from and reviews_stag.review_date <reviewer_dim.valid_to
  );
  
  
[0m22:34:46.663546 [debug] [Thread-1 (]: SQL status: SELECT 9430404 in 100 seconds
[0m22:34:46.681669 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.product_reviews_fact"
[0m22:34:46.682678 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: BEGIN
[0m22:34:46.685356 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m22:34:46.685356 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.product_reviews_fact"
[0m22:34:46.685356 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "node_id": "model.Product_Reviews_DWH.product_reviews_fact"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'product_reviews_fact__dbt_tmp013306572141'
        
      order by ordinal_position

  
[0m22:34:46.707072 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0 seconds
[0m22:34:46.708080 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.product_reviews_fact"
[0m22:34:46.708080 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "node_id": "model.Product_Reviews_DWH.product_reviews_fact"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'product_reviews_fact'
        
        and table_schema = 'justeattakeaway'
        
      order by ordinal_position

  
[0m22:34:46.708080 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0 seconds
[0m22:34:46.741800 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.product_reviews_fact"
[0m22:34:46.741800 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "node_id": "model.Product_Reviews_DWH.product_reviews_fact"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'product_reviews_fact__dbt_tmp013306572141'
        
      order by ordinal_position

  
[0m22:34:46.741800 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0 seconds
[0m22:34:46.757693 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.product_reviews_fact"
[0m22:34:46.758716 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "node_id": "model.Product_Reviews_DWH.product_reviews_fact"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'product_reviews_fact'
        
        and table_schema = 'justeattakeaway'
        
      order by ordinal_position

  
[0m22:34:46.758716 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0 seconds
[0m22:34:46.766196 [debug] [Thread-1 (]: 
    In "postgres"."justeattakeaway"."product_reviews_fact":
        Schema changed: True
        Source columns not in target: []
        Target columns not in source: []
        New column types: [{'column_name': 'date', 'new_type': 'text'}, {'column_name': 'sk_reviewer_dim', 'new_type': 'bigint'}, {'column_name': 'sales_rank', 'new_type': 'bigint'}, {'column_name': 'overall_rating', 'new_type': 'double precision'}, {'column_name': 'viewed_and_bought_count', 'new_type': 'smallint'}]
  
[0m22:34:46.766196 [debug] [Thread-1 (]: Timing info for model.Product_Reviews_DWH.product_reviews_fact (execute): 2023-04-03 22:33:06.533783 => 2023-04-03 22:34:46.766196
[0m22:34:46.782114 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: ROLLBACK
[0m22:34:46.866136 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: Close
[0m22:34:46.908061 [debug] [Thread-1 (]: Compilation Error in model product_reviews_fact (models\fact\product_reviews_fact.sql)
  
                The source and target schemas on this incremental model are out of sync!
                They can be reconciled in several ways:
                  - set the `on_schema_change` config to either append_new_columns or sync_all_columns, depending on your situation.
                  - Re-run the incremental model with `full_refresh: True` to update the target schema.
                  - update the schema manually and re-run the process.
  
                Additional troubleshooting context:
                   Source columns not in target: []
                   Target columns not in source: []
                   New column types: [{'column_name': 'date', 'new_type': 'text'}, {'column_name': 'sk_reviewer_dim', 'new_type': 'bigint'}, {'column_name': 'sales_rank', 'new_type': 'bigint'}, {'column_name': 'overall_rating', 'new_type': 'double precision'}, {'column_name': 'viewed_and_bought_count', 'new_type': 'smallint'}]
            
  
  > in macro process_schema_changes (macros\materializations\models\incremental\on_schema_change.sql)
  > called by macro materialization_incremental_default (macros\materializations\models\incremental\incremental.sql)
  > called by model product_reviews_fact (models\fact\product_reviews_fact.sql)
[0m22:34:46.908061 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75d8bd80-f151-4598-9796-8eacb180beda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DEF2337F0>]}
[0m22:34:46.917308 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model justeattakeaway.product_reviews_fact  [[31mERROR[0m in 100.90s]
[0m22:34:46.918314 [debug] [Thread-1 (]: Finished running node model.Product_Reviews_DWH.product_reviews_fact
[0m22:34:46.925320 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:34:46.925320 [debug] [MainThread]: Using postgres connection "master"
[0m22:34:46.926320 [debug] [MainThread]: On master: BEGIN
[0m22:34:46.926320 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:34:46.997356 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:34:46.999356 [debug] [MainThread]: On master: COMMIT
[0m22:34:46.999356 [debug] [MainThread]: Using postgres connection "master"
[0m22:34:46.999356 [debug] [MainThread]: On master: COMMIT
[0m22:34:46.999356 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:34:46.999356 [debug] [MainThread]: On master: Close
[0m22:34:46.999356 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:34:46.999356 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m22:34:47.004481 [debug] [MainThread]: Connection 'list_postgres_justeattakeaway' was properly closed.
[0m22:34:47.004481 [debug] [MainThread]: Connection 'model.Product_Reviews_DWH.product_reviews_fact' was properly closed.
[0m22:34:47.005484 [info ] [MainThread]: 
[0m22:34:47.006112 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 1 minutes and 41.43 seconds (101.43s).
[0m22:34:47.008149 [debug] [MainThread]: Command end result
[0m22:34:47.028166 [info ] [MainThread]: 
[0m22:34:47.028166 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:34:47.031299 [info ] [MainThread]: 
[0m22:34:47.032302 [error] [MainThread]: [33mCompilation Error in model product_reviews_fact (models\fact\product_reviews_fact.sql)[0m
[0m22:34:47.033150 [error] [MainThread]:   
[0m22:34:47.034626 [error] [MainThread]:                 The source and target schemas on this incremental model are out of sync!
[0m22:34:47.035629 [error] [MainThread]:                 They can be reconciled in several ways:
[0m22:34:47.035629 [error] [MainThread]:                   - set the `on_schema_change` config to either append_new_columns or sync_all_columns, depending on your situation.
[0m22:34:47.035629 [error] [MainThread]:                   - Re-run the incremental model with `full_refresh: True` to update the target schema.
[0m22:34:47.035629 [error] [MainThread]:                   - update the schema manually and re-run the process.
[0m22:34:47.035629 [error] [MainThread]:   
[0m22:34:47.035629 [error] [MainThread]:                 Additional troubleshooting context:
[0m22:34:47.035629 [error] [MainThread]:                    Source columns not in target: []
[0m22:34:47.043828 [error] [MainThread]:                    Target columns not in source: []
[0m22:34:47.044822 [error] [MainThread]:                    New column types: [{'column_name': 'date', 'new_type': 'text'}, {'column_name': 'sk_reviewer_dim', 'new_type': 'bigint'}, {'column_name': 'sales_rank', 'new_type': 'bigint'}, {'column_name': 'overall_rating', 'new_type': 'double precision'}, {'column_name': 'viewed_and_bought_count', 'new_type': 'smallint'}]
[0m22:34:47.045825 [error] [MainThread]:             
[0m22:34:47.045825 [error] [MainThread]:   
[0m22:34:47.050233 [error] [MainThread]:   > in macro process_schema_changes (macros\materializations\models\incremental\on_schema_change.sql)
[0m22:34:47.051271 [error] [MainThread]:   > called by macro materialization_incremental_default (macros\materializations\models\incremental\incremental.sql)
[0m22:34:47.051271 [error] [MainThread]:   > called by model product_reviews_fact (models\fact\product_reviews_fact.sql)
[0m22:34:47.051271 [info ] [MainThread]: 
[0m22:34:47.051271 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m22:34:47.051271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DEB45A9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DEF2D1D80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DEF2D3400>]}
[0m22:34:47.051271 [debug] [MainThread]: Flushing usage events


============================== 2023-04-04 05:24:20.964459 | 7f45a601-2a70-4637-8fd2-2b5b8fb1a550 ==============================
[0m05:24:20.964459 [info ] [MainThread]: Running with dbt=1.4.5
[0m05:24:20.964459 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Furqan\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['fact'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m05:24:20.971553 [debug] [MainThread]: Tracking: tracking
[0m05:24:20.982970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019950D8E290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019950D8E3E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019950D8DC30>]}
[0m05:24:20.994968 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m05:24:21.088896 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:24:21.088896 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:24:21.105889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f45a601-2a70-4637-8fd2-2b5b8fb1a550', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001994D673DF0>]}
[0m05:24:21.105889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f45a601-2a70-4637-8fd2-2b5b8fb1a550', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019950F5B310>]}
[0m05:24:21.105889 [info ] [MainThread]: Found 6 models, 59 tests, 1 snapshot, 0 analyses, 403 macros, 0 operations, 0 seed files, 10 sources, 0 exposures, 0 metrics
[0m05:24:21.105889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f45a601-2a70-4637-8fd2-2b5b8fb1a550', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019950F5B1F0>]}
[0m05:24:21.121569 [info ] [MainThread]: 
[0m05:24:21.123193 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:24:21.123737 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m05:24:21.123737 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m05:24:21.123737 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m05:24:21.123737 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:24:21.181255 [debug] [ThreadPool]: SQL status: SELECT 25 in 0 seconds
[0m05:24:21.183257 [debug] [ThreadPool]: On list_postgres: Close
[0m05:24:21.185254 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_justeattakeaway'
[0m05:24:21.189253 [debug] [ThreadPool]: Using postgres connection "list_postgres_justeattakeaway"
[0m05:24:21.190254 [debug] [ThreadPool]: On list_postgres_justeattakeaway: BEGIN
[0m05:24:21.190254 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:24:21.207192 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m05:24:21.207192 [debug] [ThreadPool]: Using postgres connection "list_postgres_justeattakeaway"
[0m05:24:21.207192 [debug] [ThreadPool]: On list_postgres_justeattakeaway: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "connection_name": "list_postgres_justeattakeaway"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'justeattakeaway'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'justeattakeaway'
  
[0m05:24:21.222830 [debug] [ThreadPool]: SQL status: SELECT 492 in 0 seconds
[0m05:24:21.222830 [debug] [ThreadPool]: On list_postgres_justeattakeaway: ROLLBACK
[0m05:24:21.222830 [debug] [ThreadPool]: On list_postgres_justeattakeaway: Close
[0m05:24:21.254079 [debug] [MainThread]: Using postgres connection "master"
[0m05:24:21.254079 [debug] [MainThread]: On master: BEGIN
[0m05:24:21.254079 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:24:21.395878 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m05:24:21.395878 [debug] [MainThread]: Using postgres connection "master"
[0m05:24:21.395878 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:24:21.411534 [debug] [MainThread]: SQL status: SELECT 9 in 0 seconds
[0m05:24:21.411534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f45a601-2a70-4637-8fd2-2b5b8fb1a550', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001994D6B76D0>]}
[0m05:24:21.411534 [debug] [MainThread]: On master: ROLLBACK
[0m05:24:21.411534 [debug] [MainThread]: Using postgres connection "master"
[0m05:24:21.411534 [debug] [MainThread]: On master: BEGIN
[0m05:24:21.411534 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m05:24:21.411534 [debug] [MainThread]: On master: COMMIT
[0m05:24:21.427160 [debug] [MainThread]: Using postgres connection "master"
[0m05:24:21.427160 [debug] [MainThread]: On master: COMMIT
[0m05:24:21.427160 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m05:24:21.427160 [debug] [MainThread]: On master: Close
[0m05:24:21.427160 [info ] [MainThread]: Concurrency: 3 threads (target='prod')
[0m05:24:21.427160 [info ] [MainThread]: 
[0m05:24:21.435408 [debug] [Thread-1 (]: Began running node model.Product_Reviews_DWH.product_reviews_fact
[0m05:24:21.435408 [info ] [Thread-1 (]: 1 of 1 START sql incremental model justeattakeaway.product_reviews_fact ........ [RUN]
[0m05:24:21.436597 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Product_Reviews_DWH.product_reviews_fact'
[0m05:24:21.436597 [debug] [Thread-1 (]: Began compiling node model.Product_Reviews_DWH.product_reviews_fact
[0m05:24:21.452611 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.product_reviews_fact"
[0m05:24:21.452611 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "node_id": "model.Product_Reviews_DWH.product_reviews_fact"} */

        select coalesce(max(sk_product_reviews_fact),0) from  "postgres"."justeattakeaway"."product_reviews_fact"
    
[0m05:24:21.453612 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m05:24:21.631912 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0 seconds
[0m05:24:21.647533 [debug] [Thread-1 (]: Writing injected SQL for node "model.Product_Reviews_DWH.product_reviews_fact"
[0m05:24:21.647533 [debug] [Thread-1 (]: Timing info for model.Product_Reviews_DWH.product_reviews_fact (compile): 2023-04-04 05:24:21.437612 => 2023-04-04 05:24:21.647533
[0m05:24:21.647533 [debug] [Thread-1 (]: Began executing node model.Product_Reviews_DWH.product_reviews_fact
[0m05:24:21.683108 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.product_reviews_fact"
[0m05:24:21.683108 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "node_id": "model.Product_Reviews_DWH.product_reviews_fact"} */

    
  
    

  create temporary table "product_reviews_fact__dbt_tmp082421663162"
  as (
    

    

SELECT  
row_number() over()+0 as sk_product_reviews_fact,
'2004-01-01' as date,
prd_dim.sk_product_dim as sk_product_dim,
category.sk_category_dim as sk_category_dim,
prd_bucket.sk_price_bucket_dim as sk_price_bucket_dim,
reviewer_dim.sk_reviewer_dim as sk_reviewer_dim,
prd_dim_stg.price as product_price,
prd_dim_stg.sales_rank as sales_rank,
reviews_stag.overall as overall_rating,
reviews_stag.up_votes as review_likes,
reviews_stag.down_votes as review_dislikes,
prd_dim_stg.viewed_and_bought_count as viewed_and_bought_count
-- products dim table
FROM "postgres"."justeattakeaway"."products_dimension"  prd_dim
-- products staging table
JOIN "postgres"."justeattakeaway"."products_dim_staging"  prd_dim_stg 
ON prd_dim.asin = prd_dim_stg.asin
-- products category dim table
left join "postgres"."justeattakeaway"."product_category_dimension"  category
ON prd_dim_stg.category= category.category and prd_dim_stg.sub_category = category.sub_category 
-- price bucket dim table
LEFT JOIN "postgres"."justeattakeaway"."price_bucket_dimension"  prd_bucket
ON prd_dim_stg.price >= prd_bucket.bucket_lower_limit  and  prd_dim_stg.price<=prd_bucket.bucket_upper_limit
-- reviews staging table
LEFT JOIN "postgres"."justeattakeaway"."reviews_dim_staging"  as reviews_stag
ON prd_dim.asin = reviews_stag.asin and reviews_stag.review_date = '2004-01-01'
-- reviewer dim table
LEFT JOIN "postgres"."justeattakeaway"."reviewer_dimension"  reviewer_dim
ON reviews_stag.reviewerid =reviewer_dim.reviewerid and reviews_stag.review_date >=reviewer_dim.valid_from and reviews_stag.review_date <reviewer_dim.valid_to
  );
  
  
[0m05:25:21.427070 [debug] [Thread-1 (]: SQL status: SELECT 9430404 in 60 seconds
[0m05:25:21.436070 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.product_reviews_fact"
[0m05:25:21.436070 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: BEGIN
[0m05:25:21.438074 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m05:25:21.439073 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.product_reviews_fact"
[0m05:25:21.439073 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "node_id": "model.Product_Reviews_DWH.product_reviews_fact"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'product_reviews_fact__dbt_tmp082421663162'
        
      order by ordinal_position

  
[0m05:25:21.452072 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0 seconds
[0m05:25:21.458070 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.product_reviews_fact"
[0m05:25:21.458070 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "node_id": "model.Product_Reviews_DWH.product_reviews_fact"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'product_reviews_fact'
        
        and table_schema = 'justeattakeaway'
        
      order by ordinal_position

  
[0m05:25:21.461070 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0 seconds
[0m05:25:21.475070 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.product_reviews_fact"
[0m05:25:21.475070 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "node_id": "model.Product_Reviews_DWH.product_reviews_fact"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'product_reviews_fact__dbt_tmp082421663162'
        
      order by ordinal_position

  
[0m05:25:21.479208 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0 seconds
[0m05:25:21.540677 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.product_reviews_fact"
[0m05:25:21.541677 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "node_id": "model.Product_Reviews_DWH.product_reviews_fact"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'product_reviews_fact'
        
        and table_schema = 'justeattakeaway'
        
      order by ordinal_position

  
[0m05:25:21.544677 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0 seconds
[0m05:25:21.550662 [debug] [Thread-1 (]: 
    In "postgres"."justeattakeaway"."product_reviews_fact":
        Schema changed: True
        Source columns not in target: []
        Target columns not in source: []
        New column types: [{'column_name': 'date', 'new_type': 'text'}, {'column_name': 'sk_reviewer_dim', 'new_type': 'bigint'}, {'column_name': 'sales_rank', 'new_type': 'bigint'}, {'column_name': 'overall_rating', 'new_type': 'double precision'}, {'column_name': 'viewed_and_bought_count', 'new_type': 'smallint'}]
  
[0m05:25:21.550662 [debug] [Thread-1 (]: Timing info for model.Product_Reviews_DWH.product_reviews_fact (execute): 2023-04-04 05:24:21.647533 => 2023-04-04 05:25:21.550662
[0m05:25:21.550662 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: ROLLBACK
[0m05:25:21.638091 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: Close
[0m05:25:21.656385 [debug] [Thread-1 (]: Compilation Error in model product_reviews_fact (models\fact\product_reviews_fact.sql)
  
                The source and target schemas on this incremental model are out of sync!
                They can be reconciled in several ways:
                  - set the `on_schema_change` config to either append_new_columns or sync_all_columns, depending on your situation.
                  - Re-run the incremental model with `full_refresh: True` to update the target schema.
                  - update the schema manually and re-run the process.
  
                Additional troubleshooting context:
                   Source columns not in target: []
                   Target columns not in source: []
                   New column types: [{'column_name': 'date', 'new_type': 'text'}, {'column_name': 'sk_reviewer_dim', 'new_type': 'bigint'}, {'column_name': 'sales_rank', 'new_type': 'bigint'}, {'column_name': 'overall_rating', 'new_type': 'double precision'}, {'column_name': 'viewed_and_bought_count', 'new_type': 'smallint'}]
            
  
  > in macro process_schema_changes (macros\materializations\models\incremental\on_schema_change.sql)
  > called by macro materialization_incremental_default (macros\materializations\models\incremental\incremental.sql)
  > called by model product_reviews_fact (models\fact\product_reviews_fact.sql)
[0m05:25:21.656385 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f45a601-2a70-4637-8fd2-2b5b8fb1a550', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019951455A50>]}
[0m05:25:21.656385 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model justeattakeaway.product_reviews_fact  [[31mERROR[0m in 60.22s]
[0m05:25:21.656385 [debug] [Thread-1 (]: Finished running node model.Product_Reviews_DWH.product_reviews_fact
[0m05:25:21.662586 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:25:21.663583 [debug] [MainThread]: Using postgres connection "master"
[0m05:25:21.663583 [debug] [MainThread]: On master: BEGIN
[0m05:25:21.663583 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:25:21.705310 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m05:25:21.706312 [debug] [MainThread]: On master: COMMIT
[0m05:25:21.706312 [debug] [MainThread]: Using postgres connection "master"
[0m05:25:21.706312 [debug] [MainThread]: On master: COMMIT
[0m05:25:21.706312 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m05:25:21.706312 [debug] [MainThread]: On master: Close
[0m05:25:21.706312 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:25:21.709895 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m05:25:21.709895 [debug] [MainThread]: Connection 'list_postgres_justeattakeaway' was properly closed.
[0m05:25:21.709895 [debug] [MainThread]: Connection 'model.Product_Reviews_DWH.product_reviews_fact' was properly closed.
[0m05:25:21.711494 [info ] [MainThread]: 
[0m05:25:21.711494 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 1 minutes and 0.59 seconds (60.59s).
[0m05:25:21.712498 [debug] [MainThread]: Command end result
[0m05:25:21.725602 [info ] [MainThread]: 
[0m05:25:21.725602 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:25:21.726599 [info ] [MainThread]: 
[0m05:25:21.726599 [error] [MainThread]: [33mCompilation Error in model product_reviews_fact (models\fact\product_reviews_fact.sql)[0m
[0m05:25:21.726599 [error] [MainThread]:   
[0m05:25:21.726599 [error] [MainThread]:                 The source and target schemas on this incremental model are out of sync!
[0m05:25:21.726599 [error] [MainThread]:                 They can be reconciled in several ways:
[0m05:25:21.726599 [error] [MainThread]:                   - set the `on_schema_change` config to either append_new_columns or sync_all_columns, depending on your situation.
[0m05:25:21.726599 [error] [MainThread]:                   - Re-run the incremental model with `full_refresh: True` to update the target schema.
[0m05:25:21.731341 [error] [MainThread]:                   - update the schema manually and re-run the process.
[0m05:25:21.732342 [error] [MainThread]:   
[0m05:25:21.732342 [error] [MainThread]:                 Additional troubleshooting context:
[0m05:25:21.732342 [error] [MainThread]:                    Source columns not in target: []
[0m05:25:21.732342 [error] [MainThread]:                    Target columns not in source: []
[0m05:25:21.732342 [error] [MainThread]:                    New column types: [{'column_name': 'date', 'new_type': 'text'}, {'column_name': 'sk_reviewer_dim', 'new_type': 'bigint'}, {'column_name': 'sales_rank', 'new_type': 'bigint'}, {'column_name': 'overall_rating', 'new_type': 'double precision'}, {'column_name': 'viewed_and_bought_count', 'new_type': 'smallint'}]
[0m05:25:21.732342 [error] [MainThread]:             
[0m05:25:21.732342 [error] [MainThread]:   
[0m05:25:21.732342 [error] [MainThread]:   > in macro process_schema_changes (macros\materializations\models\incremental\on_schema_change.sql)
[0m05:25:21.732342 [error] [MainThread]:   > called by macro materialization_incremental_default (macros\materializations\models\incremental\incremental.sql)
[0m05:25:21.738326 [error] [MainThread]:   > called by model product_reviews_fact (models\fact\product_reviews_fact.sql)
[0m05:25:21.738326 [info ] [MainThread]: 
[0m05:25:21.738326 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m05:25:21.738326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019951457DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199514559F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019951457400>]}
[0m05:25:21.738326 [debug] [MainThread]: Flushing usage events


============================== 2023-04-04 05:37:03.211551 | 0a40aae6-7f7c-4ba1-ba0c-4b411e7f0bff ==============================
[0m05:37:03.211551 [info ] [MainThread]: Running with dbt=1.4.5
[0m05:37:03.216695 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Furqan\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['fact'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m05:37:03.216695 [debug] [MainThread]: Tracking: tracking
[0m05:37:03.228694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B7D44E290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B7D44E3E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B7D44DC30>]}
[0m05:37:03.240692 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m05:37:03.330405 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:37:03.330405 [debug] [MainThread]: Partial parsing: updated file: Product_Reviews_DWH://models\fact\product_reviews_fact.sql
[0m05:37:03.351289 [debug] [MainThread]: 1603: static parser failed on fact\product_reviews_fact.sql
[0m05:37:03.368115 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fact\product_reviews_fact.sql
[0m05:37:03.401566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a40aae6-7f7c-4ba1-ba0c-4b411e7f0bff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B79D900D0>]}
[0m05:37:03.417510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a40aae6-7f7c-4ba1-ba0c-4b411e7f0bff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B7D719270>]}
[0m05:37:03.417510 [info ] [MainThread]: Found 6 models, 59 tests, 1 snapshot, 0 analyses, 403 macros, 0 operations, 0 seed files, 10 sources, 0 exposures, 0 metrics
[0m05:37:03.418513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a40aae6-7f7c-4ba1-ba0c-4b411e7f0bff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B79CC6A40>]}
[0m05:37:03.420511 [info ] [MainThread]: 
[0m05:37:03.422233 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:37:03.424556 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m05:37:03.432231 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m05:37:03.433420 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m05:37:03.433420 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:37:03.476233 [debug] [ThreadPool]: SQL status: SELECT 25 in 0 seconds
[0m05:37:03.477232 [debug] [ThreadPool]: On list_postgres: Close
[0m05:37:03.479233 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_justeattakeaway'
[0m05:37:03.484673 [debug] [ThreadPool]: Using postgres connection "list_postgres_justeattakeaway"
[0m05:37:03.484673 [debug] [ThreadPool]: On list_postgres_justeattakeaway: BEGIN
[0m05:37:03.484673 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:37:03.521366 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m05:37:03.521366 [debug] [ThreadPool]: Using postgres connection "list_postgres_justeattakeaway"
[0m05:37:03.522365 [debug] [ThreadPool]: On list_postgres_justeattakeaway: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "connection_name": "list_postgres_justeattakeaway"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'justeattakeaway'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'justeattakeaway'
  
[0m05:37:03.530256 [debug] [ThreadPool]: SQL status: SELECT 492 in 0 seconds
[0m05:37:03.532000 [debug] [ThreadPool]: On list_postgres_justeattakeaway: ROLLBACK
[0m05:37:03.536937 [debug] [ThreadPool]: On list_postgres_justeattakeaway: Close
[0m05:37:03.608762 [debug] [MainThread]: Using postgres connection "master"
[0m05:37:03.608762 [debug] [MainThread]: On master: BEGIN
[0m05:37:03.610547 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:37:03.647571 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m05:37:03.647571 [debug] [MainThread]: Using postgres connection "master"
[0m05:37:03.648571 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:37:03.686932 [debug] [MainThread]: SQL status: SELECT 9 in 0 seconds
[0m05:37:03.686932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a40aae6-7f7c-4ba1-ba0c-4b411e7f0bff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B7D54BD00>]}
[0m05:37:03.691018 [debug] [MainThread]: On master: ROLLBACK
[0m05:37:03.691018 [debug] [MainThread]: Using postgres connection "master"
[0m05:37:03.691018 [debug] [MainThread]: On master: BEGIN
[0m05:37:03.692204 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m05:37:03.692204 [debug] [MainThread]: On master: COMMIT
[0m05:37:03.692204 [debug] [MainThread]: Using postgres connection "master"
[0m05:37:03.693208 [debug] [MainThread]: On master: COMMIT
[0m05:37:03.693208 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m05:37:03.693208 [debug] [MainThread]: On master: Close
[0m05:37:03.694207 [info ] [MainThread]: Concurrency: 3 threads (target='prod')
[0m05:37:03.695286 [info ] [MainThread]: 
[0m05:37:03.702407 [debug] [Thread-1 (]: Began running node model.Product_Reviews_DWH.product_reviews_fact
[0m05:37:03.702407 [info ] [Thread-1 (]: 1 of 1 START sql incremental model justeattakeaway.product_reviews_fact ........ [RUN]
[0m05:37:03.703407 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Product_Reviews_DWH.product_reviews_fact'
[0m05:37:03.704409 [debug] [Thread-1 (]: Began compiling node model.Product_Reviews_DWH.product_reviews_fact
[0m05:37:03.717517 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.product_reviews_fact"
[0m05:37:03.718407 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "node_id": "model.Product_Reviews_DWH.product_reviews_fact"} */

        select coalesce(max(sk_product_reviews_fact),0) from  "postgres"."justeattakeaway"."product_reviews_fact"
    
[0m05:37:03.718407 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m05:37:04.070740 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0 seconds
[0m05:37:04.071740 [debug] [Thread-1 (]: Writing injected SQL for node "model.Product_Reviews_DWH.product_reviews_fact"
[0m05:37:04.073149 [debug] [Thread-1 (]: Timing info for model.Product_Reviews_DWH.product_reviews_fact (compile): 2023-04-04 05:37:03.704409 => 2023-04-04 05:37:04.073149
[0m05:37:04.073149 [debug] [Thread-1 (]: Began executing node model.Product_Reviews_DWH.product_reviews_fact
[0m05:37:04.112053 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.product_reviews_fact"
[0m05:37:04.112053 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "node_id": "model.Product_Reviews_DWH.product_reviews_fact"} */

    
  
    

  create temporary table "product_reviews_fact__dbt_tmp083704095222"
  as (
    

    

SELECT  
row_number() over()+0 as sk_product_reviews_fact,
'2004-01-01'::date as date,
prd_dim.sk_product_dim::int4 as sk_product_dim,
category.sk_category_dim as sk_category_dim,
prd_bucket.sk_price_bucket_dim as sk_price_bucket_dim,
reviewer_dim.sk_reviewer_dim as sk_reviewer_dim,
prd_dim_stg.price as product_price,
prd_dim_stg.sales_rank::int4 as sales_rank,
reviews_stag.overall::int4 as overall_rating,
reviews_stag.up_votes as review_likes,
reviews_stag.down_votes as review_dislikes,
prd_dim_stg.viewed_and_bought_count::int4 as viewed_and_bought_count
-- products dim table
FROM "postgres"."justeattakeaway"."products_dimension"  prd_dim
-- products staging table
JOIN "postgres"."justeattakeaway"."products_dim_staging"  prd_dim_stg 
ON prd_dim.asin = prd_dim_stg.asin
-- products category dim table
left join "postgres"."justeattakeaway"."product_category_dimension"  category
ON prd_dim_stg.category= category.category and prd_dim_stg.sub_category = category.sub_category 
-- price bucket dim table
LEFT JOIN "postgres"."justeattakeaway"."price_bucket_dimension"  prd_bucket
ON prd_dim_stg.price >= prd_bucket.bucket_lower_limit  and  prd_dim_stg.price<=prd_bucket.bucket_upper_limit
-- reviews staging table
LEFT JOIN "postgres"."justeattakeaway"."reviews_dim_staging"  as reviews_stag
ON prd_dim.asin = reviews_stag.asin and reviews_stag.review_date = '2004-01-01'
-- reviewer dim table
LEFT JOIN "postgres"."justeattakeaway"."reviewer_dimension"  reviewer_dim
ON reviews_stag.reviewerid =reviewer_dim.reviewerid and reviews_stag.review_date >=reviewer_dim.valid_from and reviews_stag.review_date <reviewer_dim.valid_to
  );
  
  
[0m05:38:12.160845 [debug] [Thread-1 (]: SQL status: SELECT 9430404 in 68 seconds
[0m05:38:12.167151 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.product_reviews_fact"
[0m05:38:12.167151 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: BEGIN
[0m05:38:12.179397 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m05:38:12.179397 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.product_reviews_fact"
[0m05:38:12.180399 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "node_id": "model.Product_Reviews_DWH.product_reviews_fact"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'product_reviews_fact__dbt_tmp083704095222'
        
      order by ordinal_position

  
[0m05:38:12.198881 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0 seconds
[0m05:38:12.204841 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.product_reviews_fact"
[0m05:38:12.205951 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "node_id": "model.Product_Reviews_DWH.product_reviews_fact"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'product_reviews_fact'
        
        and table_schema = 'justeattakeaway'
        
      order by ordinal_position

  
[0m05:38:12.206950 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0 seconds
[0m05:38:12.221200 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.product_reviews_fact"
[0m05:38:12.223339 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "node_id": "model.Product_Reviews_DWH.product_reviews_fact"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'product_reviews_fact__dbt_tmp083704095222'
        
      order by ordinal_position

  
[0m05:38:12.226229 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0 seconds
[0m05:38:12.228229 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.product_reviews_fact"
[0m05:38:12.228229 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "node_id": "model.Product_Reviews_DWH.product_reviews_fact"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'product_reviews_fact'
        
        and table_schema = 'justeattakeaway'
        
      order by ordinal_position

  
[0m05:38:12.228229 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0 seconds
[0m05:38:12.242402 [debug] [Thread-1 (]: 
    In "postgres"."justeattakeaway"."product_reviews_fact":
        Schema changed: True
        Source columns not in target: []
        Target columns not in source: []
        New column types: [{'column_name': 'sk_reviewer_dim', 'new_type': 'bigint'}]
  
[0m05:38:12.243420 [debug] [Thread-1 (]: Timing info for model.Product_Reviews_DWH.product_reviews_fact (execute): 2023-04-04 05:37:04.073149 => 2023-04-04 05:38:12.243420
[0m05:38:12.243420 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: ROLLBACK
[0m05:38:12.304645 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: Close
[0m05:38:12.326976 [debug] [Thread-1 (]: Compilation Error in model product_reviews_fact (models\fact\product_reviews_fact.sql)
  
                The source and target schemas on this incremental model are out of sync!
                They can be reconciled in several ways:
                  - set the `on_schema_change` config to either append_new_columns or sync_all_columns, depending on your situation.
                  - Re-run the incremental model with `full_refresh: True` to update the target schema.
                  - update the schema manually and re-run the process.
  
                Additional troubleshooting context:
                   Source columns not in target: []
                   Target columns not in source: []
                   New column types: [{'column_name': 'sk_reviewer_dim', 'new_type': 'bigint'}]
            
  
  > in macro process_schema_changes (macros\materializations\models\incremental\on_schema_change.sql)
  > called by macro materialization_incremental_default (macros\materializations\models\incremental\incremental.sql)
  > called by model product_reviews_fact (models\fact\product_reviews_fact.sql)
[0m05:38:12.327976 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a40aae6-7f7c-4ba1-ba0c-4b411e7f0bff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B79D514E0>]}
[0m05:38:12.327976 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model justeattakeaway.product_reviews_fact  [[31mERROR[0m in 68.62s]
[0m05:38:12.332236 [debug] [Thread-1 (]: Finished running node model.Product_Reviews_DWH.product_reviews_fact
[0m05:38:12.333859 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:38:12.334868 [debug] [MainThread]: Using postgres connection "master"
[0m05:38:12.334868 [debug] [MainThread]: On master: BEGIN
[0m05:38:12.334868 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:38:12.373522 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m05:38:12.374523 [debug] [MainThread]: On master: COMMIT
[0m05:38:12.375523 [debug] [MainThread]: Using postgres connection "master"
[0m05:38:12.375523 [debug] [MainThread]: On master: COMMIT
[0m05:38:12.376748 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m05:38:12.376748 [debug] [MainThread]: On master: Close
[0m05:38:12.377749 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:38:12.378333 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m05:38:12.378333 [debug] [MainThread]: Connection 'list_postgres_justeattakeaway' was properly closed.
[0m05:38:12.378333 [debug] [MainThread]: Connection 'model.Product_Reviews_DWH.product_reviews_fact' was properly closed.
[0m05:38:12.379334 [info ] [MainThread]: 
[0m05:38:12.380073 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 1 minutes and 8.96 seconds (68.96s).
[0m05:38:12.380073 [debug] [MainThread]: Command end result
[0m05:38:12.389636 [info ] [MainThread]: 
[0m05:38:12.389636 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:38:12.394525 [info ] [MainThread]: 
[0m05:38:12.395525 [error] [MainThread]: [33mCompilation Error in model product_reviews_fact (models\fact\product_reviews_fact.sql)[0m
[0m05:38:12.395525 [error] [MainThread]:   
[0m05:38:12.396524 [error] [MainThread]:                 The source and target schemas on this incremental model are out of sync!
[0m05:38:12.397483 [error] [MainThread]:                 They can be reconciled in several ways:
[0m05:38:12.397483 [error] [MainThread]:                   - set the `on_schema_change` config to either append_new_columns or sync_all_columns, depending on your situation.
[0m05:38:12.398485 [error] [MainThread]:                   - Re-run the incremental model with `full_refresh: True` to update the target schema.
[0m05:38:12.398485 [error] [MainThread]:                   - update the schema manually and re-run the process.
[0m05:38:12.399484 [error] [MainThread]:   
[0m05:38:12.400041 [error] [MainThread]:                 Additional troubleshooting context:
[0m05:38:12.401043 [error] [MainThread]:                    Source columns not in target: []
[0m05:38:12.401609 [error] [MainThread]:                    Target columns not in source: []
[0m05:38:12.402610 [error] [MainThread]:                    New column types: [{'column_name': 'sk_reviewer_dim', 'new_type': 'bigint'}]
[0m05:38:12.402610 [error] [MainThread]:             
[0m05:38:12.403610 [error] [MainThread]:   
[0m05:38:12.403610 [error] [MainThread]:   > in macro process_schema_changes (macros\materializations\models\incremental\on_schema_change.sql)
[0m05:38:12.403610 [error] [MainThread]:   > called by macro materialization_incremental_default (macros\materializations\models\incremental\incremental.sql)
[0m05:38:12.403610 [error] [MainThread]:   > called by model product_reviews_fact (models\fact\product_reviews_fact.sql)
[0m05:38:12.403610 [info ] [MainThread]: 
[0m05:38:12.406840 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m05:38:12.407837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B79CC6A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B7DB39F30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B7DB3BA90>]}
[0m05:38:12.408495 [debug] [MainThread]: Flushing usage events


============================== 2023-04-04 05:39:07.329585 | 081a0def-0960-4d0f-a1c9-433227c572be ==============================
[0m05:39:07.329585 [info ] [MainThread]: Running with dbt=1.4.5
[0m05:39:07.337851 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Furqan\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['fact'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m05:39:07.337851 [debug] [MainThread]: Tracking: tracking
[0m05:39:07.353013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168939DDAB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168939DE3E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168939DDC30>]}
[0m05:39:07.366392 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m05:39:07.473703 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:39:07.473703 [debug] [MainThread]: Partial parsing: updated file: Product_Reviews_DWH://models\fact\product_reviews_fact.sql
[0m05:39:07.484429 [debug] [MainThread]: 1603: static parser failed on fact\product_reviews_fact.sql
[0m05:39:07.503273 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fact\product_reviews_fact.sql
[0m05:39:07.546942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '081a0def-0960-4d0f-a1c9-433227c572be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001689031C0D0>]}
[0m05:39:07.572957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '081a0def-0960-4d0f-a1c9-433227c572be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016893CA9270>]}
[0m05:39:07.572957 [info ] [MainThread]: Found 6 models, 59 tests, 1 snapshot, 0 analyses, 403 macros, 0 operations, 0 seed files, 10 sources, 0 exposures, 0 metrics
[0m05:39:07.573959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '081a0def-0960-4d0f-a1c9-433227c572be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016890256A40>]}
[0m05:39:07.575971 [info ] [MainThread]: 
[0m05:39:07.576960 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:39:07.578957 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m05:39:07.588958 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m05:39:07.588958 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m05:39:07.589645 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:39:07.639957 [debug] [ThreadPool]: SQL status: SELECT 25 in 0 seconds
[0m05:39:07.640958 [debug] [ThreadPool]: On list_postgres: Close
[0m05:39:07.643000 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_justeattakeaway'
[0m05:39:07.645033 [debug] [ThreadPool]: Using postgres connection "list_postgres_justeattakeaway"
[0m05:39:07.649057 [debug] [ThreadPool]: On list_postgres_justeattakeaway: BEGIN
[0m05:39:07.649057 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:39:07.691647 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m05:39:07.691647 [debug] [ThreadPool]: Using postgres connection "list_postgres_justeattakeaway"
[0m05:39:07.692866 [debug] [ThreadPool]: On list_postgres_justeattakeaway: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "connection_name": "list_postgres_justeattakeaway"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'justeattakeaway'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'justeattakeaway'
  
[0m05:39:07.702651 [debug] [ThreadPool]: SQL status: SELECT 492 in 0 seconds
[0m05:39:07.704913 [debug] [ThreadPool]: On list_postgres_justeattakeaway: ROLLBACK
[0m05:39:07.710339 [debug] [ThreadPool]: On list_postgres_justeattakeaway: Close
[0m05:39:07.770806 [debug] [MainThread]: Using postgres connection "master"
[0m05:39:07.770806 [debug] [MainThread]: On master: BEGIN
[0m05:39:07.770806 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:39:07.825715 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m05:39:07.825715 [debug] [MainThread]: Using postgres connection "master"
[0m05:39:07.826863 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:39:07.869792 [debug] [MainThread]: SQL status: SELECT 9 in 0 seconds
[0m05:39:07.869792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '081a0def-0960-4d0f-a1c9-433227c572be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016893ADBD00>]}
[0m05:39:07.878484 [debug] [MainThread]: On master: ROLLBACK
[0m05:39:07.878484 [debug] [MainThread]: Using postgres connection "master"
[0m05:39:07.878484 [debug] [MainThread]: On master: BEGIN
[0m05:39:07.879722 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m05:39:07.879722 [debug] [MainThread]: On master: COMMIT
[0m05:39:07.879722 [debug] [MainThread]: Using postgres connection "master"
[0m05:39:07.880777 [debug] [MainThread]: On master: COMMIT
[0m05:39:07.880777 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m05:39:07.880777 [debug] [MainThread]: On master: Close
[0m05:39:07.881776 [info ] [MainThread]: Concurrency: 3 threads (target='prod')
[0m05:39:07.882779 [info ] [MainThread]: 
[0m05:39:07.889020 [debug] [Thread-1 (]: Began running node model.Product_Reviews_DWH.product_reviews_fact
[0m05:39:07.890020 [info ] [Thread-1 (]: 1 of 1 START sql incremental model justeattakeaway.product_reviews_fact ........ [RUN]
[0m05:39:07.891019 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Product_Reviews_DWH.product_reviews_fact'
[0m05:39:07.891019 [debug] [Thread-1 (]: Began compiling node model.Product_Reviews_DWH.product_reviews_fact
[0m05:39:07.904020 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.product_reviews_fact"
[0m05:39:07.905351 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "node_id": "model.Product_Reviews_DWH.product_reviews_fact"} */

        select coalesce(max(sk_product_reviews_fact),0) from  "postgres"."justeattakeaway"."product_reviews_fact"
    
[0m05:39:07.905351 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m05:39:08.299690 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0 seconds
[0m05:39:08.300690 [debug] [Thread-1 (]: Writing injected SQL for node "model.Product_Reviews_DWH.product_reviews_fact"
[0m05:39:08.300690 [debug] [Thread-1 (]: Timing info for model.Product_Reviews_DWH.product_reviews_fact (compile): 2023-04-04 05:39:07.891019 => 2023-04-04 05:39:08.300690
[0m05:39:08.300690 [debug] [Thread-1 (]: Began executing node model.Product_Reviews_DWH.product_reviews_fact
[0m05:39:08.344182 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.product_reviews_fact"
[0m05:39:08.344182 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "node_id": "model.Product_Reviews_DWH.product_reviews_fact"} */

    
  
    

  create temporary table "product_reviews_fact__dbt_tmp083908326407"
  as (
    

    

SELECT  
row_number() over()+0 as sk_product_reviews_fact,
'2004-01-01'::date as date,
prd_dim.sk_product_dim::int4 as sk_product_dim,
category.sk_category_dim as sk_category_dim,
prd_bucket.sk_price_bucket_dim as sk_price_bucket_dim,
reviewer_dim.sk_reviewer_dim::int4 as sk_reviewer_dim,
prd_dim_stg.price as product_price,
prd_dim_stg.sales_rank::int4 as sales_rank,
reviews_stag.overall::int4 as overall_rating,
reviews_stag.up_votes as review_likes,
reviews_stag.down_votes as review_dislikes,
prd_dim_stg.viewed_and_bought_count::int4 as viewed_and_bought_count
-- products dim table
FROM "postgres"."justeattakeaway"."products_dimension"  prd_dim
-- products staging table
JOIN "postgres"."justeattakeaway"."products_dim_staging"  prd_dim_stg 
ON prd_dim.asin = prd_dim_stg.asin
-- products category dim table
left join "postgres"."justeattakeaway"."product_category_dimension"  category
ON prd_dim_stg.category= category.category and prd_dim_stg.sub_category = category.sub_category 
-- price bucket dim table
LEFT JOIN "postgres"."justeattakeaway"."price_bucket_dimension"  prd_bucket
ON prd_dim_stg.price >= prd_bucket.bucket_lower_limit  and  prd_dim_stg.price<=prd_bucket.bucket_upper_limit
-- reviews staging table
LEFT JOIN "postgres"."justeattakeaway"."reviews_dim_staging"  as reviews_stag
ON prd_dim.asin = reviews_stag.asin and reviews_stag.review_date = '2004-01-01'
-- reviewer dim table
LEFT JOIN "postgres"."justeattakeaway"."reviewer_dimension"  reviewer_dim
ON reviews_stag.reviewerid =reviewer_dim.reviewerid and reviews_stag.review_date >=reviewer_dim.valid_from and reviews_stag.review_date <reviewer_dim.valid_to
  );
  
  
[0m05:40:13.491608 [debug] [Thread-1 (]: SQL status: SELECT 9430404 in 65 seconds
[0m05:40:13.491608 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.product_reviews_fact"
[0m05:40:13.491608 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: BEGIN
[0m05:40:13.502533 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m05:40:13.502533 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.product_reviews_fact"
[0m05:40:13.503550 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "node_id": "model.Product_Reviews_DWH.product_reviews_fact"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'product_reviews_fact__dbt_tmp083908326407'
        
      order by ordinal_position

  
[0m05:40:13.516957 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0 seconds
[0m05:40:13.517957 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.product_reviews_fact"
[0m05:40:13.517957 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "node_id": "model.Product_Reviews_DWH.product_reviews_fact"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'product_reviews_fact'
        
        and table_schema = 'justeattakeaway'
        
      order by ordinal_position

  
[0m05:40:13.517957 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0 seconds
[0m05:40:13.534724 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.product_reviews_fact"
[0m05:40:13.534724 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "node_id": "model.Product_Reviews_DWH.product_reviews_fact"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'product_reviews_fact__dbt_tmp083908326407'
        
      order by ordinal_position

  
[0m05:40:13.534724 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0 seconds
[0m05:40:13.550391 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.product_reviews_fact"
[0m05:40:13.550391 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "node_id": "model.Product_Reviews_DWH.product_reviews_fact"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'product_reviews_fact'
        
        and table_schema = 'justeattakeaway'
        
      order by ordinal_position

  
[0m05:40:13.550391 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0 seconds
[0m05:40:13.556919 [debug] [Thread-1 (]: 
    In "postgres"."justeattakeaway"."product_reviews_fact":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m05:40:13.568076 [debug] [Thread-1 (]: Writing runtime sql for node "model.Product_Reviews_DWH.product_reviews_fact"
[0m05:40:13.585103 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.product_reviews_fact"
[0m05:40:13.585103 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "node_id": "model.Product_Reviews_DWH.product_reviews_fact"} */

      
        
            delete from "postgres"."justeattakeaway"."product_reviews_fact"
            where (
                sk_product_reviews_fact) in (
                select (sk_product_reviews_fact)
                from "product_reviews_fact__dbt_tmp083908326407"
            );

        
    

    insert into "postgres"."justeattakeaway"."product_reviews_fact" ("sk_product_reviews_fact", "date", "sk_product_dim", "sk_category_dim", "sk_price_bucket_dim", "sk_reviewer_dim", "product_price", "sales_rank", "overall_rating", "review_likes", "review_dislikes", "viewed_and_bought_count")
    (
        select "sk_product_reviews_fact", "date", "sk_product_dim", "sk_category_dim", "sk_price_bucket_dim", "sk_reviewer_dim", "product_price", "sales_rank", "overall_rating", "review_likes", "review_dislikes", "viewed_and_bought_count"
        from "product_reviews_fact__dbt_tmp083908326407"
    )
  
[0m05:40:13.750772 [debug] [Thread-1 (]: Postgres adapter: Postgres error: null value in column "sk_reviewer_dim" of relation "product_reviews_fact_2004_01" violates not-null constraint
DETAIL:  Failing row contains (3, 2004-01-01, 5061991, 3674, 1, null, 7.7, 5948, 1, 15, 14, 0).

[0m05:40:13.751773 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: ROLLBACK
[0m05:40:13.753368 [debug] [Thread-1 (]: Timing info for model.Product_Reviews_DWH.product_reviews_fact (execute): 2023-04-04 05:39:08.300690 => 2023-04-04 05:40:13.753368
[0m05:40:13.753368 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: Close
[0m05:40:13.781164 [debug] [Thread-1 (]: Database Error in model product_reviews_fact (models\fact\product_reviews_fact.sql)
  null value in column "sk_reviewer_dim" of relation "product_reviews_fact_2004_01" violates not-null constraint
  DETAIL:  Failing row contains (3, 2004-01-01, 5061991, 3674, 1, null, 7.7, 5948, 1, 15, 14, 0).
  compiled Code at target\run\Product_Reviews_DWH\models\fact\product_reviews_fact.sql
[0m05:40:13.782673 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '081a0def-0960-4d0f-a1c9-433227c572be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168902E0C40>]}
[0m05:40:13.783164 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model justeattakeaway.product_reviews_fact  [[31mERROR[0m in 65.89s]
[0m05:40:13.786162 [debug] [Thread-1 (]: Finished running node model.Product_Reviews_DWH.product_reviews_fact
[0m05:40:13.788163 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:40:13.788163 [debug] [MainThread]: Using postgres connection "master"
[0m05:40:13.788163 [debug] [MainThread]: On master: BEGIN
[0m05:40:13.789163 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:40:13.827385 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m05:40:13.828385 [debug] [MainThread]: On master: COMMIT
[0m05:40:13.828385 [debug] [MainThread]: Using postgres connection "master"
[0m05:40:13.829385 [debug] [MainThread]: On master: COMMIT
[0m05:40:13.830150 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m05:40:13.830385 [debug] [MainThread]: On master: Close
[0m05:40:13.831385 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:40:13.831385 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m05:40:13.832384 [debug] [MainThread]: Connection 'list_postgres_justeattakeaway' was properly closed.
[0m05:40:13.832384 [debug] [MainThread]: Connection 'model.Product_Reviews_DWH.product_reviews_fact' was properly closed.
[0m05:40:13.833383 [info ] [MainThread]: 
[0m05:40:13.833383 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 1 minutes and 6.26 seconds (66.26s).
[0m05:40:13.834799 [debug] [MainThread]: Command end result
[0m05:40:13.852468 [info ] [MainThread]: 
[0m05:40:13.853387 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:40:13.854387 [info ] [MainThread]: 
[0m05:40:13.855384 [error] [MainThread]: [33mDatabase Error in model product_reviews_fact (models\fact\product_reviews_fact.sql)[0m
[0m05:40:13.855618 [error] [MainThread]:   null value in column "sk_reviewer_dim" of relation "product_reviews_fact_2004_01" violates not-null constraint
[0m05:40:13.856385 [error] [MainThread]:   DETAIL:  Failing row contains (3, 2004-01-01, 5061991, 3674, 1, null, 7.7, 5948, 1, 15, 14, 0).
[0m05:40:13.857385 [error] [MainThread]:   compiled Code at target\run\Product_Reviews_DWH\models\fact\product_reviews_fact.sql
[0m05:40:13.858228 [info ] [MainThread]: 
[0m05:40:13.858228 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m05:40:13.859233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016890256A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168940DB6A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168940DB6D0>]}
[0m05:40:13.859233 [debug] [MainThread]: Flushing usage events


============================== 2023-04-04 05:43:19.565848 | 3ce99106-608c-48f6-be42-02f7e9933393 ==============================
[0m05:43:19.565848 [info ] [MainThread]: Running with dbt=1.4.5
[0m05:43:19.569978 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Furqan\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['fact'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m05:43:19.569978 [debug] [MainThread]: Tracking: tracking
[0m05:43:19.581979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FEF12F880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FEF12E440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FEF12ECB0>]}
[0m05:43:19.593978 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m05:43:19.678490 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:43:19.687131 [debug] [MainThread]: Partial parsing: updated file: Product_Reviews_DWH://models\fact\product_reviews_fact.sql
[0m05:43:19.688155 [debug] [MainThread]: 1603: static parser failed on fact\product_reviews_fact.sql
[0m05:43:19.705104 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fact\product_reviews_fact.sql
[0m05:43:19.741504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3ce99106-608c-48f6-be42-02f7e9933393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FEBA6C0D0>]}
[0m05:43:19.755268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3ce99106-608c-48f6-be42-02f7e9933393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FEF3FD1B0>]}
[0m05:43:19.756268 [info ] [MainThread]: Found 6 models, 59 tests, 1 snapshot, 0 analyses, 403 macros, 0 operations, 0 seed files, 10 sources, 0 exposures, 0 metrics
[0m05:43:19.756268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ce99106-608c-48f6-be42-02f7e9933393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FEB9AA980>]}
[0m05:43:19.758293 [info ] [MainThread]: 
[0m05:43:19.760293 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:43:19.762293 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m05:43:19.770293 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m05:43:19.771293 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m05:43:19.771293 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:43:19.809293 [debug] [ThreadPool]: SQL status: SELECT 25 in 0 seconds
[0m05:43:19.810293 [debug] [ThreadPool]: On list_postgres: Close
[0m05:43:19.812294 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_justeattakeaway'
[0m05:43:19.817294 [debug] [ThreadPool]: Using postgres connection "list_postgres_justeattakeaway"
[0m05:43:19.817294 [debug] [ThreadPool]: On list_postgres_justeattakeaway: BEGIN
[0m05:43:19.817294 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:43:19.849161 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m05:43:19.850167 [debug] [ThreadPool]: Using postgres connection "list_postgres_justeattakeaway"
[0m05:43:19.850664 [debug] [ThreadPool]: On list_postgres_justeattakeaway: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "connection_name": "list_postgres_justeattakeaway"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'justeattakeaway'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'justeattakeaway'
  
[0m05:43:19.856634 [debug] [ThreadPool]: SQL status: SELECT 492 in 0 seconds
[0m05:43:19.858590 [debug] [ThreadPool]: On list_postgres_justeattakeaway: ROLLBACK
[0m05:43:19.863793 [debug] [ThreadPool]: On list_postgres_justeattakeaway: Close
[0m05:43:19.931613 [debug] [MainThread]: Using postgres connection "master"
[0m05:43:19.931613 [debug] [MainThread]: On master: BEGIN
[0m05:43:19.931613 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:43:19.966600 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m05:43:19.966600 [debug] [MainThread]: Using postgres connection "master"
[0m05:43:19.967805 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:43:19.986562 [debug] [MainThread]: SQL status: SELECT 9 in 0 seconds
[0m05:43:19.986562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ce99106-608c-48f6-be42-02f7e9933393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FEF219480>]}
[0m05:43:19.996982 [debug] [MainThread]: On master: ROLLBACK
[0m05:43:19.996982 [debug] [MainThread]: Using postgres connection "master"
[0m05:43:19.996982 [debug] [MainThread]: On master: BEGIN
[0m05:43:19.998184 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m05:43:19.998184 [debug] [MainThread]: On master: COMMIT
[0m05:43:19.998184 [debug] [MainThread]: Using postgres connection "master"
[0m05:43:19.999389 [debug] [MainThread]: On master: COMMIT
[0m05:43:19.999389 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m05:43:19.999389 [debug] [MainThread]: On master: Close
[0m05:43:20.000389 [info ] [MainThread]: Concurrency: 3 threads (target='prod')
[0m05:43:20.001389 [info ] [MainThread]: 
[0m05:43:20.007388 [debug] [Thread-1 (]: Began running node model.Product_Reviews_DWH.product_reviews_fact
[0m05:43:20.007388 [info ] [Thread-1 (]: 1 of 1 START sql incremental model justeattakeaway.product_reviews_fact ........ [RUN]
[0m05:43:20.008403 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Product_Reviews_DWH.product_reviews_fact'
[0m05:43:20.009388 [debug] [Thread-1 (]: Began compiling node model.Product_Reviews_DWH.product_reviews_fact
[0m05:43:20.023389 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.product_reviews_fact"
[0m05:43:20.023389 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "node_id": "model.Product_Reviews_DWH.product_reviews_fact"} */

        select coalesce(max(sk_product_reviews_fact),0) from  "postgres"."justeattakeaway"."product_reviews_fact"
    
[0m05:43:20.023389 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m05:43:20.225279 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0 seconds
[0m05:43:20.226837 [debug] [Thread-1 (]: Writing injected SQL for node "model.Product_Reviews_DWH.product_reviews_fact"
[0m05:43:20.227417 [debug] [Thread-1 (]: Timing info for model.Product_Reviews_DWH.product_reviews_fact (compile): 2023-04-04 05:43:20.009388 => 2023-04-04 05:43:20.227417
[0m05:43:20.227417 [debug] [Thread-1 (]: Began executing node model.Product_Reviews_DWH.product_reviews_fact
[0m05:43:20.266321 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.product_reviews_fact"
[0m05:43:20.266321 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "node_id": "model.Product_Reviews_DWH.product_reviews_fact"} */

    
  
    

  create temporary table "product_reviews_fact__dbt_tmp084320249501"
  as (
    

    

SELECT  
row_number() over()+0 as sk_product_reviews_fact,
'2004-01-01'::date as date,
coalesce(prd_dim.sk_product_dim,-1)::int4 as sk_product_dim,
coalesce(category.sk_category_dim,-1) as sk_category_dim,
coalesce(prd_bucket.sk_price_bucket_dim,-1) as sk_price_bucket_dim,
coalesce(reviewer_dim.sk_reviewer_dim,-1)::int4 as sk_reviewer_dim,
prd_dim_stg.price as product_price,
prd_dim_stg.sales_rank::int4 as sales_rank,
reviews_stag.overall::int4 as overall_rating,
reviews_stag.up_votes as review_likes,
reviews_stag.down_votes as review_dislikes,
prd_dim_stg.viewed_and_bought_count::int4 as viewed_and_bought_count
-- products dim table
FROM "postgres"."justeattakeaway"."products_dimension"  prd_dim
-- products staging table
JOIN "postgres"."justeattakeaway"."products_dim_staging"  prd_dim_stg 
ON prd_dim.asin = prd_dim_stg.asin
-- products category dim table
left join "postgres"."justeattakeaway"."product_category_dimension"  category
ON prd_dim_stg.category= category.category and prd_dim_stg.sub_category = category.sub_category 
-- price bucket dim table
LEFT JOIN "postgres"."justeattakeaway"."price_bucket_dimension"  prd_bucket
ON prd_dim_stg.price >= prd_bucket.bucket_lower_limit  and  prd_dim_stg.price<=prd_bucket.bucket_upper_limit
-- reviews staging table
LEFT JOIN "postgres"."justeattakeaway"."reviews_dim_staging"  as reviews_stag
ON prd_dim.asin = reviews_stag.asin and reviews_stag.review_date = '2004-01-01'
-- reviewer dim table
LEFT JOIN "postgres"."justeattakeaway"."reviewer_dimension"  reviewer_dim
ON reviews_stag.reviewerid =reviewer_dim.reviewerid and reviews_stag.review_date >=reviewer_dim.valid_from and reviews_stag.review_date <reviewer_dim.valid_to
  );
  
  
[0m05:44:29.144316 [debug] [Thread-1 (]: SQL status: SELECT 9430404 in 69 seconds
[0m05:44:29.148853 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.product_reviews_fact"
[0m05:44:29.153167 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: BEGIN
[0m05:44:29.154976 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m05:44:29.154976 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.product_reviews_fact"
[0m05:44:29.154976 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "node_id": "model.Product_Reviews_DWH.product_reviews_fact"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'product_reviews_fact__dbt_tmp084320249501'
        
      order by ordinal_position

  
[0m05:44:29.163773 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0 seconds
[0m05:44:29.169749 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.product_reviews_fact"
[0m05:44:29.170749 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "node_id": "model.Product_Reviews_DWH.product_reviews_fact"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'product_reviews_fact'
        
        and table_schema = 'justeattakeaway'
        
      order by ordinal_position

  
[0m05:44:29.170749 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0 seconds
[0m05:44:29.185890 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.product_reviews_fact"
[0m05:44:29.185890 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "node_id": "model.Product_Reviews_DWH.product_reviews_fact"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'product_reviews_fact__dbt_tmp084320249501'
        
      order by ordinal_position

  
[0m05:44:29.189789 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0 seconds
[0m05:44:29.189789 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.product_reviews_fact"
[0m05:44:29.189789 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "node_id": "model.Product_Reviews_DWH.product_reviews_fact"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'product_reviews_fact'
        
        and table_schema = 'justeattakeaway'
        
      order by ordinal_position

  
[0m05:44:29.197772 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0 seconds
[0m05:44:29.207127 [debug] [Thread-1 (]: 
    In "postgres"."justeattakeaway"."product_reviews_fact":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m05:44:29.225645 [debug] [Thread-1 (]: Writing runtime sql for node "model.Product_Reviews_DWH.product_reviews_fact"
[0m05:44:29.227631 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.product_reviews_fact"
[0m05:44:29.227631 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "node_id": "model.Product_Reviews_DWH.product_reviews_fact"} */

      
        
            delete from "postgres"."justeattakeaway"."product_reviews_fact"
            where (
                sk_product_reviews_fact) in (
                select (sk_product_reviews_fact)
                from "product_reviews_fact__dbt_tmp084320249501"
            );

        
    

    insert into "postgres"."justeattakeaway"."product_reviews_fact" ("sk_product_reviews_fact", "date", "sk_product_dim", "sk_category_dim", "sk_price_bucket_dim", "sk_reviewer_dim", "product_price", "sales_rank", "overall_rating", "review_likes", "review_dislikes", "viewed_and_bought_count")
    (
        select "sk_product_reviews_fact", "date", "sk_product_dim", "sk_category_dim", "sk_price_bucket_dim", "sk_reviewer_dim", "product_price", "sales_rank", "overall_rating", "review_likes", "review_dislikes", "viewed_and_bought_count"
        from "product_reviews_fact__dbt_tmp084320249501"
    )
  
[0m05:44:29.735232 [debug] [Thread-1 (]: Postgres adapter: Postgres error: duplicate key value violates unique constraint "product_reviews_fact_2004_01_review_dt_sk_product_dim_sk_ca_key"
DETAIL:  Key (date, sk_product_dim, sk_category_dim, sk_price_bucket_dim, sk_reviewer_dim)=(2004-01-01, 5777924, 21280, 3, -1) already exists.

[0m05:44:29.735232 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: ROLLBACK
[0m05:44:29.735232 [debug] [Thread-1 (]: Timing info for model.Product_Reviews_DWH.product_reviews_fact (execute): 2023-04-04 05:43:20.228418 => 2023-04-04 05:44:29.735232
[0m05:44:29.735232 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: Close
[0m05:44:29.762812 [debug] [Thread-1 (]: Database Error in model product_reviews_fact (models\fact\product_reviews_fact.sql)
  duplicate key value violates unique constraint "product_reviews_fact_2004_01_review_dt_sk_product_dim_sk_ca_key"
  DETAIL:  Key (date, sk_product_dim, sk_category_dim, sk_price_bucket_dim, sk_reviewer_dim)=(2004-01-01, 5777924, 21280, 3, -1) already exists.
  compiled Code at target\run\Product_Reviews_DWH\models\fact\product_reviews_fact.sql
[0m05:44:29.762812 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ce99106-608c-48f6-be42-02f7e9933393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FEF6E0700>]}
[0m05:44:29.762812 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model justeattakeaway.product_reviews_fact  [[31mERROR[0m in 69.75s]
[0m05:44:29.762812 [debug] [Thread-1 (]: Finished running node model.Product_Reviews_DWH.product_reviews_fact
[0m05:44:29.769975 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:44:29.770970 [debug] [MainThread]: Using postgres connection "master"
[0m05:44:29.770970 [debug] [MainThread]: On master: BEGIN
[0m05:44:29.770970 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:44:29.924641 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m05:44:29.924641 [debug] [MainThread]: On master: COMMIT
[0m05:44:29.924641 [debug] [MainThread]: Using postgres connection "master"
[0m05:44:29.924641 [debug] [MainThread]: On master: COMMIT
[0m05:44:29.927178 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m05:44:29.927178 [debug] [MainThread]: On master: Close
[0m05:44:29.928180 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:44:29.928710 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m05:44:29.928710 [debug] [MainThread]: Connection 'list_postgres_justeattakeaway' was properly closed.
[0m05:44:29.928710 [debug] [MainThread]: Connection 'model.Product_Reviews_DWH.product_reviews_fact' was properly closed.
[0m05:44:29.929920 [info ] [MainThread]: 
[0m05:44:29.929920 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 1 minutes and 10.17 seconds (70.17s).
[0m05:44:29.930924 [debug] [MainThread]: Command end result
[0m05:44:29.947054 [info ] [MainThread]: 
[0m05:44:29.947054 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:44:29.947054 [info ] [MainThread]: 
[0m05:44:29.947054 [error] [MainThread]: [33mDatabase Error in model product_reviews_fact (models\fact\product_reviews_fact.sql)[0m
[0m05:44:29.947054 [error] [MainThread]:   duplicate key value violates unique constraint "product_reviews_fact_2004_01_review_dt_sk_product_dim_sk_ca_key"
[0m05:44:29.950598 [error] [MainThread]:   DETAIL:  Key (date, sk_product_dim, sk_category_dim, sk_price_bucket_dim, sk_reviewer_dim)=(2004-01-01, 5777924, 21280, 3, -1) already exists.
[0m05:44:29.950598 [error] [MainThread]:   compiled Code at target\run\Product_Reviews_DWH\models\fact\product_reviews_fact.sql
[0m05:44:29.951601 [info ] [MainThread]: 
[0m05:44:29.952600 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m05:44:29.953598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FEB9AA950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FEF82BEB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FEF82AFB0>]}
[0m05:44:29.953598 [debug] [MainThread]: Flushing usage events


============================== 2023-04-04 06:05:39.473979 | 6e779f08-0201-466f-8e9d-47c326dbd5df ==============================
[0m06:05:39.473979 [info ] [MainThread]: Running with dbt=1.4.5
[0m06:05:39.475525 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Furqan\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['fact'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m06:05:39.475979 [debug] [MainThread]: Tracking: tracking
[0m06:05:39.486980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B40A35FCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B40A35E500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B40A35ED10>]}
[0m06:05:39.499979 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m06:05:39.594367 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:05:39.595784 [debug] [MainThread]: Partial parsing: updated file: Product_Reviews_DWH://models\fact\product_reviews_fact.sql
[0m06:05:39.600386 [debug] [MainThread]: 1603: static parser failed on fact\product_reviews_fact.sql
[0m06:05:39.615802 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fact\product_reviews_fact.sql
[0m06:05:39.651224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e779f08-0201-466f-8e9d-47c326dbd5df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B406C9C0D0>]}
[0m06:05:39.664335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e779f08-0201-466f-8e9d-47c326dbd5df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B40A629240>]}
[0m06:05:39.666811 [info ] [MainThread]: Found 6 models, 59 tests, 1 snapshot, 0 analyses, 403 macros, 0 operations, 0 seed files, 10 sources, 0 exposures, 0 metrics
[0m06:05:39.667810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e779f08-0201-466f-8e9d-47c326dbd5df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B406BDAA10>]}
[0m06:05:39.668857 [info ] [MainThread]: 
[0m06:05:39.671855 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:05:39.673502 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m06:05:39.677147 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m06:05:39.677147 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m06:05:39.677147 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:05:39.718882 [debug] [ThreadPool]: SQL status: SELECT 25 in 0 seconds
[0m06:05:39.719878 [debug] [ThreadPool]: On list_postgres: Close
[0m06:05:39.721881 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_justeattakeaway'
[0m06:05:39.726878 [debug] [ThreadPool]: Using postgres connection "list_postgres_justeattakeaway"
[0m06:05:39.727878 [debug] [ThreadPool]: On list_postgres_justeattakeaway: BEGIN
[0m06:05:39.728303 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:05:39.758947 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m06:05:39.759947 [debug] [ThreadPool]: Using postgres connection "list_postgres_justeattakeaway"
[0m06:05:39.759947 [debug] [ThreadPool]: On list_postgres_justeattakeaway: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "connection_name": "list_postgres_justeattakeaway"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'justeattakeaway'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'justeattakeaway'
  
[0m06:05:39.766237 [debug] [ThreadPool]: SQL status: SELECT 492 in 0 seconds
[0m06:05:39.768005 [debug] [ThreadPool]: On list_postgres_justeattakeaway: ROLLBACK
[0m06:05:39.772865 [debug] [ThreadPool]: On list_postgres_justeattakeaway: Close
[0m06:05:39.845961 [debug] [MainThread]: Using postgres connection "master"
[0m06:05:39.845961 [debug] [MainThread]: On master: BEGIN
[0m06:05:39.848475 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:05:39.877118 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m06:05:39.877118 [debug] [MainThread]: Using postgres connection "master"
[0m06:05:39.878325 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:05:39.894350 [debug] [MainThread]: SQL status: SELECT 9 in 0 seconds
[0m06:05:39.894350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e779f08-0201-466f-8e9d-47c326dbd5df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B40A44A740>]}
[0m06:05:39.894350 [debug] [MainThread]: On master: ROLLBACK
[0m06:05:39.903040 [debug] [MainThread]: Using postgres connection "master"
[0m06:05:39.903040 [debug] [MainThread]: On master: BEGIN
[0m06:05:39.904047 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m06:05:39.904047 [debug] [MainThread]: On master: COMMIT
[0m06:05:39.905040 [debug] [MainThread]: Using postgres connection "master"
[0m06:05:39.905040 [debug] [MainThread]: On master: COMMIT
[0m06:05:39.905040 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m06:05:39.905040 [debug] [MainThread]: On master: Close
[0m06:05:39.906039 [info ] [MainThread]: Concurrency: 3 threads (target='prod')
[0m06:05:39.906039 [info ] [MainThread]: 
[0m06:05:39.912065 [debug] [Thread-1 (]: Began running node model.Product_Reviews_DWH.product_reviews_fact
[0m06:05:39.913067 [info ] [Thread-1 (]: 1 of 1 START sql incremental model justeattakeaway.product_reviews_fact ........ [RUN]
[0m06:05:39.914064 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Product_Reviews_DWH.product_reviews_fact'
[0m06:05:39.914064 [debug] [Thread-1 (]: Began compiling node model.Product_Reviews_DWH.product_reviews_fact
[0m06:05:39.927582 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.product_reviews_fact"
[0m06:05:39.928582 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "node_id": "model.Product_Reviews_DWH.product_reviews_fact"} */

        select coalesce(max(sk_product_reviews_fact),0) from  "postgres"."justeattakeaway"."product_reviews_fact"
    
[0m06:05:39.929090 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:05:40.120222 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0 seconds
[0m06:05:40.121261 [debug] [Thread-1 (]: Writing injected SQL for node "model.Product_Reviews_DWH.product_reviews_fact"
[0m06:05:40.122364 [debug] [Thread-1 (]: Timing info for model.Product_Reviews_DWH.product_reviews_fact (compile): 2023-04-04 06:05:39.915066 => 2023-04-04 06:05:40.122364
[0m06:05:40.122364 [debug] [Thread-1 (]: Began executing node model.Product_Reviews_DWH.product_reviews_fact
[0m06:05:40.166474 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.product_reviews_fact"
[0m06:05:40.166474 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "node_id": "model.Product_Reviews_DWH.product_reviews_fact"} */

    
  
    

  create temporary table "product_reviews_fact__dbt_tmp090540145594"
  as (
    

    

SELECT  
row_number() over()+0 as sk_product_reviews_fact,
'2002-01-01'::date as date,
coalesce(prd_dim.sk_product_dim,-1)::int4 as sk_product_dim,
coalesce(category.sk_category_dim,-1) as sk_category_dim,
coalesce(prd_bucket.sk_price_bucket_dim,-1) as sk_price_bucket_dim,
coalesce(reviewer_dim.sk_reviewer_dim,-1)::int4 as sk_reviewer_dim,
prd_dim_stg.price as product_price,
prd_dim_stg.sales_rank::int4 as sales_rank,
reviews_stag.overall::int4 as overall_rating,
reviews_stag.up_votes as review_likes,
reviews_stag.down_votes as review_dislikes,
prd_dim_stg.viewed_and_bought_count::int4 as viewed_and_bought_count
-- products dim table
FROM "postgres"."justeattakeaway"."products_dimension"  prd_dim
-- products staging table
JOIN "postgres"."justeattakeaway"."products_dim_staging"  prd_dim_stg 
ON prd_dim.asin = prd_dim_stg.asin
-- products category dim table
left join "postgres"."justeattakeaway"."product_category_dimension"  category
ON prd_dim_stg.category= category.category and prd_dim_stg.sub_category = category.sub_category 
-- price bucket dim table
LEFT JOIN "postgres"."justeattakeaway"."price_bucket_dimension"  prd_bucket
ON prd_dim_stg.price >= prd_bucket.bucket_lower_limit  and  prd_dim_stg.price<=prd_bucket.bucket_upper_limit
-- reviews staging table
LEFT JOIN "postgres"."justeattakeaway"."reviews_dim_staging"  as reviews_stag
ON prd_dim.asin = reviews_stag.asin and reviews_stag.review_date = '2002-01-01'
-- reviewer dim table
LEFT JOIN "postgres"."justeattakeaway"."reviewer_dimension"  reviewer_dim
ON reviews_stag.reviewerid =reviewer_dim.reviewerid and reviews_stag.review_date >=reviewer_dim.valid_from and reviews_stag.review_date <reviewer_dim.valid_to
  );
  
  
[0m06:06:53.229080 [debug] [Thread-1 (]: SQL status: SELECT 9430349 in 73 seconds
[0m06:06:53.229080 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.product_reviews_fact"
[0m06:06:53.229080 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: BEGIN
[0m06:06:53.258858 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:06:53.258858 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.product_reviews_fact"
[0m06:06:53.259866 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "node_id": "model.Product_Reviews_DWH.product_reviews_fact"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'product_reviews_fact__dbt_tmp090540145594'
        
      order by ordinal_position

  
[0m06:06:53.285373 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0 seconds
[0m06:06:53.291260 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.product_reviews_fact"
[0m06:06:53.291260 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "node_id": "model.Product_Reviews_DWH.product_reviews_fact"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'product_reviews_fact'
        
        and table_schema = 'justeattakeaway'
        
      order by ordinal_position

  
[0m06:06:53.294259 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0 seconds
[0m06:06:53.298260 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.product_reviews_fact"
[0m06:06:53.298260 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "node_id": "model.Product_Reviews_DWH.product_reviews_fact"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'product_reviews_fact__dbt_tmp090540145594'
        
      order by ordinal_position

  
[0m06:06:53.298260 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0 seconds
[0m06:06:53.314168 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.product_reviews_fact"
[0m06:06:53.314415 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "node_id": "model.Product_Reviews_DWH.product_reviews_fact"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'product_reviews_fact'
        
        and table_schema = 'justeattakeaway'
        
      order by ordinal_position

  
[0m06:06:53.315415 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0 seconds
[0m06:06:53.323429 [debug] [Thread-1 (]: 
    In "postgres"."justeattakeaway"."product_reviews_fact":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m06:06:53.439407 [debug] [Thread-1 (]: Writing runtime sql for node "model.Product_Reviews_DWH.product_reviews_fact"
[0m06:06:53.440605 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.product_reviews_fact"
[0m06:06:53.441793 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "node_id": "model.Product_Reviews_DWH.product_reviews_fact"} */

      
        
            delete from "postgres"."justeattakeaway"."product_reviews_fact"
            where (
                sk_product_reviews_fact) in (
                select (sk_product_reviews_fact)
                from "product_reviews_fact__dbt_tmp090540145594"
            );

        
    

    insert into "postgres"."justeattakeaway"."product_reviews_fact" ("sk_product_reviews_fact", "date", "sk_product_dim", "sk_category_dim", "sk_price_bucket_dim", "sk_reviewer_dim", "product_price", "sales_rank", "overall_rating", "review_likes", "review_dislikes", "viewed_and_bought_count")
    (
        select "sk_product_reviews_fact", "date", "sk_product_dim", "sk_category_dim", "sk_price_bucket_dim", "sk_reviewer_dim", "product_price", "sales_rank", "overall_rating", "review_likes", "review_dislikes", "viewed_and_bought_count"
        from "product_reviews_fact__dbt_tmp090540145594"
    )
  
[0m06:08:30.893144 [debug] [Thread-1 (]: Postgres adapter: Postgres error: duplicate key value violates unique constraint "product_reviews_fact_2002_01_review_dt_sk_product_dim_sk_ca_key"
DETAIL:  Key (date, sk_product_dim, sk_category_dim, sk_price_bucket_dim, sk_reviewer_dim)=(2002-01-01, 5700759, 9707, 1, -1) already exists.

[0m06:08:30.893795 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: ROLLBACK
[0m06:08:30.895795 [debug] [Thread-1 (]: Timing info for model.Product_Reviews_DWH.product_reviews_fact (execute): 2023-04-04 06:05:40.122364 => 2023-04-04 06:08:30.895795
[0m06:08:30.896795 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: Close
[0m06:08:31.183688 [debug] [Thread-1 (]: Database Error in model product_reviews_fact (models\fact\product_reviews_fact.sql)
  duplicate key value violates unique constraint "product_reviews_fact_2002_01_review_dt_sk_product_dim_sk_ca_key"
  DETAIL:  Key (date, sk_product_dim, sk_category_dim, sk_price_bucket_dim, sk_reviewer_dim)=(2002-01-01, 5700759, 9707, 1, -1) already exists.
  compiled Code at target\run\Product_Reviews_DWH\models\fact\product_reviews_fact.sql
[0m06:08:31.183688 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e779f08-0201-466f-8e9d-47c326dbd5df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B406C63700>]}
[0m06:08:31.183688 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model justeattakeaway.product_reviews_fact  [[31mERROR[0m in 171.27s]
[0m06:08:31.183688 [debug] [Thread-1 (]: Finished running node model.Product_Reviews_DWH.product_reviews_fact
[0m06:08:31.211082 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:08:31.212086 [debug] [MainThread]: Using postgres connection "master"
[0m06:08:31.212086 [debug] [MainThread]: On master: BEGIN
[0m06:08:31.212086 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:08:31.440491 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m06:08:31.440491 [debug] [MainThread]: On master: COMMIT
[0m06:08:31.440491 [debug] [MainThread]: Using postgres connection "master"
[0m06:08:31.441491 [debug] [MainThread]: On master: COMMIT
[0m06:08:31.442096 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m06:08:31.442096 [debug] [MainThread]: On master: Close
[0m06:08:31.443102 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:08:31.443607 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m06:08:31.443607 [debug] [MainThread]: Connection 'list_postgres_justeattakeaway' was properly closed.
[0m06:08:31.443607 [debug] [MainThread]: Connection 'model.Product_Reviews_DWH.product_reviews_fact' was properly closed.
[0m06:08:31.444611 [info ] [MainThread]: 
[0m06:08:31.444915 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 2 minutes and 51.77 seconds (171.77s).
[0m06:08:31.445925 [debug] [MainThread]: Command end result
[0m06:08:31.445925 [info ] [MainThread]: 
[0m06:08:31.445925 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m06:08:31.445925 [info ] [MainThread]: 
[0m06:08:31.445925 [error] [MainThread]: [33mDatabase Error in model product_reviews_fact (models\fact\product_reviews_fact.sql)[0m
[0m06:08:31.445925 [error] [MainThread]:   duplicate key value violates unique constraint "product_reviews_fact_2002_01_review_dt_sk_product_dim_sk_ca_key"
[0m06:08:31.462402 [error] [MainThread]:   DETAIL:  Key (date, sk_product_dim, sk_category_dim, sk_price_bucket_dim, sk_reviewer_dim)=(2002-01-01, 5700759, 9707, 1, -1) already exists.
[0m06:08:31.462402 [error] [MainThread]:   compiled Code at target\run\Product_Reviews_DWH\models\fact\product_reviews_fact.sql
[0m06:08:31.463422 [info ] [MainThread]: 
[0m06:08:31.463422 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m06:08:31.463422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B406BDA9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B40AA56C80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B40AA57670>]}
[0m06:08:31.463422 [debug] [MainThread]: Flushing usage events


============================== 2023-04-04 12:56:29.118303 | afa64dee-5920-4c81-a1cb-92a0f1bc097b ==============================
[0m12:56:29.118303 [info ] [MainThread]: Running with dbt=1.4.5
[0m12:56:29.120366 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Furqan\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['fact'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:56:29.121371 [debug] [MainThread]: Tracking: tracking
[0m12:56:29.134366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A8B93FF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A8B93E500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A8B93ED10>]}
[0m12:56:29.147366 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m12:56:29.245576 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 4 files changed.
[0m12:56:29.245576 [debug] [MainThread]: Partial parsing: added file: Product_Reviews_DWH://models\dimensions\product_dimension.sql
[0m12:56:29.254156 [debug] [MainThread]: Partial parsing: updated file: Product_Reviews_DWH://models\dimensions\schema.yml
[0m12:56:29.254156 [debug] [MainThread]: Partial parsing: updated file: Product_Reviews_DWH://models\fact\schema.yml
[0m12:56:29.254156 [debug] [MainThread]: Partial parsing: deleted file: Product_Reviews_DWH://models\dimensions\products_dimension.sql
[0m12:56:29.255154 [debug] [MainThread]: Partial parsing: updated file: Product_Reviews_DWH://models\fact\product_reviews_fact.sql
[0m12:56:29.255154 [debug] [MainThread]: Partial parsing: updated file: Product_Reviews_DWH://models\dimensions\product_category_dimension.sql
[0m12:56:29.265189 [debug] [MainThread]: 1603: static parser failed on dimensions\product_dimension.sql
[0m12:56:29.272087 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dimensions\product_dimension.sql
[0m12:56:29.272087 [debug] [MainThread]: 1603: static parser failed on fact\product_reviews_fact.sql
[0m12:56:29.283444 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fact\product_reviews_fact.sql
[0m12:56:29.283444 [debug] [MainThread]: 1603: static parser failed on dimensions\product_category_dimension.sql
[0m12:56:29.291392 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dimensions\product_category_dimension.sql
[0m12:56:29.291392 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'products_dimension' in the 'models' section of file 'models\dimensions\schema.yml'
[0m12:56:29.355485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A8820B850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A8BF00AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A8BF00310>]}
[0m12:56:29.355485 [debug] [MainThread]: Flushing usage events
[0m12:56:30.210246 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.Product_Reviews_DWH.product_reviews_fact' (models\fact\product_reviews_fact.sql) depends on a source named 'justeattakeaway.products_dimension' which was not found


============================== 2023-04-04 12:56:47.346607 | a164b31c-0358-41c3-8824-33f7170d7e85 ==============================
[0m12:56:47.346607 [info ] [MainThread]: Running with dbt=1.4.5
[0m12:56:47.349770 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Furqan\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['fact'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:56:47.349770 [debug] [MainThread]: Tracking: tracking
[0m12:56:47.360770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E53B60DAB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E53B60E3E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E53B60EFE0>]}
[0m12:56:47.372769 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m12:56:47.447972 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 4 files changed.
[0m12:56:47.448983 [debug] [MainThread]: Partial parsing: added file: Product_Reviews_DWH://models\dimensions\product_dimension.sql
[0m12:56:47.448983 [debug] [MainThread]: Partial parsing: updated file: Product_Reviews_DWH://models\fact\schema.yml
[0m12:56:47.449907 [debug] [MainThread]: Partial parsing: updated file: Product_Reviews_DWH://models\dimensions\schema.yml
[0m12:56:47.449907 [debug] [MainThread]: Partial parsing: deleted file: Product_Reviews_DWH://models\dimensions\products_dimension.sql
[0m12:56:47.449907 [debug] [MainThread]: Partial parsing: updated file: Product_Reviews_DWH://models\dimensions\product_category_dimension.sql
[0m12:56:47.449907 [debug] [MainThread]: Partial parsing: updated file: Product_Reviews_DWH://models\fact\product_reviews_fact.sql
[0m12:56:47.456988 [debug] [MainThread]: 1603: static parser failed on dimensions\product_dimension.sql
[0m12:56:47.465973 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dimensions\product_dimension.sql
[0m12:56:47.465973 [debug] [MainThread]: 1603: static parser failed on fact\product_reviews_fact.sql
[0m12:56:47.476550 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fact\product_reviews_fact.sql
[0m12:56:47.476550 [debug] [MainThread]: 1603: static parser failed on dimensions\product_category_dimension.sql
[0m12:56:47.484708 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dimensions\product_category_dimension.sql
[0m12:56:47.505408 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'products_dimension' in the 'models' section of file 'models\dimensions\schema.yml'
[0m12:56:47.547161 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.Product_Reviews_DWH.not_null_products_dimension_sk_product_dim.9da2ae0ab6' (models\dimensions\schema.yml) depends on a node named 'products_dimension' in package '' which was not found
[0m12:56:47.548361 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.Product_Reviews_DWH.unique_products_dimension_sk_product_dim.218f62dbcb' (models\dimensions\schema.yml) depends on a node named 'products_dimension' in package '' which was not found
[0m12:56:47.549162 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.Product_Reviews_DWH.not_null_products_dimension_asin.cc7e6b16ed' (models\dimensions\schema.yml) depends on a node named 'products_dimension' in package '' which was not found
[0m12:56:47.550162 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.Product_Reviews_DWH.unique_products_dimension_asin.3961e8e90f' (models\dimensions\schema.yml) depends on a node named 'products_dimension' in package '' which was not found
[0m12:56:47.550162 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.Product_Reviews_DWH.not_null_products_dimension_title.75ca694e37' (models\dimensions\schema.yml) depends on a node named 'products_dimension' in package '' which was not found
[0m12:56:47.551161 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.Product_Reviews_DWH.not_null_products_dimension_description.4244806376' (models\dimensions\schema.yml) depends on a node named 'products_dimension' in package '' which was not found
[0m12:56:47.552162 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.Product_Reviews_DWH.not_null_products_dimension_image_url.09aa1b86cb' (models\dimensions\schema.yml) depends on a node named 'products_dimension' in package '' which was not found
[0m12:56:47.552346 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.Product_Reviews_DWH.not_null_products_dimension_also_viewed.c6982fca29' (models\dimensions\schema.yml) depends on a node named 'products_dimension' in package '' which was not found
[0m12:56:47.553162 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.Product_Reviews_DWH.not_null_products_dimension_also_bought.2a97558d1e' (models\dimensions\schema.yml) depends on a node named 'products_dimension' in package '' which was not found
[0m12:56:47.554163 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.Product_Reviews_DWH.not_null_products_dimension_bought_together.f30f19b364' (models\dimensions\schema.yml) depends on a node named 'products_dimension' in package '' which was not found
[0m12:56:47.555163 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.Product_Reviews_DWH.not_null_products_dimension_buy_after_viewing.05d93e4ba3' (models\dimensions\schema.yml) depends on a node named 'products_dimension' in package '' which was not found
[0m12:56:47.555163 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.Product_Reviews_DWH.not_null_products_dimension_viewed_and_bought_flag.1f90d3ba7f' (models\dimensions\schema.yml) depends on a node named 'products_dimension' in package '' which was not found
[0m12:56:47.556162 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.Product_Reviews_DWH.not_null_products_dimension_viewed_and_bought.178d4339f1' (models\dimensions\schema.yml) depends on a node named 'products_dimension' in package '' which was not found
[0m12:56:47.570162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a164b31c-0358-41c3-8824-33f7170d7e85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E53BC3DAE0>]}
[0m12:56:47.583160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a164b31c-0358-41c3-8824-33f7170d7e85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E53B8C0310>]}
[0m12:56:47.584160 [info ] [MainThread]: Found 6 models, 45 tests, 1 snapshot, 0 analyses, 403 macros, 0 operations, 0 seed files, 10 sources, 0 exposures, 0 metrics
[0m12:56:47.585160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a164b31c-0358-41c3-8824-33f7170d7e85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E53B8C02B0>]}
[0m12:56:47.587161 [info ] [MainThread]: 
[0m12:56:47.589252 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:56:47.591160 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m12:56:47.599252 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m12:56:47.599252 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m12:56:47.600160 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:56:47.643710 [debug] [ThreadPool]: SQL status: SELECT 25 in 0 seconds
[0m12:56:47.645712 [debug] [ThreadPool]: On list_postgres: Close
[0m12:56:47.647783 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_justeattakeaway'
[0m12:56:47.705118 [debug] [ThreadPool]: Using postgres connection "list_postgres_justeattakeaway"
[0m12:56:47.705118 [debug] [ThreadPool]: On list_postgres_justeattakeaway: BEGIN
[0m12:56:47.705118 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:56:47.861725 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m12:56:47.861725 [debug] [ThreadPool]: Using postgres connection "list_postgres_justeattakeaway"
[0m12:56:47.862712 [debug] [ThreadPool]: On list_postgres_justeattakeaway: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "connection_name": "list_postgres_justeattakeaway"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'justeattakeaway'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'justeattakeaway'
  
[0m12:56:47.872158 [debug] [ThreadPool]: SQL status: SELECT 262 in 0 seconds
[0m12:56:47.872158 [debug] [ThreadPool]: On list_postgres_justeattakeaway: ROLLBACK
[0m12:56:47.876638 [debug] [ThreadPool]: On list_postgres_justeattakeaway: Close
[0m12:56:47.890632 [debug] [MainThread]: Using postgres connection "master"
[0m12:56:47.890632 [debug] [MainThread]: On master: BEGIN
[0m12:56:47.890632 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:56:47.922292 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m12:56:47.923295 [debug] [MainThread]: Using postgres connection "master"
[0m12:56:47.923693 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:56:47.937418 [debug] [MainThread]: SQL status: SELECT 7 in 0 seconds
[0m12:56:47.945718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a164b31c-0358-41c3-8824-33f7170d7e85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E53B6F6440>]}
[0m12:56:47.946721 [debug] [MainThread]: On master: ROLLBACK
[0m12:56:47.946721 [debug] [MainThread]: Using postgres connection "master"
[0m12:56:47.947716 [debug] [MainThread]: On master: BEGIN
[0m12:56:47.948075 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m12:56:47.948075 [debug] [MainThread]: On master: COMMIT
[0m12:56:47.948075 [debug] [MainThread]: Using postgres connection "master"
[0m12:56:47.949078 [debug] [MainThread]: On master: COMMIT
[0m12:56:47.949078 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m12:56:47.949078 [debug] [MainThread]: On master: Close
[0m12:56:47.950078 [info ] [MainThread]: Concurrency: 3 threads (target='prod')
[0m12:56:47.951080 [info ] [MainThread]: 
[0m12:56:47.957927 [debug] [Thread-1 (]: Began running node model.Product_Reviews_DWH.product_reviews_fact
[0m12:56:47.957927 [info ] [Thread-1 (]: 1 of 1 START sql incremental model justeattakeaway.product_reviews_fact ........ [RUN]
[0m12:56:47.958966 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Product_Reviews_DWH.product_reviews_fact'
[0m12:56:47.959907 [debug] [Thread-1 (]: Began compiling node model.Product_Reviews_DWH.product_reviews_fact
[0m12:56:47.971041 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.product_reviews_fact"
[0m12:56:47.971041 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "node_id": "model.Product_Reviews_DWH.product_reviews_fact"} */

        select coalesce(max(sk_product_reviews_fact),0) from  "postgres"."justeattakeaway"."product_reviews_fact"
    
[0m12:56:47.972041 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:56:48.005132 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0 seconds
[0m12:56:48.006039 [debug] [Thread-1 (]: Writing injected SQL for node "model.Product_Reviews_DWH.product_reviews_fact"
[0m12:56:48.007229 [debug] [Thread-1 (]: Timing info for model.Product_Reviews_DWH.product_reviews_fact (compile): 2023-04-04 12:56:47.959966 => 2023-04-04 12:56:48.007229
[0m12:56:48.008039 [debug] [Thread-1 (]: Began executing node model.Product_Reviews_DWH.product_reviews_fact
[0m12:56:48.048041 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.product_reviews_fact"
[0m12:56:48.048041 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "node_id": "model.Product_Reviews_DWH.product_reviews_fact"} */

    
  
    

  create temporary table "product_reviews_fact__dbt_tmp155648030039"
  as (
    

    

SELECT  
row_number() over()+0 as sk_product_reviews_fact,
'2000-01-01'::date as date,
coalesce(prd_dim.sk_product_dim,-1)::int4 as sk_product_dim,
coalesce(category.sk_category_dim,-1) as sk_category_dim,
coalesce(prd_bucket.sk_price_bucket_dim,-1) as sk_price_bucket_dim,
coalesce(reviewer_dim.sk_reviewer_dim,-1)::int4 as sk_reviewer_dim,
prd_dim_stg.price as product_price,
prd_dim_stg.sales_rank::int4 as sales_rank,
reviews_stag.overall::int4 as overall_rating,
reviews_stag.up_votes as review_likes,
reviews_stag.down_votes as review_dislikes,
prd_dim_stg.viewed_and_bought_count::int4 as viewed_and_bought_count
-- products dim table
FROM "postgres"."justeattakeaway"."product_dimension"  prd_dim
-- products staging table
JOIN "postgres"."justeattakeaway"."products_dim_staging"  prd_dim_stg 
ON prd_dim.asin = prd_dim_stg.asin
-- products category dim table
left join "postgres"."justeattakeaway"."product_category_dimension"  category
ON prd_dim_stg.category= category.category and prd_dim_stg.sub_category = category.sub_category 
-- price bucket dim table
LEFT JOIN "postgres"."justeattakeaway"."price_bucket_dimension"  prd_bucket
ON prd_dim_stg.price >= prd_bucket.bucket_lower_limit  and  prd_dim_stg.price<=prd_bucket.bucket_upper_limit
-- reviews staging table
LEFT JOIN "postgres"."justeattakeaway"."reviews_dim_staging"  as reviews_stag
ON prd_dim.asin = reviews_stag.asin and reviews_stag.review_date = '2000-01-01'
-- reviewer dim table
LEFT JOIN "postgres"."justeattakeaway"."reviewer_dimension"  reviewer_dim
ON reviews_stag.reviewerid =reviewer_dim.reviewerid and reviews_stag.review_date >=reviewer_dim.valid_from and reviews_stag.review_date <reviewer_dim.valid_to
  );
  
  
[0m12:56:48.050310 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "justeattakeaway.product_dimension" does not exist
LINE 27: FROM "postgres"."justeattakeaway"."product_dimension"  prd_d...
              ^

[0m12:56:48.051310 [debug] [Thread-1 (]: Timing info for model.Product_Reviews_DWH.product_reviews_fact (execute): 2023-04-04 12:56:48.008039 => 2023-04-04 12:56:48.051310
[0m12:56:48.051310 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: Close
[0m12:56:48.070788 [debug] [Thread-1 (]: Database Error in model product_reviews_fact (models\fact\product_reviews_fact.sql)
  relation "justeattakeaway.product_dimension" does not exist
  LINE 27: FROM "postgres"."justeattakeaway"."product_dimension"  prd_d...
                ^
[0m12:56:48.070788 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a164b31c-0358-41c3-8824-33f7170d7e85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E53B70F460>]}
[0m12:56:48.071952 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model justeattakeaway.product_reviews_fact  [[31mERROR[0m in 0.11s]
[0m12:56:48.073953 [debug] [Thread-1 (]: Finished running node model.Product_Reviews_DWH.product_reviews_fact
[0m12:56:48.075263 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:56:48.075263 [debug] [MainThread]: Using postgres connection "master"
[0m12:56:48.076160 [debug] [MainThread]: On master: BEGIN
[0m12:56:48.076160 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:56:48.105956 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m12:56:48.106922 [debug] [MainThread]: On master: COMMIT
[0m12:56:48.106922 [debug] [MainThread]: Using postgres connection "master"
[0m12:56:48.106922 [debug] [MainThread]: On master: COMMIT
[0m12:56:48.107953 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m12:56:48.107953 [debug] [MainThread]: On master: Close
[0m12:56:48.107953 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:56:48.107953 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m12:56:48.108954 [debug] [MainThread]: Connection 'list_postgres_justeattakeaway' was properly closed.
[0m12:56:48.108954 [debug] [MainThread]: Connection 'model.Product_Reviews_DWH.product_reviews_fact' was properly closed.
[0m12:56:48.108954 [info ] [MainThread]: 
[0m12:56:48.109957 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m12:56:48.109957 [debug] [MainThread]: Command end result
[0m12:56:48.119955 [info ] [MainThread]: 
[0m12:56:48.120185 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:56:48.120957 [info ] [MainThread]: 
[0m12:56:48.120957 [error] [MainThread]: [33mDatabase Error in model product_reviews_fact (models\fact\product_reviews_fact.sql)[0m
[0m12:56:48.121957 [error] [MainThread]:   relation "justeattakeaway.product_dimension" does not exist
[0m12:56:48.121957 [error] [MainThread]:   LINE 27: FROM "postgres"."justeattakeaway"."product_dimension"  prd_d...
[0m12:56:48.122955 [error] [MainThread]:                 ^
[0m12:56:48.122955 [info ] [MainThread]: 
[0m12:56:48.123958 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:56:48.123958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E53B8C0340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E53B8C03D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E53B60F310>]}
[0m12:56:48.124956 [debug] [MainThread]: Flushing usage events


============================== 2023-04-04 12:57:11.254847 | d9d3a9fc-313d-461b-8f91-f5cf99a0001b ==============================
[0m12:57:11.254847 [info ] [MainThread]: Running with dbt=1.4.5
[0m12:57:11.259727 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Furqan\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
[0m12:57:11.260568 [debug] [MainThread]: Tracking: tracking
[0m12:57:11.270724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1755DFEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1755DE4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1755DECE0>]}
[0m12:57:11.282723 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m12:57:11.352716 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:57:11.352716 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:57:11.359322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd9d3a9fc-313d-461b-8f91-f5cf99a0001b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A171EB82E0>]}
[0m12:57:11.374077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd9d3a9fc-313d-461b-8f91-f5cf99a0001b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A171E7AEC0>]}
[0m12:57:11.374077 [info ] [MainThread]: Found 6 models, 45 tests, 1 snapshot, 0 analyses, 403 macros, 0 operations, 0 seed files, 10 sources, 0 exposures, 0 metrics
[0m12:57:11.375598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9d3a9fc-313d-461b-8f91-f5cf99a0001b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A171E7ADD0>]}
[0m12:57:11.377988 [info ] [MainThread]: 
[0m12:57:11.379596 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:57:11.381600 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_justeattakeaway'
[0m12:57:11.390568 [debug] [ThreadPool]: Using postgres connection "list_postgres_justeattakeaway"
[0m12:57:11.390568 [debug] [ThreadPool]: On list_postgres_justeattakeaway: BEGIN
[0m12:57:11.391082 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:11.424784 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m12:57:11.424784 [debug] [ThreadPool]: Using postgres connection "list_postgres_justeattakeaway"
[0m12:57:11.425935 [debug] [ThreadPool]: On list_postgres_justeattakeaway: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "connection_name": "list_postgres_justeattakeaway"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'justeattakeaway'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'justeattakeaway'
  
[0m12:57:11.430784 [debug] [ThreadPool]: SQL status: SELECT 262 in 0 seconds
[0m12:57:11.435784 [debug] [ThreadPool]: On list_postgres_justeattakeaway: ROLLBACK
[0m12:57:11.436063 [debug] [ThreadPool]: On list_postgres_justeattakeaway: Close
[0m12:57:11.445784 [debug] [MainThread]: Using postgres connection "master"
[0m12:57:11.445784 [debug] [MainThread]: On master: BEGIN
[0m12:57:11.445784 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:57:11.499833 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m12:57:11.500853 [debug] [MainThread]: Using postgres connection "master"
[0m12:57:11.501160 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:57:11.508396 [debug] [MainThread]: SQL status: SELECT 7 in 0 seconds
[0m12:57:11.517917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9d3a9fc-313d-461b-8f91-f5cf99a0001b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A171EA6680>]}
[0m12:57:11.519088 [debug] [MainThread]: On master: ROLLBACK
[0m12:57:11.519088 [debug] [MainThread]: On master: Close
[0m12:57:11.520106 [info ] [MainThread]: Concurrency: 3 threads (target='prod')
[0m12:57:11.520614 [info ] [MainThread]: 
[0m12:57:11.525102 [debug] [Thread-1 (]: Began running node model.Product_Reviews_DWH.calendar_dimension
[0m12:57:11.525916 [debug] [Thread-2 (]: Began running node model.Product_Reviews_DWH.product_category_dimension
[0m12:57:11.525916 [debug] [Thread-3 (]: Began running node model.Product_Reviews_DWH.product_dimension
[0m12:57:11.526917 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Product_Reviews_DWH.calendar_dimension'
[0m12:57:11.527277 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.Product_Reviews_DWH.product_category_dimension'
[0m12:57:11.527945 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.Product_Reviews_DWH.product_dimension'
[0m12:57:11.527945 [debug] [Thread-1 (]: Began compiling node model.Product_Reviews_DWH.calendar_dimension
[0m12:57:11.528952 [debug] [Thread-2 (]: Began compiling node model.Product_Reviews_DWH.product_category_dimension
[0m12:57:11.528952 [debug] [Thread-3 (]: Began compiling node model.Product_Reviews_DWH.product_dimension
[0m12:57:11.536948 [debug] [Thread-1 (]: Writing injected SQL for node "model.Product_Reviews_DWH.calendar_dimension"
[0m12:57:11.542946 [debug] [Thread-2 (]: Writing injected SQL for node "model.Product_Reviews_DWH.product_category_dimension"
[0m12:57:11.547947 [debug] [Thread-3 (]: Writing injected SQL for node "model.Product_Reviews_DWH.product_dimension"
[0m12:57:11.548946 [debug] [Thread-1 (]: Timing info for model.Product_Reviews_DWH.calendar_dimension (compile): 2023-04-04 12:57:11.528952 => 2023-04-04 12:57:11.548946
[0m12:57:11.549948 [debug] [Thread-2 (]: Timing info for model.Product_Reviews_DWH.product_category_dimension (compile): 2023-04-04 12:57:11.536948 => 2023-04-04 12:57:11.549948
[0m12:57:11.549948 [debug] [Thread-1 (]: Began executing node model.Product_Reviews_DWH.calendar_dimension
[0m12:57:11.549948 [debug] [Thread-3 (]: Timing info for model.Product_Reviews_DWH.product_dimension (compile): 2023-04-04 12:57:11.542946 => 2023-04-04 12:57:11.549948
[0m12:57:11.549948 [debug] [Thread-2 (]: Began executing node model.Product_Reviews_DWH.product_category_dimension
[0m12:57:11.550947 [debug] [Thread-1 (]: Timing info for model.Product_Reviews_DWH.calendar_dimension (execute): 2023-04-04 12:57:11.550947 => 2023-04-04 12:57:11.550947
[0m12:57:11.550947 [debug] [Thread-3 (]: Began executing node model.Product_Reviews_DWH.product_dimension
[0m12:57:11.550947 [debug] [Thread-2 (]: Timing info for model.Product_Reviews_DWH.product_category_dimension (execute): 2023-04-04 12:57:11.550947 => 2023-04-04 12:57:11.550947
[0m12:57:11.552948 [debug] [Thread-1 (]: Finished running node model.Product_Reviews_DWH.calendar_dimension
[0m12:57:11.553949 [debug] [Thread-3 (]: Timing info for model.Product_Reviews_DWH.product_dimension (execute): 2023-04-04 12:57:11.552948 => 2023-04-04 12:57:11.552948
[0m12:57:11.554951 [debug] [Thread-2 (]: Finished running node model.Product_Reviews_DWH.product_category_dimension
[0m12:57:11.554951 [debug] [Thread-1 (]: Began running node model.Product_Reviews_DWH.product_reviews_fact
[0m12:57:11.555950 [debug] [Thread-3 (]: Finished running node model.Product_Reviews_DWH.product_dimension
[0m12:57:11.555950 [debug] [Thread-2 (]: Began running node model.Product_Reviews_DWH.products_dim_staging
[0m12:57:11.556946 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Product_Reviews_DWH.product_reviews_fact'
[0m12:57:11.556946 [debug] [Thread-3 (]: Began running node model.Product_Reviews_DWH.reviews_dim_staging
[0m12:57:11.557946 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.Product_Reviews_DWH.products_dim_staging'
[0m12:57:11.558158 [debug] [Thread-1 (]: Began compiling node model.Product_Reviews_DWH.product_reviews_fact
[0m12:57:11.558158 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.Product_Reviews_DWH.reviews_dim_staging'
[0m12:57:11.558946 [debug] [Thread-2 (]: Began compiling node model.Product_Reviews_DWH.products_dim_staging
[0m12:57:11.569698 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.product_reviews_fact"
[0m12:57:11.569949 [debug] [Thread-3 (]: Began compiling node model.Product_Reviews_DWH.reviews_dim_staging
[0m12:57:11.572946 [debug] [Thread-2 (]: Writing injected SQL for node "model.Product_Reviews_DWH.products_dim_staging"
[0m12:57:11.573501 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "node_id": "model.Product_Reviews_DWH.product_reviews_fact"} */

        select coalesce(max(sk_product_reviews_fact),0) from  "postgres"."justeattakeaway"."product_reviews_fact"
    
[0m12:57:11.575456 [debug] [Thread-3 (]: Writing injected SQL for node "model.Product_Reviews_DWH.reviews_dim_staging"
[0m12:57:11.576295 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:57:11.576295 [debug] [Thread-2 (]: Timing info for model.Product_Reviews_DWH.products_dim_staging (compile): 2023-04-04 12:57:11.569949 => 2023-04-04 12:57:11.576295
[0m12:57:11.577296 [debug] [Thread-2 (]: Began executing node model.Product_Reviews_DWH.products_dim_staging
[0m12:57:11.577296 [debug] [Thread-3 (]: Timing info for model.Product_Reviews_DWH.reviews_dim_staging (compile): 2023-04-04 12:57:11.573501 => 2023-04-04 12:57:11.577296
[0m12:57:11.577296 [debug] [Thread-2 (]: Timing info for model.Product_Reviews_DWH.products_dim_staging (execute): 2023-04-04 12:57:11.577296 => 2023-04-04 12:57:11.577296
[0m12:57:11.577296 [debug] [Thread-3 (]: Began executing node model.Product_Reviews_DWH.reviews_dim_staging
[0m12:57:11.578297 [debug] [Thread-2 (]: Finished running node model.Product_Reviews_DWH.products_dim_staging
[0m12:57:11.578297 [debug] [Thread-3 (]: Timing info for model.Product_Reviews_DWH.reviews_dim_staging (execute): 2023-04-04 12:57:11.578297 => 2023-04-04 12:57:11.578297
[0m12:57:11.579403 [debug] [Thread-2 (]: Began running node snapshot.Product_Reviews_DWH.reviewer_dimension
[0m12:57:11.580296 [debug] [Thread-3 (]: Finished running node model.Product_Reviews_DWH.reviews_dim_staging
[0m12:57:11.580296 [debug] [Thread-2 (]: Acquiring new postgres connection 'snapshot.Product_Reviews_DWH.reviewer_dimension'
[0m12:57:11.581297 [debug] [Thread-3 (]: Began running node test.Product_Reviews_DWH.not_null_calendar_dimension_date.1811cd9d25
[0m12:57:11.581297 [debug] [Thread-2 (]: Began compiling node snapshot.Product_Reviews_DWH.reviewer_dimension
[0m12:57:11.582296 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.Product_Reviews_DWH.not_null_calendar_dimension_date.1811cd9d25'
[0m12:57:11.586434 [debug] [Thread-2 (]: Using postgres connection "snapshot.Product_Reviews_DWH.reviewer_dimension"
[0m12:57:11.586434 [debug] [Thread-3 (]: Began compiling node test.Product_Reviews_DWH.not_null_calendar_dimension_date.1811cd9d25
[0m12:57:11.586434 [debug] [Thread-2 (]: On snapshot.Product_Reviews_DWH.reviewer_dimension: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "node_id": "snapshot.Product_Reviews_DWH.reviewer_dimension"} */

    select max(sk_reviewer_dim) from  "postgres"."justeattakeaway"."reviewer_dimension"

[0m12:57:11.595609 [debug] [Thread-3 (]: Writing injected SQL for node "test.Product_Reviews_DWH.not_null_calendar_dimension_date.1811cd9d25"
[0m12:57:11.596218 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:57:11.597218 [debug] [Thread-3 (]: Timing info for test.Product_Reviews_DWH.not_null_calendar_dimension_date.1811cd9d25 (compile): 2023-04-04 12:57:11.586434 => 2023-04-04 12:57:11.596218
[0m12:57:11.597218 [debug] [Thread-3 (]: Began executing node test.Product_Reviews_DWH.not_null_calendar_dimension_date.1811cd9d25
[0m12:57:11.597715 [debug] [Thread-3 (]: Timing info for test.Product_Reviews_DWH.not_null_calendar_dimension_date.1811cd9d25 (execute): 2023-04-04 12:57:11.597715 => 2023-04-04 12:57:11.597715
[0m12:57:11.597715 [debug] [Thread-3 (]: Finished running node test.Product_Reviews_DWH.not_null_calendar_dimension_date.1811cd9d25
[0m12:57:11.597715 [debug] [Thread-3 (]: Began running node test.Product_Reviews_DWH.not_null_calendar_dimension_month.24752f0e40
[0m12:57:11.598716 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.Product_Reviews_DWH.not_null_calendar_dimension_month.24752f0e40'
[0m12:57:11.598716 [debug] [Thread-3 (]: Began compiling node test.Product_Reviews_DWH.not_null_calendar_dimension_month.24752f0e40
[0m12:57:11.601601 [debug] [Thread-3 (]: Writing injected SQL for node "test.Product_Reviews_DWH.not_null_calendar_dimension_month.24752f0e40"
[0m12:57:11.602602 [debug] [Thread-3 (]: Timing info for test.Product_Reviews_DWH.not_null_calendar_dimension_month.24752f0e40 (compile): 2023-04-04 12:57:11.598716 => 2023-04-04 12:57:11.602602
[0m12:57:11.603605 [debug] [Thread-3 (]: Began executing node test.Product_Reviews_DWH.not_null_calendar_dimension_month.24752f0e40
[0m12:57:11.603605 [debug] [Thread-3 (]: Timing info for test.Product_Reviews_DWH.not_null_calendar_dimension_month.24752f0e40 (execute): 2023-04-04 12:57:11.603605 => 2023-04-04 12:57:11.603605
[0m12:57:11.603605 [debug] [Thread-3 (]: Finished running node test.Product_Reviews_DWH.not_null_calendar_dimension_month.24752f0e40
[0m12:57:11.604606 [debug] [Thread-3 (]: Began running node test.Product_Reviews_DWH.not_null_calendar_dimension_quarter.bbb1999089
[0m12:57:11.604606 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.Product_Reviews_DWH.not_null_calendar_dimension_quarter.bbb1999089'
[0m12:57:11.605602 [debug] [Thread-3 (]: Began compiling node test.Product_Reviews_DWH.not_null_calendar_dimension_quarter.bbb1999089
[0m12:57:11.607969 [debug] [Thread-3 (]: Writing injected SQL for node "test.Product_Reviews_DWH.not_null_calendar_dimension_quarter.bbb1999089"
[0m12:57:11.607969 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0 seconds
[0m12:57:11.610344 [debug] [Thread-1 (]: Writing injected SQL for node "model.Product_Reviews_DWH.product_reviews_fact"
[0m12:57:11.611049 [debug] [Thread-3 (]: Timing info for test.Product_Reviews_DWH.not_null_calendar_dimension_quarter.bbb1999089 (compile): 2023-04-04 12:57:11.605602 => 2023-04-04 12:57:11.611049
[0m12:57:11.611049 [debug] [Thread-3 (]: Began executing node test.Product_Reviews_DWH.not_null_calendar_dimension_quarter.bbb1999089
[0m12:57:11.611049 [debug] [Thread-1 (]: Timing info for model.Product_Reviews_DWH.product_reviews_fact (compile): 2023-04-04 12:57:11.558946 => 2023-04-04 12:57:11.611049
[0m12:57:11.612050 [debug] [Thread-3 (]: Timing info for test.Product_Reviews_DWH.not_null_calendar_dimension_quarter.bbb1999089 (execute): 2023-04-04 12:57:11.611049 => 2023-04-04 12:57:11.611049
[0m12:57:11.612050 [debug] [Thread-1 (]: Began executing node model.Product_Reviews_DWH.product_reviews_fact
[0m12:57:11.613052 [debug] [Thread-3 (]: Finished running node test.Product_Reviews_DWH.not_null_calendar_dimension_quarter.bbb1999089
[0m12:57:11.613052 [debug] [Thread-1 (]: Timing info for model.Product_Reviews_DWH.product_reviews_fact (execute): 2023-04-04 12:57:11.613052 => 2023-04-04 12:57:11.613052
[0m12:57:11.613052 [debug] [Thread-3 (]: Began running node test.Product_Reviews_DWH.not_null_calendar_dimension_year.37f29d819a
[0m12:57:11.613900 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: Close
[0m12:57:11.613900 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.Product_Reviews_DWH.not_null_calendar_dimension_year.37f29d819a'
[0m12:57:11.614900 [debug] [Thread-1 (]: Finished running node model.Product_Reviews_DWH.product_reviews_fact
[0m12:57:11.614900 [debug] [Thread-3 (]: Began compiling node test.Product_Reviews_DWH.not_null_calendar_dimension_year.37f29d819a
[0m12:57:11.615899 [debug] [Thread-1 (]: Began running node test.Product_Reviews_DWH.unique_calendar_dimension_date.53721bbf4e
[0m12:57:11.619899 [debug] [Thread-3 (]: Writing injected SQL for node "test.Product_Reviews_DWH.not_null_calendar_dimension_year.37f29d819a"
[0m12:57:11.619899 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.Product_Reviews_DWH.unique_calendar_dimension_date.53721bbf4e'
[0m12:57:11.621688 [debug] [Thread-1 (]: Began compiling node test.Product_Reviews_DWH.unique_calendar_dimension_date.53721bbf4e
[0m12:57:11.676762 [debug] [Thread-1 (]: Writing injected SQL for node "test.Product_Reviews_DWH.unique_calendar_dimension_date.53721bbf4e"
[0m12:57:11.676762 [debug] [Thread-3 (]: Timing info for test.Product_Reviews_DWH.not_null_calendar_dimension_year.37f29d819a (compile): 2023-04-04 12:57:11.615899 => 2023-04-04 12:57:11.676762
[0m12:57:11.677841 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0 seconds
[0m12:57:11.677841 [debug] [Thread-3 (]: Began executing node test.Product_Reviews_DWH.not_null_calendar_dimension_year.37f29d819a
[0m12:57:11.678842 [debug] [Thread-2 (]: Timing info for snapshot.Product_Reviews_DWH.reviewer_dimension (compile): 2023-04-04 12:57:11.582296 => 2023-04-04 12:57:11.678842
[0m12:57:11.679839 [debug] [Thread-1 (]: Timing info for test.Product_Reviews_DWH.unique_calendar_dimension_date.53721bbf4e (compile): 2023-04-04 12:57:11.621688 => 2023-04-04 12:57:11.678842
[0m12:57:11.680056 [debug] [Thread-3 (]: Timing info for test.Product_Reviews_DWH.not_null_calendar_dimension_year.37f29d819a (execute): 2023-04-04 12:57:11.680056 => 2023-04-04 12:57:11.680056
[0m12:57:11.680056 [debug] [Thread-2 (]: Began executing node snapshot.Product_Reviews_DWH.reviewer_dimension
[0m12:57:11.680056 [debug] [Thread-1 (]: Began executing node test.Product_Reviews_DWH.unique_calendar_dimension_date.53721bbf4e
[0m12:57:11.681061 [debug] [Thread-3 (]: Finished running node test.Product_Reviews_DWH.not_null_calendar_dimension_year.37f29d819a
[0m12:57:11.681061 [debug] [Thread-2 (]: Timing info for snapshot.Product_Reviews_DWH.reviewer_dimension (execute): 2023-04-04 12:57:11.681061 => 2023-04-04 12:57:11.681061
[0m12:57:11.682056 [debug] [Thread-1 (]: Timing info for test.Product_Reviews_DWH.unique_calendar_dimension_date.53721bbf4e (execute): 2023-04-04 12:57:11.682056 => 2023-04-04 12:57:11.682056
[0m12:57:11.682056 [debug] [Thread-3 (]: Began running node test.Product_Reviews_DWH.not_null_product_category_dimension_category.9703448502
[0m12:57:11.683058 [debug] [Thread-2 (]: On snapshot.Product_Reviews_DWH.reviewer_dimension: Close
[0m12:57:11.683058 [debug] [Thread-1 (]: Finished running node test.Product_Reviews_DWH.unique_calendar_dimension_date.53721bbf4e
[0m12:57:11.684057 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.Product_Reviews_DWH.not_null_product_category_dimension_category.9703448502'
[0m12:57:11.684057 [debug] [Thread-2 (]: Finished running node snapshot.Product_Reviews_DWH.reviewer_dimension
[0m12:57:11.684057 [debug] [Thread-1 (]: Began running node test.Product_Reviews_DWH.not_null_product_category_dimension_sk_category_dim.109faf0798
[0m12:57:11.685059 [debug] [Thread-3 (]: Began compiling node test.Product_Reviews_DWH.not_null_product_category_dimension_category.9703448502
[0m12:57:11.685059 [debug] [Thread-2 (]: Began running node test.Product_Reviews_DWH.not_null_product_category_dimension_sub_category.1e749a47cb
[0m12:57:11.686059 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.Product_Reviews_DWH.not_null_product_category_dimension_sk_category_dim.109faf0798'
[0m12:57:11.689546 [debug] [Thread-3 (]: Writing injected SQL for node "test.Product_Reviews_DWH.not_null_product_category_dimension_category.9703448502"
[0m12:57:11.689903 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.Product_Reviews_DWH.not_null_product_category_dimension_sub_category.1e749a47cb'
[0m12:57:11.689903 [debug] [Thread-1 (]: Began compiling node test.Product_Reviews_DWH.not_null_product_category_dimension_sk_category_dim.109faf0798
[0m12:57:11.690906 [debug] [Thread-2 (]: Began compiling node test.Product_Reviews_DWH.not_null_product_category_dimension_sub_category.1e749a47cb
[0m12:57:11.692904 [debug] [Thread-1 (]: Writing injected SQL for node "test.Product_Reviews_DWH.not_null_product_category_dimension_sk_category_dim.109faf0798"
[0m12:57:11.694497 [debug] [Thread-3 (]: Timing info for test.Product_Reviews_DWH.not_null_product_category_dimension_category.9703448502 (compile): 2023-04-04 12:57:11.686059 => 2023-04-04 12:57:11.692904
[0m12:57:11.695497 [debug] [Thread-2 (]: Writing injected SQL for node "test.Product_Reviews_DWH.not_null_product_category_dimension_sub_category.1e749a47cb"
[0m12:57:11.697865 [debug] [Thread-3 (]: Began executing node test.Product_Reviews_DWH.not_null_product_category_dimension_category.9703448502
[0m12:57:11.697865 [debug] [Thread-1 (]: Timing info for test.Product_Reviews_DWH.not_null_product_category_dimension_sk_category_dim.109faf0798 (compile): 2023-04-04 12:57:11.690906 => 2023-04-04 12:57:11.697865
[0m12:57:11.697865 [debug] [Thread-3 (]: Timing info for test.Product_Reviews_DWH.not_null_product_category_dimension_category.9703448502 (execute): 2023-04-04 12:57:11.697865 => 2023-04-04 12:57:11.697865
[0m12:57:11.698983 [debug] [Thread-2 (]: Timing info for test.Product_Reviews_DWH.not_null_product_category_dimension_sub_category.1e749a47cb (compile): 2023-04-04 12:57:11.694497 => 2023-04-04 12:57:11.698865
[0m12:57:11.698983 [debug] [Thread-1 (]: Began executing node test.Product_Reviews_DWH.not_null_product_category_dimension_sk_category_dim.109faf0798
[0m12:57:11.698983 [debug] [Thread-3 (]: Finished running node test.Product_Reviews_DWH.not_null_product_category_dimension_category.9703448502
[0m12:57:11.700219 [debug] [Thread-2 (]: Began executing node test.Product_Reviews_DWH.not_null_product_category_dimension_sub_category.1e749a47cb
[0m12:57:11.700219 [debug] [Thread-1 (]: Timing info for test.Product_Reviews_DWH.not_null_product_category_dimension_sk_category_dim.109faf0798 (execute): 2023-04-04 12:57:11.700219 => 2023-04-04 12:57:11.700219
[0m12:57:11.700219 [debug] [Thread-3 (]: Began running node test.Product_Reviews_DWH.unique_product_category_dimension_sk_category_dim.d17de9d145
[0m12:57:11.701221 [debug] [Thread-2 (]: Timing info for test.Product_Reviews_DWH.not_null_product_category_dimension_sub_category.1e749a47cb (execute): 2023-04-04 12:57:11.701221 => 2023-04-04 12:57:11.701221
[0m12:57:11.701221 [debug] [Thread-1 (]: Finished running node test.Product_Reviews_DWH.not_null_product_category_dimension_sk_category_dim.109faf0798
[0m12:57:11.702261 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.Product_Reviews_DWH.unique_product_category_dimension_sk_category_dim.d17de9d145'
[0m12:57:11.702626 [debug] [Thread-2 (]: Finished running node test.Product_Reviews_DWH.not_null_product_category_dimension_sub_category.1e749a47cb
[0m12:57:11.702626 [debug] [Thread-1 (]: Began running node test.Product_Reviews_DWH.not_null_products_dim_staging_also_bought.57fcbe2eda
[0m12:57:11.702626 [debug] [Thread-3 (]: Began compiling node test.Product_Reviews_DWH.unique_product_category_dimension_sk_category_dim.d17de9d145
[0m12:57:11.703628 [debug] [Thread-2 (]: Began running node test.Product_Reviews_DWH.not_null_products_dim_staging_also_viewed.b23009cd9d
[0m12:57:11.703628 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.Product_Reviews_DWH.not_null_products_dim_staging_also_bought.57fcbe2eda'
[0m12:57:11.706628 [debug] [Thread-3 (]: Writing injected SQL for node "test.Product_Reviews_DWH.unique_product_category_dimension_sk_category_dim.d17de9d145"
[0m12:57:11.708023 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.Product_Reviews_DWH.not_null_products_dim_staging_also_viewed.b23009cd9d'
[0m12:57:11.708023 [debug] [Thread-1 (]: Began compiling node test.Product_Reviews_DWH.not_null_products_dim_staging_also_bought.57fcbe2eda
[0m12:57:11.709156 [debug] [Thread-2 (]: Began compiling node test.Product_Reviews_DWH.not_null_products_dim_staging_also_viewed.b23009cd9d
[0m12:57:11.710156 [debug] [Thread-1 (]: Writing injected SQL for node "test.Product_Reviews_DWH.not_null_products_dim_staging_also_bought.57fcbe2eda"
[0m12:57:11.712504 [debug] [Thread-3 (]: Timing info for test.Product_Reviews_DWH.unique_product_category_dimension_sk_category_dim.d17de9d145 (compile): 2023-04-04 12:57:11.703628 => 2023-04-04 12:57:11.710156
[0m12:57:11.714505 [debug] [Thread-2 (]: Writing injected SQL for node "test.Product_Reviews_DWH.not_null_products_dim_staging_also_viewed.b23009cd9d"
[0m12:57:11.715651 [debug] [Thread-3 (]: Began executing node test.Product_Reviews_DWH.unique_product_category_dimension_sk_category_dim.d17de9d145
[0m12:57:11.715651 [debug] [Thread-3 (]: Timing info for test.Product_Reviews_DWH.unique_product_category_dimension_sk_category_dim.d17de9d145 (execute): 2023-04-04 12:57:11.715651 => 2023-04-04 12:57:11.715651
[0m12:57:11.715651 [debug] [Thread-1 (]: Timing info for test.Product_Reviews_DWH.not_null_products_dim_staging_also_bought.57fcbe2eda (compile): 2023-04-04 12:57:11.709156 => 2023-04-04 12:57:11.715651
[0m12:57:11.716654 [debug] [Thread-3 (]: Finished running node test.Product_Reviews_DWH.unique_product_category_dimension_sk_category_dim.d17de9d145
[0m12:57:11.716654 [debug] [Thread-2 (]: Timing info for test.Product_Reviews_DWH.not_null_products_dim_staging_also_viewed.b23009cd9d (compile): 2023-04-04 12:57:11.712504 => 2023-04-04 12:57:11.716654
[0m12:57:11.716654 [debug] [Thread-1 (]: Began executing node test.Product_Reviews_DWH.not_null_products_dim_staging_also_bought.57fcbe2eda
[0m12:57:11.717653 [debug] [Thread-3 (]: Began running node test.Product_Reviews_DWH.not_null_products_dim_staging_asin.ef464247a4
[0m12:57:11.717653 [debug] [Thread-2 (]: Began executing node test.Product_Reviews_DWH.not_null_products_dim_staging_also_viewed.b23009cd9d
[0m12:57:11.718315 [debug] [Thread-1 (]: Timing info for test.Product_Reviews_DWH.not_null_products_dim_staging_also_bought.57fcbe2eda (execute): 2023-04-04 12:57:11.718315 => 2023-04-04 12:57:11.718315
[0m12:57:11.718315 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.Product_Reviews_DWH.not_null_products_dim_staging_asin.ef464247a4'
[0m12:57:11.718315 [debug] [Thread-2 (]: Timing info for test.Product_Reviews_DWH.not_null_products_dim_staging_also_viewed.b23009cd9d (execute): 2023-04-04 12:57:11.718315 => 2023-04-04 12:57:11.718315
[0m12:57:11.719462 [debug] [Thread-1 (]: Finished running node test.Product_Reviews_DWH.not_null_products_dim_staging_also_bought.57fcbe2eda
[0m12:57:11.719462 [debug] [Thread-3 (]: Began compiling node test.Product_Reviews_DWH.not_null_products_dim_staging_asin.ef464247a4
[0m12:57:11.720461 [debug] [Thread-2 (]: Finished running node test.Product_Reviews_DWH.not_null_products_dim_staging_also_viewed.b23009cd9d
[0m12:57:11.720919 [debug] [Thread-1 (]: Began running node test.Product_Reviews_DWH.not_null_products_dim_staging_bought_together.e3cae5f62d
[0m12:57:11.722919 [debug] [Thread-3 (]: Writing injected SQL for node "test.Product_Reviews_DWH.not_null_products_dim_staging_asin.ef464247a4"
[0m12:57:11.722919 [debug] [Thread-2 (]: Began running node test.Product_Reviews_DWH.not_null_products_dim_staging_buy_after_viewing.d986a6b310
[0m12:57:11.725677 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.Product_Reviews_DWH.not_null_products_dim_staging_bought_together.e3cae5f62d'
[0m12:57:11.726677 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.Product_Reviews_DWH.not_null_products_dim_staging_buy_after_viewing.d986a6b310'
[0m12:57:11.726677 [debug] [Thread-1 (]: Began compiling node test.Product_Reviews_DWH.not_null_products_dim_staging_bought_together.e3cae5f62d
[0m12:57:11.726677 [debug] [Thread-3 (]: Timing info for test.Product_Reviews_DWH.not_null_products_dim_staging_asin.ef464247a4 (compile): 2023-04-04 12:57:11.720919 => 2023-04-04 12:57:11.726677
[0m12:57:11.726677 [debug] [Thread-2 (]: Began compiling node test.Product_Reviews_DWH.not_null_products_dim_staging_buy_after_viewing.d986a6b310
[0m12:57:11.728677 [debug] [Thread-1 (]: Writing injected SQL for node "test.Product_Reviews_DWH.not_null_products_dim_staging_bought_together.e3cae5f62d"
[0m12:57:11.730463 [debug] [Thread-3 (]: Began executing node test.Product_Reviews_DWH.not_null_products_dim_staging_asin.ef464247a4
[0m12:57:11.732462 [debug] [Thread-2 (]: Writing injected SQL for node "test.Product_Reviews_DWH.not_null_products_dim_staging_buy_after_viewing.d986a6b310"
[0m12:57:11.733637 [debug] [Thread-3 (]: Timing info for test.Product_Reviews_DWH.not_null_products_dim_staging_asin.ef464247a4 (execute): 2023-04-04 12:57:11.733637 => 2023-04-04 12:57:11.733637
[0m12:57:11.733637 [debug] [Thread-1 (]: Timing info for test.Product_Reviews_DWH.not_null_products_dim_staging_bought_together.e3cae5f62d (compile): 2023-04-04 12:57:11.727675 => 2023-04-04 12:57:11.733637
[0m12:57:11.734637 [debug] [Thread-3 (]: Finished running node test.Product_Reviews_DWH.not_null_products_dim_staging_asin.ef464247a4
[0m12:57:11.734637 [debug] [Thread-2 (]: Timing info for test.Product_Reviews_DWH.not_null_products_dim_staging_buy_after_viewing.d986a6b310 (compile): 2023-04-04 12:57:11.730463 => 2023-04-04 12:57:11.734637
[0m12:57:11.734637 [debug] [Thread-1 (]: Began executing node test.Product_Reviews_DWH.not_null_products_dim_staging_bought_together.e3cae5f62d
[0m12:57:11.735637 [debug] [Thread-3 (]: Began running node test.Product_Reviews_DWH.not_null_products_dim_staging_category.636de613d6
[0m12:57:11.735637 [debug] [Thread-2 (]: Began executing node test.Product_Reviews_DWH.not_null_products_dim_staging_buy_after_viewing.d986a6b310
[0m12:57:11.735637 [debug] [Thread-1 (]: Timing info for test.Product_Reviews_DWH.not_null_products_dim_staging_bought_together.e3cae5f62d (execute): 2023-04-04 12:57:11.735637 => 2023-04-04 12:57:11.735637
[0m12:57:11.736636 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.Product_Reviews_DWH.not_null_products_dim_staging_category.636de613d6'
[0m12:57:11.736636 [debug] [Thread-2 (]: Timing info for test.Product_Reviews_DWH.not_null_products_dim_staging_buy_after_viewing.d986a6b310 (execute): 2023-04-04 12:57:11.736636 => 2023-04-04 12:57:11.736636
[0m12:57:11.737636 [debug] [Thread-1 (]: Finished running node test.Product_Reviews_DWH.not_null_products_dim_staging_bought_together.e3cae5f62d
[0m12:57:11.737636 [debug] [Thread-3 (]: Began compiling node test.Product_Reviews_DWH.not_null_products_dim_staging_category.636de613d6
[0m12:57:11.738638 [debug] [Thread-2 (]: Finished running node test.Product_Reviews_DWH.not_null_products_dim_staging_buy_after_viewing.d986a6b310
[0m12:57:11.738638 [debug] [Thread-1 (]: Began running node test.Product_Reviews_DWH.not_null_products_dim_staging_description.b7f9463bed
[0m12:57:11.740636 [debug] [Thread-3 (]: Writing injected SQL for node "test.Product_Reviews_DWH.not_null_products_dim_staging_category.636de613d6"
[0m12:57:11.742463 [debug] [Thread-2 (]: Began running node test.Product_Reviews_DWH.not_null_products_dim_staging_image_url.5d86eeff18
[0m12:57:11.742463 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.Product_Reviews_DWH.not_null_products_dim_staging_description.b7f9463bed'
[0m12:57:11.743463 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.Product_Reviews_DWH.not_null_products_dim_staging_image_url.5d86eeff18'
[0m12:57:11.743463 [debug] [Thread-1 (]: Began compiling node test.Product_Reviews_DWH.not_null_products_dim_staging_description.b7f9463bed
[0m12:57:11.743463 [debug] [Thread-3 (]: Timing info for test.Product_Reviews_DWH.not_null_products_dim_staging_category.636de613d6 (compile): 2023-04-04 12:57:11.738638 => 2023-04-04 12:57:11.743463
[0m12:57:11.744464 [debug] [Thread-2 (]: Began compiling node test.Product_Reviews_DWH.not_null_products_dim_staging_image_url.5d86eeff18
[0m12:57:11.746462 [debug] [Thread-1 (]: Writing injected SQL for node "test.Product_Reviews_DWH.not_null_products_dim_staging_description.b7f9463bed"
[0m12:57:11.747928 [debug] [Thread-3 (]: Began executing node test.Product_Reviews_DWH.not_null_products_dim_staging_category.636de613d6
[0m12:57:11.749928 [debug] [Thread-2 (]: Writing injected SQL for node "test.Product_Reviews_DWH.not_null_products_dim_staging_image_url.5d86eeff18"
[0m12:57:11.751312 [debug] [Thread-3 (]: Timing info for test.Product_Reviews_DWH.not_null_products_dim_staging_category.636de613d6 (execute): 2023-04-04 12:57:11.751312 => 2023-04-04 12:57:11.751312
[0m12:57:11.751312 [debug] [Thread-1 (]: Timing info for test.Product_Reviews_DWH.not_null_products_dim_staging_description.b7f9463bed (compile): 2023-04-04 12:57:11.744464 => 2023-04-04 12:57:11.751312
[0m12:57:11.752315 [debug] [Thread-3 (]: Finished running node test.Product_Reviews_DWH.not_null_products_dim_staging_category.636de613d6
[0m12:57:11.752315 [debug] [Thread-1 (]: Began executing node test.Product_Reviews_DWH.not_null_products_dim_staging_description.b7f9463bed
[0m12:57:11.752315 [debug] [Thread-2 (]: Timing info for test.Product_Reviews_DWH.not_null_products_dim_staging_image_url.5d86eeff18 (compile): 2023-04-04 12:57:11.747928 => 2023-04-04 12:57:11.752315
[0m12:57:11.753312 [debug] [Thread-3 (]: Began running node test.Product_Reviews_DWH.not_null_products_dim_staging_price.0f56a66be2
[0m12:57:11.753312 [debug] [Thread-1 (]: Timing info for test.Product_Reviews_DWH.not_null_products_dim_staging_description.b7f9463bed (execute): 2023-04-04 12:57:11.753312 => 2023-04-04 12:57:11.753312
[0m12:57:11.753312 [debug] [Thread-2 (]: Began executing node test.Product_Reviews_DWH.not_null_products_dim_staging_image_url.5d86eeff18
[0m12:57:11.754174 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.Product_Reviews_DWH.not_null_products_dim_staging_price.0f56a66be2'
[0m12:57:11.754174 [debug] [Thread-1 (]: Finished running node test.Product_Reviews_DWH.not_null_products_dim_staging_description.b7f9463bed
[0m12:57:11.755175 [debug] [Thread-2 (]: Timing info for test.Product_Reviews_DWH.not_null_products_dim_staging_image_url.5d86eeff18 (execute): 2023-04-04 12:57:11.755175 => 2023-04-04 12:57:11.755175
[0m12:57:11.755175 [debug] [Thread-3 (]: Began compiling node test.Product_Reviews_DWH.not_null_products_dim_staging_price.0f56a66be2
[0m12:57:11.755175 [debug] [Thread-1 (]: Began running node test.Product_Reviews_DWH.not_null_products_dim_staging_process_flag.2f2ec1f81c
[0m12:57:11.756210 [debug] [Thread-2 (]: Finished running node test.Product_Reviews_DWH.not_null_products_dim_staging_image_url.5d86eeff18
[0m12:57:11.758210 [debug] [Thread-3 (]: Writing injected SQL for node "test.Product_Reviews_DWH.not_null_products_dim_staging_price.0f56a66be2"
[0m12:57:11.759473 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.Product_Reviews_DWH.not_null_products_dim_staging_process_flag.2f2ec1f81c'
[0m12:57:11.759473 [debug] [Thread-2 (]: Began running node test.Product_Reviews_DWH.not_null_products_dim_staging_sales_rank.4ee25efb48
[0m12:57:11.760474 [debug] [Thread-1 (]: Began compiling node test.Product_Reviews_DWH.not_null_products_dim_staging_process_flag.2f2ec1f81c
[0m12:57:11.760474 [debug] [Thread-3 (]: Timing info for test.Product_Reviews_DWH.not_null_products_dim_staging_price.0f56a66be2 (compile): 2023-04-04 12:57:11.756210 => 2023-04-04 12:57:11.760474
[0m12:57:11.760474 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.Product_Reviews_DWH.not_null_products_dim_staging_sales_rank.4ee25efb48'
[0m12:57:11.762473 [debug] [Thread-1 (]: Writing injected SQL for node "test.Product_Reviews_DWH.not_null_products_dim_staging_process_flag.2f2ec1f81c"
[0m12:57:11.765340 [debug] [Thread-3 (]: Began executing node test.Product_Reviews_DWH.not_null_products_dim_staging_price.0f56a66be2
[0m12:57:11.765340 [debug] [Thread-2 (]: Began compiling node test.Product_Reviews_DWH.not_null_products_dim_staging_sales_rank.4ee25efb48
[0m12:57:11.765340 [debug] [Thread-3 (]: Timing info for test.Product_Reviews_DWH.not_null_products_dim_staging_price.0f56a66be2 (execute): 2023-04-04 12:57:11.765340 => 2023-04-04 12:57:11.765340
[0m12:57:11.767341 [debug] [Thread-2 (]: Writing injected SQL for node "test.Product_Reviews_DWH.not_null_products_dim_staging_sales_rank.4ee25efb48"
[0m12:57:11.767341 [debug] [Thread-1 (]: Timing info for test.Product_Reviews_DWH.not_null_products_dim_staging_process_flag.2f2ec1f81c (compile): 2023-04-04 12:57:11.761473 => 2023-04-04 12:57:11.767341
[0m12:57:11.769709 [debug] [Thread-3 (]: Finished running node test.Product_Reviews_DWH.not_null_products_dim_staging_price.0f56a66be2
[0m12:57:11.770873 [debug] [Thread-1 (]: Began executing node test.Product_Reviews_DWH.not_null_products_dim_staging_process_flag.2f2ec1f81c
[0m12:57:11.770873 [debug] [Thread-3 (]: Began running node test.Product_Reviews_DWH.not_null_products_dim_staging_sub_category.f62adb443d
[0m12:57:11.770873 [debug] [Thread-2 (]: Timing info for test.Product_Reviews_DWH.not_null_products_dim_staging_sales_rank.4ee25efb48 (compile): 2023-04-04 12:57:11.766342 => 2023-04-04 12:57:11.770873
[0m12:57:11.771876 [debug] [Thread-1 (]: Timing info for test.Product_Reviews_DWH.not_null_products_dim_staging_process_flag.2f2ec1f81c (execute): 2023-04-04 12:57:11.771876 => 2023-04-04 12:57:11.771876
[0m12:57:11.771876 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.Product_Reviews_DWH.not_null_products_dim_staging_sub_category.f62adb443d'
[0m12:57:11.772780 [debug] [Thread-2 (]: Began executing node test.Product_Reviews_DWH.not_null_products_dim_staging_sales_rank.4ee25efb48
[0m12:57:11.772780 [debug] [Thread-1 (]: Finished running node test.Product_Reviews_DWH.not_null_products_dim_staging_process_flag.2f2ec1f81c
[0m12:57:11.772780 [debug] [Thread-3 (]: Began compiling node test.Product_Reviews_DWH.not_null_products_dim_staging_sub_category.f62adb443d
[0m12:57:11.773781 [debug] [Thread-2 (]: Timing info for test.Product_Reviews_DWH.not_null_products_dim_staging_sales_rank.4ee25efb48 (execute): 2023-04-04 12:57:11.773781 => 2023-04-04 12:57:11.773781
[0m12:57:11.773781 [debug] [Thread-1 (]: Began running node test.Product_Reviews_DWH.not_null_products_dim_staging_title.54db2383dc
[0m12:57:11.775811 [debug] [Thread-3 (]: Writing injected SQL for node "test.Product_Reviews_DWH.not_null_products_dim_staging_sub_category.f62adb443d"
[0m12:57:11.777680 [debug] [Thread-2 (]: Finished running node test.Product_Reviews_DWH.not_null_products_dim_staging_sales_rank.4ee25efb48
[0m12:57:11.778683 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.Product_Reviews_DWH.not_null_products_dim_staging_title.54db2383dc'
[0m12:57:11.778683 [debug] [Thread-2 (]: Began running node test.Product_Reviews_DWH.not_null_products_dim_staging_viewed_and_bought.9565ceb561
[0m12:57:11.778683 [debug] [Thread-1 (]: Began compiling node test.Product_Reviews_DWH.not_null_products_dim_staging_title.54db2383dc
[0m12:57:11.779681 [debug] [Thread-3 (]: Timing info for test.Product_Reviews_DWH.not_null_products_dim_staging_sub_category.f62adb443d (compile): 2023-04-04 12:57:11.773781 => 2023-04-04 12:57:11.779681
[0m12:57:11.779681 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.Product_Reviews_DWH.not_null_products_dim_staging_viewed_and_bought.9565ceb561'
[0m12:57:11.781681 [debug] [Thread-1 (]: Writing injected SQL for node "test.Product_Reviews_DWH.not_null_products_dim_staging_title.54db2383dc"
[0m12:57:11.783113 [debug] [Thread-3 (]: Began executing node test.Product_Reviews_DWH.not_null_products_dim_staging_sub_category.f62adb443d
[0m12:57:11.783113 [debug] [Thread-2 (]: Began compiling node test.Product_Reviews_DWH.not_null_products_dim_staging_viewed_and_bought.9565ceb561
[0m12:57:11.783113 [debug] [Thread-3 (]: Timing info for test.Product_Reviews_DWH.not_null_products_dim_staging_sub_category.f62adb443d (execute): 2023-04-04 12:57:11.783113 => 2023-04-04 12:57:11.783113
[0m12:57:11.784114 [debug] [Thread-1 (]: Timing info for test.Product_Reviews_DWH.not_null_products_dim_staging_title.54db2383dc (compile): 2023-04-04 12:57:11.779681 => 2023-04-04 12:57:11.784114
[0m12:57:11.787114 [debug] [Thread-2 (]: Writing injected SQL for node "test.Product_Reviews_DWH.not_null_products_dim_staging_viewed_and_bought.9565ceb561"
[0m12:57:11.787757 [debug] [Thread-3 (]: Finished running node test.Product_Reviews_DWH.not_null_products_dim_staging_sub_category.f62adb443d
[0m12:57:11.787757 [debug] [Thread-1 (]: Began executing node test.Product_Reviews_DWH.not_null_products_dim_staging_title.54db2383dc
[0m12:57:11.788809 [debug] [Thread-3 (]: Began running node test.Product_Reviews_DWH.not_null_products_dim_staging_viewed_and_bought_count.26e5a1c3b4
[0m12:57:11.788809 [debug] [Thread-2 (]: Timing info for test.Product_Reviews_DWH.not_null_products_dim_staging_viewed_and_bought.9565ceb561 (compile): 2023-04-04 12:57:11.784114 => 2023-04-04 12:57:11.788809
[0m12:57:11.788809 [debug] [Thread-1 (]: Timing info for test.Product_Reviews_DWH.not_null_products_dim_staging_title.54db2383dc (execute): 2023-04-04 12:57:11.788809 => 2023-04-04 12:57:11.788809
[0m12:57:11.789810 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.Product_Reviews_DWH.not_null_products_dim_staging_viewed_and_bought_count.26e5a1c3b4'
[0m12:57:11.789810 [debug] [Thread-2 (]: Began executing node test.Product_Reviews_DWH.not_null_products_dim_staging_viewed_and_bought.9565ceb561
[0m12:57:11.790810 [debug] [Thread-1 (]: Finished running node test.Product_Reviews_DWH.not_null_products_dim_staging_title.54db2383dc
[0m12:57:11.790810 [debug] [Thread-3 (]: Began compiling node test.Product_Reviews_DWH.not_null_products_dim_staging_viewed_and_bought_count.26e5a1c3b4
[0m12:57:11.790810 [debug] [Thread-2 (]: Timing info for test.Product_Reviews_DWH.not_null_products_dim_staging_viewed_and_bought.9565ceb561 (execute): 2023-04-04 12:57:11.790810 => 2023-04-04 12:57:11.790810
[0m12:57:11.791812 [debug] [Thread-1 (]: Began running node test.Product_Reviews_DWH.not_null_products_dim_staging_viewed_and_bought_flag.6f7112aba3
[0m12:57:11.793809 [debug] [Thread-3 (]: Writing injected SQL for node "test.Product_Reviews_DWH.not_null_products_dim_staging_viewed_and_bought_count.26e5a1c3b4"
[0m12:57:11.794774 [debug] [Thread-2 (]: Finished running node test.Product_Reviews_DWH.not_null_products_dim_staging_viewed_and_bought.9565ceb561
[0m12:57:11.794774 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.Product_Reviews_DWH.not_null_products_dim_staging_viewed_and_bought_flag.6f7112aba3'
[0m12:57:11.795853 [debug] [Thread-2 (]: Began running node test.Product_Reviews_DWH.unique_products_dim_staging_asin.e9f586cc9b
[0m12:57:11.795853 [debug] [Thread-1 (]: Began compiling node test.Product_Reviews_DWH.not_null_products_dim_staging_viewed_and_bought_flag.6f7112aba3
[0m12:57:11.795853 [debug] [Thread-3 (]: Timing info for test.Product_Reviews_DWH.not_null_products_dim_staging_viewed_and_bought_count.26e5a1c3b4 (compile): 2023-04-04 12:57:11.791812 => 2023-04-04 12:57:11.795853
[0m12:57:11.796854 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.Product_Reviews_DWH.unique_products_dim_staging_asin.e9f586cc9b'
[0m12:57:11.798856 [debug] [Thread-1 (]: Writing injected SQL for node "test.Product_Reviews_DWH.not_null_products_dim_staging_viewed_and_bought_flag.6f7112aba3"
[0m12:57:11.800137 [debug] [Thread-3 (]: Began executing node test.Product_Reviews_DWH.not_null_products_dim_staging_viewed_and_bought_count.26e5a1c3b4
[0m12:57:11.800137 [debug] [Thread-2 (]: Began compiling node test.Product_Reviews_DWH.unique_products_dim_staging_asin.e9f586cc9b
[0m12:57:11.800137 [debug] [Thread-3 (]: Timing info for test.Product_Reviews_DWH.not_null_products_dim_staging_viewed_and_bought_count.26e5a1c3b4 (execute): 2023-04-04 12:57:11.800137 => 2023-04-04 12:57:11.800137
[0m12:57:11.803227 [debug] [Thread-2 (]: Writing injected SQL for node "test.Product_Reviews_DWH.unique_products_dim_staging_asin.e9f586cc9b"
[0m12:57:11.803227 [debug] [Thread-1 (]: Timing info for test.Product_Reviews_DWH.not_null_products_dim_staging_viewed_and_bought_flag.6f7112aba3 (compile): 2023-04-04 12:57:11.796854 => 2023-04-04 12:57:11.803227
[0m12:57:11.804608 [debug] [Thread-3 (]: Finished running node test.Product_Reviews_DWH.not_null_products_dim_staging_viewed_and_bought_count.26e5a1c3b4
[0m12:57:11.804608 [debug] [Thread-1 (]: Began executing node test.Product_Reviews_DWH.not_null_products_dim_staging_viewed_and_bought_flag.6f7112aba3
[0m12:57:11.805611 [debug] [Thread-2 (]: Timing info for test.Product_Reviews_DWH.unique_products_dim_staging_asin.e9f586cc9b (compile): 2023-04-04 12:57:11.801228 => 2023-04-04 12:57:11.805611
[0m12:57:11.805611 [debug] [Thread-3 (]: Began running node test.Product_Reviews_DWH.not_null_reviews_dim_staging_asin.007b8bc016
[0m12:57:11.805611 [debug] [Thread-1 (]: Timing info for test.Product_Reviews_DWH.not_null_products_dim_staging_viewed_and_bought_flag.6f7112aba3 (execute): 2023-04-04 12:57:11.805611 => 2023-04-04 12:57:11.805611
[0m12:57:11.806609 [debug] [Thread-2 (]: Began executing node test.Product_Reviews_DWH.unique_products_dim_staging_asin.e9f586cc9b
[0m12:57:11.806609 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.Product_Reviews_DWH.not_null_reviews_dim_staging_asin.007b8bc016'
[0m12:57:11.806609 [debug] [Thread-1 (]: Finished running node test.Product_Reviews_DWH.not_null_products_dim_staging_viewed_and_bought_flag.6f7112aba3
[0m12:57:11.807609 [debug] [Thread-2 (]: Timing info for test.Product_Reviews_DWH.unique_products_dim_staging_asin.e9f586cc9b (execute): 2023-04-04 12:57:11.807609 => 2023-04-04 12:57:11.807609
[0m12:57:11.807609 [debug] [Thread-3 (]: Began compiling node test.Product_Reviews_DWH.not_null_reviews_dim_staging_asin.007b8bc016
[0m12:57:11.807609 [debug] [Thread-1 (]: Began running node test.Product_Reviews_DWH.not_null_reviews_dim_staging_down_votes.2b0956cbec
[0m12:57:11.808608 [debug] [Thread-2 (]: Finished running node test.Product_Reviews_DWH.unique_products_dim_staging_asin.e9f586cc9b
[0m12:57:11.811236 [debug] [Thread-3 (]: Writing injected SQL for node "test.Product_Reviews_DWH.not_null_reviews_dim_staging_asin.007b8bc016"
[0m12:57:11.813443 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.Product_Reviews_DWH.not_null_reviews_dim_staging_down_votes.2b0956cbec'
[0m12:57:11.813443 [debug] [Thread-2 (]: Began running node test.Product_Reviews_DWH.not_null_reviews_dim_staging_helpful.a1fef06d2e
[0m12:57:11.814495 [debug] [Thread-1 (]: Began compiling node test.Product_Reviews_DWH.not_null_reviews_dim_staging_down_votes.2b0956cbec
[0m12:57:11.814495 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.Product_Reviews_DWH.not_null_reviews_dim_staging_helpful.a1fef06d2e'
[0m12:57:11.817594 [debug] [Thread-1 (]: Writing injected SQL for node "test.Product_Reviews_DWH.not_null_reviews_dim_staging_down_votes.2b0956cbec"
[0m12:57:11.817594 [debug] [Thread-3 (]: Timing info for test.Product_Reviews_DWH.not_null_reviews_dim_staging_asin.007b8bc016 (compile): 2023-04-04 12:57:11.810235 => 2023-04-04 12:57:11.817594
[0m12:57:11.818550 [debug] [Thread-2 (]: Began compiling node test.Product_Reviews_DWH.not_null_reviews_dim_staging_helpful.a1fef06d2e
[0m12:57:11.818550 [debug] [Thread-3 (]: Began executing node test.Product_Reviews_DWH.not_null_reviews_dim_staging_asin.007b8bc016
[0m12:57:11.821550 [debug] [Thread-2 (]: Writing injected SQL for node "test.Product_Reviews_DWH.not_null_reviews_dim_staging_helpful.a1fef06d2e"
[0m12:57:11.822170 [debug] [Thread-1 (]: Timing info for test.Product_Reviews_DWH.not_null_reviews_dim_staging_down_votes.2b0956cbec (compile): 2023-04-04 12:57:11.815496 => 2023-04-04 12:57:11.822170
[0m12:57:11.822170 [debug] [Thread-3 (]: Timing info for test.Product_Reviews_DWH.not_null_reviews_dim_staging_asin.007b8bc016 (execute): 2023-04-04 12:57:11.822170 => 2023-04-04 12:57:11.822170
[0m12:57:11.822170 [debug] [Thread-1 (]: Began executing node test.Product_Reviews_DWH.not_null_reviews_dim_staging_down_votes.2b0956cbec
[0m12:57:11.823171 [debug] [Thread-2 (]: Timing info for test.Product_Reviews_DWH.not_null_reviews_dim_staging_helpful.a1fef06d2e (compile): 2023-04-04 12:57:11.818550 => 2023-04-04 12:57:11.823171
[0m12:57:11.823171 [debug] [Thread-3 (]: Finished running node test.Product_Reviews_DWH.not_null_reviews_dim_staging_asin.007b8bc016
[0m12:57:11.823171 [debug] [Thread-1 (]: Timing info for test.Product_Reviews_DWH.not_null_reviews_dim_staging_down_votes.2b0956cbec (execute): 2023-04-04 12:57:11.823171 => 2023-04-04 12:57:11.823171
[0m12:57:11.824224 [debug] [Thread-2 (]: Began executing node test.Product_Reviews_DWH.not_null_reviews_dim_staging_helpful.a1fef06d2e
[0m12:57:11.824224 [debug] [Thread-3 (]: Began running node test.Product_Reviews_DWH.not_null_reviews_dim_staging_overall.ff70d6eacd
[0m12:57:11.825224 [debug] [Thread-1 (]: Finished running node test.Product_Reviews_DWH.not_null_reviews_dim_staging_down_votes.2b0956cbec
[0m12:57:11.825224 [debug] [Thread-2 (]: Timing info for test.Product_Reviews_DWH.not_null_reviews_dim_staging_helpful.a1fef06d2e (execute): 2023-04-04 12:57:11.825224 => 2023-04-04 12:57:11.825224
[0m12:57:11.825224 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.Product_Reviews_DWH.not_null_reviews_dim_staging_overall.ff70d6eacd'
[0m12:57:11.826221 [debug] [Thread-1 (]: Began running node test.Product_Reviews_DWH.not_null_reviews_dim_staging_process_flag.16551e137a
[0m12:57:11.826221 [debug] [Thread-2 (]: Finished running node test.Product_Reviews_DWH.not_null_reviews_dim_staging_helpful.a1fef06d2e
[0m12:57:11.827221 [debug] [Thread-3 (]: Began compiling node test.Product_Reviews_DWH.not_null_reviews_dim_staging_overall.ff70d6eacd
[0m12:57:11.827221 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.Product_Reviews_DWH.not_null_reviews_dim_staging_process_flag.16551e137a'
[0m12:57:11.827221 [debug] [Thread-2 (]: Began running node test.Product_Reviews_DWH.not_null_reviews_dim_staging_review_date.a3853cf5c0
[0m12:57:11.829334 [debug] [Thread-3 (]: Writing injected SQL for node "test.Product_Reviews_DWH.not_null_reviews_dim_staging_overall.ff70d6eacd"
[0m12:57:11.831192 [debug] [Thread-1 (]: Began compiling node test.Product_Reviews_DWH.not_null_reviews_dim_staging_process_flag.16551e137a
[0m12:57:11.831192 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.Product_Reviews_DWH.not_null_reviews_dim_staging_review_date.a3853cf5c0'
[0m12:57:11.834297 [debug] [Thread-1 (]: Writing injected SQL for node "test.Product_Reviews_DWH.not_null_reviews_dim_staging_process_flag.16551e137a"
[0m12:57:11.835431 [debug] [Thread-2 (]: Began compiling node test.Product_Reviews_DWH.not_null_reviews_dim_staging_review_date.a3853cf5c0
[0m12:57:11.835431 [debug] [Thread-3 (]: Timing info for test.Product_Reviews_DWH.not_null_reviews_dim_staging_overall.ff70d6eacd (compile): 2023-04-04 12:57:11.828335 => 2023-04-04 12:57:11.835431
[0m12:57:11.836431 [debug] [Thread-2 (]: Writing injected SQL for node "test.Product_Reviews_DWH.not_null_reviews_dim_staging_review_date.a3853cf5c0"
[0m12:57:11.838750 [debug] [Thread-3 (]: Began executing node test.Product_Reviews_DWH.not_null_reviews_dim_staging_overall.ff70d6eacd
[0m12:57:11.838750 [debug] [Thread-1 (]: Timing info for test.Product_Reviews_DWH.not_null_reviews_dim_staging_process_flag.16551e137a (compile): 2023-04-04 12:57:11.832298 => 2023-04-04 12:57:11.838750
[0m12:57:11.838750 [debug] [Thread-3 (]: Timing info for test.Product_Reviews_DWH.not_null_reviews_dim_staging_overall.ff70d6eacd (execute): 2023-04-04 12:57:11.838750 => 2023-04-04 12:57:11.838750
[0m12:57:11.839897 [debug] [Thread-1 (]: Began executing node test.Product_Reviews_DWH.not_null_reviews_dim_staging_process_flag.16551e137a
[0m12:57:11.839897 [debug] [Thread-2 (]: Timing info for test.Product_Reviews_DWH.not_null_reviews_dim_staging_review_date.a3853cf5c0 (compile): 2023-04-04 12:57:11.835431 => 2023-04-04 12:57:11.839897
[0m12:57:11.839897 [debug] [Thread-3 (]: Finished running node test.Product_Reviews_DWH.not_null_reviews_dim_staging_overall.ff70d6eacd
[0m12:57:11.841019 [debug] [Thread-1 (]: Timing info for test.Product_Reviews_DWH.not_null_reviews_dim_staging_process_flag.16551e137a (execute): 2023-04-04 12:57:11.840898 => 2023-04-04 12:57:11.841019
[0m12:57:11.841019 [debug] [Thread-2 (]: Began executing node test.Product_Reviews_DWH.not_null_reviews_dim_staging_review_date.a3853cf5c0
[0m12:57:11.841019 [debug] [Thread-3 (]: Began running node test.Product_Reviews_DWH.not_null_reviews_dim_staging_review_text.52df1953d9
[0m12:57:11.842022 [debug] [Thread-1 (]: Finished running node test.Product_Reviews_DWH.not_null_reviews_dim_staging_process_flag.16551e137a
[0m12:57:11.842608 [debug] [Thread-2 (]: Timing info for test.Product_Reviews_DWH.not_null_reviews_dim_staging_review_date.a3853cf5c0 (execute): 2023-04-04 12:57:11.842608 => 2023-04-04 12:57:11.842608
[0m12:57:11.842608 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.Product_Reviews_DWH.not_null_reviews_dim_staging_review_text.52df1953d9'
[0m12:57:11.842608 [debug] [Thread-1 (]: Began running node test.Product_Reviews_DWH.not_null_reviews_dim_staging_reviewer_name.53379bf877
[0m12:57:11.843666 [debug] [Thread-2 (]: Finished running node test.Product_Reviews_DWH.not_null_reviews_dim_staging_review_date.a3853cf5c0
[0m12:57:11.843666 [debug] [Thread-3 (]: Began compiling node test.Product_Reviews_DWH.not_null_reviews_dim_staging_review_text.52df1953d9
[0m12:57:11.844667 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.Product_Reviews_DWH.not_null_reviews_dim_staging_reviewer_name.53379bf877'
[0m12:57:11.845183 [debug] [Thread-2 (]: Began running node test.Product_Reviews_DWH.not_null_reviews_dim_staging_reviewerid.c28d5dd207
[0m12:57:11.846712 [debug] [Thread-3 (]: Writing injected SQL for node "test.Product_Reviews_DWH.not_null_reviews_dim_staging_review_text.52df1953d9"
[0m12:57:11.848697 [debug] [Thread-1 (]: Began compiling node test.Product_Reviews_DWH.not_null_reviews_dim_staging_reviewer_name.53379bf877
[0m12:57:11.848697 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.Product_Reviews_DWH.not_null_reviews_dim_staging_reviewerid.c28d5dd207'
[0m12:57:11.852514 [debug] [Thread-1 (]: Writing injected SQL for node "test.Product_Reviews_DWH.not_null_reviews_dim_staging_reviewer_name.53379bf877"
[0m12:57:11.853930 [debug] [Thread-2 (]: Began compiling node test.Product_Reviews_DWH.not_null_reviews_dim_staging_reviewerid.c28d5dd207
[0m12:57:11.853930 [debug] [Thread-3 (]: Timing info for test.Product_Reviews_DWH.not_null_reviews_dim_staging_review_text.52df1953d9 (compile): 2023-04-04 12:57:11.845711 => 2023-04-04 12:57:11.853930
[0m12:57:11.855929 [debug] [Thread-2 (]: Writing injected SQL for node "test.Product_Reviews_DWH.not_null_reviews_dim_staging_reviewerid.c28d5dd207"
[0m12:57:11.855929 [debug] [Thread-1 (]: Timing info for test.Product_Reviews_DWH.not_null_reviews_dim_staging_reviewer_name.53379bf877 (compile): 2023-04-04 12:57:11.849697 => 2023-04-04 12:57:11.855929
[0m12:57:11.857600 [debug] [Thread-3 (]: Began executing node test.Product_Reviews_DWH.not_null_reviews_dim_staging_review_text.52df1953d9
[0m12:57:11.857600 [debug] [Thread-1 (]: Began executing node test.Product_Reviews_DWH.not_null_reviews_dim_staging_reviewer_name.53379bf877
[0m12:57:11.857600 [debug] [Thread-2 (]: Timing info for test.Product_Reviews_DWH.not_null_reviews_dim_staging_reviewerid.c28d5dd207 (compile): 2023-04-04 12:57:11.853930 => 2023-04-04 12:57:11.857600
[0m12:57:11.858597 [debug] [Thread-3 (]: Timing info for test.Product_Reviews_DWH.not_null_reviews_dim_staging_review_text.52df1953d9 (execute): 2023-04-04 12:57:11.858597 => 2023-04-04 12:57:11.858597
[0m12:57:11.858597 [debug] [Thread-1 (]: Timing info for test.Product_Reviews_DWH.not_null_reviews_dim_staging_reviewer_name.53379bf877 (execute): 2023-04-04 12:57:11.858597 => 2023-04-04 12:57:11.858597
[0m12:57:11.858597 [debug] [Thread-2 (]: Began executing node test.Product_Reviews_DWH.not_null_reviews_dim_staging_reviewerid.c28d5dd207
[0m12:57:11.859593 [debug] [Thread-3 (]: Finished running node test.Product_Reviews_DWH.not_null_reviews_dim_staging_review_text.52df1953d9
[0m12:57:11.860595 [debug] [Thread-1 (]: Finished running node test.Product_Reviews_DWH.not_null_reviews_dim_staging_reviewer_name.53379bf877
[0m12:57:11.860595 [debug] [Thread-2 (]: Timing info for test.Product_Reviews_DWH.not_null_reviews_dim_staging_reviewerid.c28d5dd207 (execute): 2023-04-04 12:57:11.860595 => 2023-04-04 12:57:11.860595
[0m12:57:11.860595 [debug] [Thread-3 (]: Began running node test.Product_Reviews_DWH.not_null_reviews_dim_staging_row_number.8b640766fd
[0m12:57:11.861593 [debug] [Thread-1 (]: Began running node test.Product_Reviews_DWH.not_null_reviews_dim_staging_summary.5efe8705eb
[0m12:57:11.861593 [debug] [Thread-2 (]: Finished running node test.Product_Reviews_DWH.not_null_reviews_dim_staging_reviewerid.c28d5dd207
[0m12:57:11.862601 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.Product_Reviews_DWH.not_null_reviews_dim_staging_row_number.8b640766fd'
[0m12:57:11.862601 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.Product_Reviews_DWH.not_null_reviews_dim_staging_summary.5efe8705eb'
[0m12:57:11.863595 [debug] [Thread-2 (]: Began running node test.Product_Reviews_DWH.not_null_reviews_dim_staging_up_votes.0fc0fb66ec
[0m12:57:11.863595 [debug] [Thread-3 (]: Began compiling node test.Product_Reviews_DWH.not_null_reviews_dim_staging_row_number.8b640766fd
[0m12:57:11.863595 [debug] [Thread-1 (]: Began compiling node test.Product_Reviews_DWH.not_null_reviews_dim_staging_summary.5efe8705eb
[0m12:57:11.864593 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.Product_Reviews_DWH.not_null_reviews_dim_staging_up_votes.0fc0fb66ec'
[0m12:57:11.866592 [debug] [Thread-3 (]: Writing injected SQL for node "test.Product_Reviews_DWH.not_null_reviews_dim_staging_row_number.8b640766fd"
[0m12:57:11.869105 [debug] [Thread-1 (]: Writing injected SQL for node "test.Product_Reviews_DWH.not_null_reviews_dim_staging_summary.5efe8705eb"
[0m12:57:11.869105 [debug] [Thread-2 (]: Began compiling node test.Product_Reviews_DWH.not_null_reviews_dim_staging_up_votes.0fc0fb66ec
[0m12:57:11.873479 [debug] [Thread-2 (]: Writing injected SQL for node "test.Product_Reviews_DWH.not_null_reviews_dim_staging_up_votes.0fc0fb66ec"
[0m12:57:11.874974 [debug] [Thread-3 (]: Timing info for test.Product_Reviews_DWH.not_null_reviews_dim_staging_row_number.8b640766fd (compile): 2023-04-04 12:57:11.864593 => 2023-04-04 12:57:11.874974
[0m12:57:11.874974 [debug] [Thread-1 (]: Timing info for test.Product_Reviews_DWH.not_null_reviews_dim_staging_summary.5efe8705eb (compile): 2023-04-04 12:57:11.866592 => 2023-04-04 12:57:11.874974
[0m12:57:11.874974 [debug] [Thread-3 (]: Began executing node test.Product_Reviews_DWH.not_null_reviews_dim_staging_row_number.8b640766fd
[0m12:57:11.875973 [debug] [Thread-1 (]: Began executing node test.Product_Reviews_DWH.not_null_reviews_dim_staging_summary.5efe8705eb
[0m12:57:11.875973 [debug] [Thread-2 (]: Timing info for test.Product_Reviews_DWH.not_null_reviews_dim_staging_up_votes.0fc0fb66ec (compile): 2023-04-04 12:57:11.871479 => 2023-04-04 12:57:11.875973
[0m12:57:11.875973 [debug] [Thread-3 (]: Timing info for test.Product_Reviews_DWH.not_null_reviews_dim_staging_row_number.8b640766fd (execute): 2023-04-04 12:57:11.875973 => 2023-04-04 12:57:11.875973
[0m12:57:11.875973 [debug] [Thread-1 (]: Timing info for test.Product_Reviews_DWH.not_null_reviews_dim_staging_summary.5efe8705eb (execute): 2023-04-04 12:57:11.875973 => 2023-04-04 12:57:11.875973
[0m12:57:11.875973 [debug] [Thread-2 (]: Began executing node test.Product_Reviews_DWH.not_null_reviews_dim_staging_up_votes.0fc0fb66ec
[0m12:57:11.876972 [debug] [Thread-3 (]: Finished running node test.Product_Reviews_DWH.not_null_reviews_dim_staging_row_number.8b640766fd
[0m12:57:11.877974 [debug] [Thread-1 (]: Finished running node test.Product_Reviews_DWH.not_null_reviews_dim_staging_summary.5efe8705eb
[0m12:57:11.878263 [debug] [Thread-2 (]: Timing info for test.Product_Reviews_DWH.not_null_reviews_dim_staging_up_votes.0fc0fb66ec (execute): 2023-04-04 12:57:11.878263 => 2023-04-04 12:57:11.878263
[0m12:57:11.878263 [debug] [Thread-3 (]: Began running node test.Product_Reviews_DWH.not_null_product_reviews_fact_date.1d9dcf3986
[0m12:57:11.878263 [debug] [Thread-1 (]: Began running node test.Product_Reviews_DWH.not_null_product_reviews_fact_sk_category_dim.9352dab182
[0m12:57:11.879283 [debug] [Thread-2 (]: Finished running node test.Product_Reviews_DWH.not_null_reviews_dim_staging_up_votes.0fc0fb66ec
[0m12:57:11.879283 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.Product_Reviews_DWH.not_null_product_reviews_fact_date.1d9dcf3986'
[0m12:57:11.880323 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.Product_Reviews_DWH.not_null_product_reviews_fact_sk_category_dim.9352dab182'
[0m12:57:11.880323 [debug] [Thread-2 (]: Began running node test.Product_Reviews_DWH.not_null_product_reviews_fact_sk_price_bucket_dim.5c04f82b50
[0m12:57:11.881327 [debug] [Thread-3 (]: Began compiling node test.Product_Reviews_DWH.not_null_product_reviews_fact_date.1d9dcf3986
[0m12:57:11.881327 [debug] [Thread-1 (]: Began compiling node test.Product_Reviews_DWH.not_null_product_reviews_fact_sk_category_dim.9352dab182
[0m12:57:11.881327 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.Product_Reviews_DWH.not_null_product_reviews_fact_sk_price_bucket_dim.5c04f82b50'
[0m12:57:11.884324 [debug] [Thread-3 (]: Writing injected SQL for node "test.Product_Reviews_DWH.not_null_product_reviews_fact_date.1d9dcf3986"
[0m12:57:11.886166 [debug] [Thread-1 (]: Writing injected SQL for node "test.Product_Reviews_DWH.not_null_product_reviews_fact_sk_category_dim.9352dab182"
[0m12:57:11.886166 [debug] [Thread-2 (]: Began compiling node test.Product_Reviews_DWH.not_null_product_reviews_fact_sk_price_bucket_dim.5c04f82b50
[0m12:57:11.890752 [debug] [Thread-2 (]: Writing injected SQL for node "test.Product_Reviews_DWH.not_null_product_reviews_fact_sk_price_bucket_dim.5c04f82b50"
[0m12:57:11.893043 [debug] [Thread-1 (]: Timing info for test.Product_Reviews_DWH.not_null_product_reviews_fact_sk_category_dim.9352dab182 (compile): 2023-04-04 12:57:11.885168 => 2023-04-04 12:57:11.893043
[0m12:57:11.893043 [debug] [Thread-3 (]: Timing info for test.Product_Reviews_DWH.not_null_product_reviews_fact_date.1d9dcf3986 (compile): 2023-04-04 12:57:11.882327 => 2023-04-04 12:57:11.893043
[0m12:57:11.893043 [debug] [Thread-1 (]: Began executing node test.Product_Reviews_DWH.not_null_product_reviews_fact_sk_category_dim.9352dab182
[0m12:57:11.893043 [debug] [Thread-2 (]: Timing info for test.Product_Reviews_DWH.not_null_product_reviews_fact_sk_price_bucket_dim.5c04f82b50 (compile): 2023-04-04 12:57:11.888753 => 2023-04-04 12:57:11.893043
[0m12:57:11.894042 [debug] [Thread-3 (]: Began executing node test.Product_Reviews_DWH.not_null_product_reviews_fact_date.1d9dcf3986
[0m12:57:11.894042 [debug] [Thread-1 (]: Timing info for test.Product_Reviews_DWH.not_null_product_reviews_fact_sk_category_dim.9352dab182 (execute): 2023-04-04 12:57:11.894042 => 2023-04-04 12:57:11.894042
[0m12:57:11.894042 [debug] [Thread-2 (]: Began executing node test.Product_Reviews_DWH.not_null_product_reviews_fact_sk_price_bucket_dim.5c04f82b50
[0m12:57:11.895041 [debug] [Thread-3 (]: Timing info for test.Product_Reviews_DWH.not_null_product_reviews_fact_date.1d9dcf3986 (execute): 2023-04-04 12:57:11.895041 => 2023-04-04 12:57:11.895041
[0m12:57:11.895041 [debug] [Thread-1 (]: Finished running node test.Product_Reviews_DWH.not_null_product_reviews_fact_sk_category_dim.9352dab182
[0m12:57:11.896042 [debug] [Thread-2 (]: Timing info for test.Product_Reviews_DWH.not_null_product_reviews_fact_sk_price_bucket_dim.5c04f82b50 (execute): 2023-04-04 12:57:11.896042 => 2023-04-04 12:57:11.896042
[0m12:57:11.896042 [debug] [Thread-3 (]: Finished running node test.Product_Reviews_DWH.not_null_product_reviews_fact_date.1d9dcf3986
[0m12:57:11.896042 [debug] [Thread-1 (]: Began running node test.Product_Reviews_DWH.not_null_product_reviews_fact_sk_product_dim.de4cdf72ee
[0m12:57:11.897328 [debug] [Thread-2 (]: Finished running node test.Product_Reviews_DWH.not_null_product_reviews_fact_sk_price_bucket_dim.5c04f82b50
[0m12:57:11.897328 [debug] [Thread-3 (]: Began running node test.Product_Reviews_DWH.not_null_product_reviews_fact_sk_product_reviews_fact.073241d0af
[0m12:57:11.898335 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.Product_Reviews_DWH.not_null_product_reviews_fact_sk_product_dim.de4cdf72ee'
[0m12:57:11.898335 [debug] [Thread-2 (]: Began running node test.Product_Reviews_DWH.not_null_product_reviews_fact_sk_reviewer_dim.1ed46a4f67
[0m12:57:11.899330 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.Product_Reviews_DWH.not_null_product_reviews_fact_sk_product_reviews_fact.073241d0af'
[0m12:57:11.899330 [debug] [Thread-1 (]: Began compiling node test.Product_Reviews_DWH.not_null_product_reviews_fact_sk_product_dim.de4cdf72ee
[0m12:57:11.900329 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.Product_Reviews_DWH.not_null_product_reviews_fact_sk_reviewer_dim.1ed46a4f67'
[0m12:57:11.900329 [debug] [Thread-3 (]: Began compiling node test.Product_Reviews_DWH.not_null_product_reviews_fact_sk_product_reviews_fact.073241d0af
[0m12:57:11.902329 [debug] [Thread-1 (]: Writing injected SQL for node "test.Product_Reviews_DWH.not_null_product_reviews_fact_sk_product_dim.de4cdf72ee"
[0m12:57:11.903865 [debug] [Thread-2 (]: Began compiling node test.Product_Reviews_DWH.not_null_product_reviews_fact_sk_reviewer_dim.1ed46a4f67
[0m12:57:11.906900 [debug] [Thread-3 (]: Writing injected SQL for node "test.Product_Reviews_DWH.not_null_product_reviews_fact_sk_product_reviews_fact.073241d0af"
[0m12:57:11.909385 [debug] [Thread-2 (]: Writing injected SQL for node "test.Product_Reviews_DWH.not_null_product_reviews_fact_sk_reviewer_dim.1ed46a4f67"
[0m12:57:11.910306 [debug] [Thread-1 (]: Timing info for test.Product_Reviews_DWH.not_null_product_reviews_fact_sk_product_dim.de4cdf72ee (compile): 2023-04-04 12:57:11.900329 => 2023-04-04 12:57:11.910306
[0m12:57:11.910306 [debug] [Thread-1 (]: Began executing node test.Product_Reviews_DWH.not_null_product_reviews_fact_sk_product_dim.de4cdf72ee
[0m12:57:11.911307 [debug] [Thread-3 (]: Timing info for test.Product_Reviews_DWH.not_null_product_reviews_fact_sk_product_reviews_fact.073241d0af (compile): 2023-04-04 12:57:11.903865 => 2023-04-04 12:57:11.910306
[0m12:57:11.911307 [debug] [Thread-1 (]: Timing info for test.Product_Reviews_DWH.not_null_product_reviews_fact_sk_product_dim.de4cdf72ee (execute): 2023-04-04 12:57:11.911307 => 2023-04-04 12:57:11.911307
[0m12:57:11.911307 [debug] [Thread-2 (]: Timing info for test.Product_Reviews_DWH.not_null_product_reviews_fact_sk_reviewer_dim.1ed46a4f67 (compile): 2023-04-04 12:57:11.907385 => 2023-04-04 12:57:11.911307
[0m12:57:11.911307 [debug] [Thread-3 (]: Began executing node test.Product_Reviews_DWH.not_null_product_reviews_fact_sk_product_reviews_fact.073241d0af
[0m12:57:11.912307 [debug] [Thread-1 (]: Finished running node test.Product_Reviews_DWH.not_null_product_reviews_fact_sk_product_dim.de4cdf72ee
[0m12:57:11.912307 [debug] [Thread-2 (]: Began executing node test.Product_Reviews_DWH.not_null_product_reviews_fact_sk_reviewer_dim.1ed46a4f67
[0m12:57:11.912307 [debug] [Thread-3 (]: Timing info for test.Product_Reviews_DWH.not_null_product_reviews_fact_sk_product_reviews_fact.073241d0af (execute): 2023-04-04 12:57:11.912307 => 2023-04-04 12:57:11.912307
[0m12:57:11.912307 [debug] [Thread-1 (]: Began running node test.Product_Reviews_DWH.unique_product_reviews_fact_sk_product_reviews_fact.635114ac16
[0m12:57:11.913306 [debug] [Thread-2 (]: Timing info for test.Product_Reviews_DWH.not_null_product_reviews_fact_sk_reviewer_dim.1ed46a4f67 (execute): 2023-04-04 12:57:11.913306 => 2023-04-04 12:57:11.913306
[0m12:57:11.914306 [debug] [Thread-3 (]: Finished running node test.Product_Reviews_DWH.not_null_product_reviews_fact_sk_product_reviews_fact.073241d0af
[0m12:57:11.914564 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.Product_Reviews_DWH.unique_product_reviews_fact_sk_product_reviews_fact.635114ac16'
[0m12:57:11.914564 [debug] [Thread-2 (]: Finished running node test.Product_Reviews_DWH.not_null_product_reviews_fact_sk_reviewer_dim.1ed46a4f67
[0m12:57:11.915642 [debug] [Thread-1 (]: Began compiling node test.Product_Reviews_DWH.unique_product_reviews_fact_sk_product_reviews_fact.635114ac16
[0m12:57:11.917644 [debug] [Thread-1 (]: Writing injected SQL for node "test.Product_Reviews_DWH.unique_product_reviews_fact_sk_product_reviews_fact.635114ac16"
[0m12:57:11.917644 [debug] [Thread-1 (]: Timing info for test.Product_Reviews_DWH.unique_product_reviews_fact_sk_product_reviews_fact.635114ac16 (compile): 2023-04-04 12:57:11.915642 => 2023-04-04 12:57:11.917644
[0m12:57:11.919607 [debug] [Thread-1 (]: Began executing node test.Product_Reviews_DWH.unique_product_reviews_fact_sk_product_reviews_fact.635114ac16
[0m12:57:11.919607 [debug] [Thread-1 (]: Timing info for test.Product_Reviews_DWH.unique_product_reviews_fact_sk_product_reviews_fact.635114ac16 (execute): 2023-04-04 12:57:11.919607 => 2023-04-04 12:57:11.919607
[0m12:57:11.919607 [debug] [Thread-1 (]: Finished running node test.Product_Reviews_DWH.unique_product_reviews_fact_sk_product_reviews_fact.635114ac16
[0m12:57:11.920675 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:57:11.920675 [debug] [MainThread]: Connection 'list_postgres_justeattakeaway' was properly closed.
[0m12:57:11.921676 [debug] [MainThread]: Connection 'test.Product_Reviews_DWH.unique_product_reviews_fact_sk_product_reviews_fact.635114ac16' was properly closed.
[0m12:57:11.921676 [debug] [MainThread]: Connection 'test.Product_Reviews_DWH.not_null_product_reviews_fact_sk_reviewer_dim.1ed46a4f67' was properly closed.
[0m12:57:11.921676 [debug] [MainThread]: Connection 'test.Product_Reviews_DWH.not_null_product_reviews_fact_sk_product_reviews_fact.073241d0af' was properly closed.
[0m12:57:11.923676 [debug] [MainThread]: Command end result
[0m12:57:11.932373 [info ] [MainThread]: Done.
[0m12:57:11.932373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A171EA64D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A175C9B670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A171E7AF20>]}
[0m12:57:11.933372 [debug] [MainThread]: Flushing usage events


============================== 2023-04-04 12:57:16.606919 | 640c1000-1414-4d40-88cf-8c93ed050390 ==============================
[0m12:57:16.606919 [info ] [MainThread]: Running with dbt=1.4.5
[0m12:57:16.615326 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Furqan\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['fact'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:57:16.616159 [debug] [MainThread]: Tracking: tracking
[0m12:57:16.625528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022AAC0EFCA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022AAC0EE4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022AAC0EECE0>]}
[0m12:57:16.638647 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m12:57:16.711893 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:57:16.711893 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:57:16.717504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '640c1000-1414-4d40-88cf-8c93ed050390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022AA89C82E0>]}
[0m12:57:16.730489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '640c1000-1414-4d40-88cf-8c93ed050390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022AAC256EC0>]}
[0m12:57:16.731489 [info ] [MainThread]: Found 6 models, 45 tests, 1 snapshot, 0 analyses, 403 macros, 0 operations, 0 seed files, 10 sources, 0 exposures, 0 metrics
[0m12:57:16.731489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '640c1000-1414-4d40-88cf-8c93ed050390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022AAC256DD0>]}
[0m12:57:16.733493 [info ] [MainThread]: 
[0m12:57:16.735489 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:57:16.736489 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m12:57:16.744624 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m12:57:16.745491 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m12:57:16.745491 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:16.780490 [debug] [ThreadPool]: SQL status: SELECT 25 in 0 seconds
[0m12:57:16.782488 [debug] [ThreadPool]: On list_postgres: Close
[0m12:57:16.784490 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_justeattakeaway'
[0m12:57:16.788489 [debug] [ThreadPool]: Using postgres connection "list_postgres_justeattakeaway"
[0m12:57:16.789492 [debug] [ThreadPool]: On list_postgres_justeattakeaway: BEGIN
[0m12:57:16.789993 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:16.819714 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m12:57:16.819714 [debug] [ThreadPool]: Using postgres connection "list_postgres_justeattakeaway"
[0m12:57:16.820732 [debug] [ThreadPool]: On list_postgres_justeattakeaway: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "connection_name": "list_postgres_justeattakeaway"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'justeattakeaway'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'justeattakeaway'
  
[0m12:57:16.825496 [debug] [ThreadPool]: SQL status: SELECT 262 in 0 seconds
[0m12:57:16.828626 [debug] [ThreadPool]: On list_postgres_justeattakeaway: ROLLBACK
[0m12:57:16.830524 [debug] [ThreadPool]: On list_postgres_justeattakeaway: Close
[0m12:57:16.846093 [debug] [MainThread]: Using postgres connection "master"
[0m12:57:16.847093 [debug] [MainThread]: On master: BEGIN
[0m12:57:16.847093 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:57:16.877037 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m12:57:16.878034 [debug] [MainThread]: Using postgres connection "master"
[0m12:57:16.878034 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:57:16.880032 [debug] [MainThread]: SQL status: SELECT 7 in 0 seconds
[0m12:57:16.895546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '640c1000-1414-4d40-88cf-8c93ed050390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022AA8A03670>]}
[0m12:57:16.895546 [debug] [MainThread]: On master: ROLLBACK
[0m12:57:16.896487 [debug] [MainThread]: Using postgres connection "master"
[0m12:57:16.896487 [debug] [MainThread]: On master: BEGIN
[0m12:57:16.896487 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m12:57:16.897505 [debug] [MainThread]: On master: COMMIT
[0m12:57:16.897505 [debug] [MainThread]: Using postgres connection "master"
[0m12:57:16.897891 [debug] [MainThread]: On master: COMMIT
[0m12:57:16.897891 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m12:57:16.897891 [debug] [MainThread]: On master: Close
[0m12:57:16.899034 [info ] [MainThread]: Concurrency: 3 threads (target='prod')
[0m12:57:16.899733 [info ] [MainThread]: 
[0m12:57:16.904067 [debug] [Thread-1 (]: Began running node model.Product_Reviews_DWH.product_reviews_fact
[0m12:57:16.904877 [info ] [Thread-1 (]: 1 of 1 START sql incremental model justeattakeaway.product_reviews_fact ........ [RUN]
[0m12:57:16.905878 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Product_Reviews_DWH.product_reviews_fact'
[0m12:57:16.905878 [debug] [Thread-1 (]: Began compiling node model.Product_Reviews_DWH.product_reviews_fact
[0m12:57:16.918412 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.product_reviews_fact"
[0m12:57:16.918412 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "node_id": "model.Product_Reviews_DWH.product_reviews_fact"} */

        select coalesce(max(sk_product_reviews_fact),0) from  "postgres"."justeattakeaway"."product_reviews_fact"
    
[0m12:57:16.919857 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:57:16.951718 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0 seconds
[0m12:57:16.953721 [debug] [Thread-1 (]: Writing injected SQL for node "model.Product_Reviews_DWH.product_reviews_fact"
[0m12:57:16.954803 [debug] [Thread-1 (]: Timing info for model.Product_Reviews_DWH.product_reviews_fact (compile): 2023-04-04 12:57:16.906537 => 2023-04-04 12:57:16.954803
[0m12:57:16.954803 [debug] [Thread-1 (]: Began executing node model.Product_Reviews_DWH.product_reviews_fact
[0m12:57:16.989491 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.product_reviews_fact"
[0m12:57:16.989491 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "node_id": "model.Product_Reviews_DWH.product_reviews_fact"} */

    
  
    

  create temporary table "product_reviews_fact__dbt_tmp155716971717"
  as (
    

    

SELECT  
row_number() over()+0 as sk_product_reviews_fact,
'2000-01-01'::date as date,
coalesce(prd_dim.sk_product_dim,-1)::int4 as sk_product_dim,
coalesce(category.sk_category_dim,-1) as sk_category_dim,
coalesce(prd_bucket.sk_price_bucket_dim,-1) as sk_price_bucket_dim,
coalesce(reviewer_dim.sk_reviewer_dim,-1)::int4 as sk_reviewer_dim,
prd_dim_stg.price as product_price,
prd_dim_stg.sales_rank::int4 as sales_rank,
reviews_stag.overall::int4 as overall_rating,
reviews_stag.up_votes as review_likes,
reviews_stag.down_votes as review_dislikes,
prd_dim_stg.viewed_and_bought_count::int4 as viewed_and_bought_count
-- products dim table
FROM "postgres"."justeattakeaway"."product_dimension"  prd_dim
-- products staging table
JOIN "postgres"."justeattakeaway"."products_dim_staging"  prd_dim_stg 
ON prd_dim.asin = prd_dim_stg.asin
-- products category dim table
left join "postgres"."justeattakeaway"."product_category_dimension"  category
ON prd_dim_stg.category= category.category and prd_dim_stg.sub_category = category.sub_category 
-- price bucket dim table
LEFT JOIN "postgres"."justeattakeaway"."price_bucket_dimension"  prd_bucket
ON prd_dim_stg.price >= prd_bucket.bucket_lower_limit  and  prd_dim_stg.price<=prd_bucket.bucket_upper_limit
-- reviews staging table
LEFT JOIN "postgres"."justeattakeaway"."reviews_dim_staging"  as reviews_stag
ON prd_dim.asin = reviews_stag.asin and reviews_stag.review_date = '2000-01-01'
-- reviewer dim table
LEFT JOIN "postgres"."justeattakeaway"."reviewer_dimension"  reviewer_dim
ON reviews_stag.reviewerid =reviewer_dim.reviewerid and reviews_stag.review_date >=reviewer_dim.valid_from and reviews_stag.review_date <reviewer_dim.valid_to
  );
  
  
[0m12:57:16.999067 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "justeattakeaway.product_dimension" does not exist
LINE 27: FROM "postgres"."justeattakeaway"."product_dimension"  prd_d...
              ^

[0m12:57:17.000071 [debug] [Thread-1 (]: Timing info for model.Product_Reviews_DWH.product_reviews_fact (execute): 2023-04-04 12:57:16.955721 => 2023-04-04 12:57:17.000071
[0m12:57:17.000071 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: Close
[0m12:57:17.017716 [debug] [Thread-1 (]: Database Error in model product_reviews_fact (models\fact\product_reviews_fact.sql)
  relation "justeattakeaway.product_dimension" does not exist
  LINE 27: FROM "postgres"."justeattakeaway"."product_dimension"  prd_d...
                ^
[0m12:57:17.018714 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '640c1000-1414-4d40-88cf-8c93ed050390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022AA897EDD0>]}
[0m12:57:17.018714 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model justeattakeaway.product_reviews_fact  [[31mERROR[0m in 0.11s]
[0m12:57:17.020846 [debug] [Thread-1 (]: Finished running node model.Product_Reviews_DWH.product_reviews_fact
[0m12:57:17.022729 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:57:17.023727 [debug] [MainThread]: Using postgres connection "master"
[0m12:57:17.023969 [debug] [MainThread]: On master: BEGIN
[0m12:57:17.023969 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:57:17.054287 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m12:57:17.054287 [debug] [MainThread]: On master: COMMIT
[0m12:57:17.055150 [debug] [MainThread]: Using postgres connection "master"
[0m12:57:17.055150 [debug] [MainThread]: On master: COMMIT
[0m12:57:17.055986 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m12:57:17.056150 [debug] [MainThread]: On master: Close
[0m12:57:17.057150 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:57:17.057150 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m12:57:17.057150 [debug] [MainThread]: Connection 'list_postgres_justeattakeaway' was properly closed.
[0m12:57:17.057150 [debug] [MainThread]: Connection 'model.Product_Reviews_DWH.product_reviews_fact' was properly closed.
[0m12:57:17.058151 [info ] [MainThread]: 
[0m12:57:17.058151 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m12:57:17.059153 [debug] [MainThread]: Command end result
[0m12:57:17.068294 [info ] [MainThread]: 
[0m12:57:17.069356 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:57:17.069356 [info ] [MainThread]: 
[0m12:57:17.070295 [error] [MainThread]: [33mDatabase Error in model product_reviews_fact (models\fact\product_reviews_fact.sql)[0m
[0m12:57:17.070295 [error] [MainThread]:   relation "justeattakeaway.product_dimension" does not exist
[0m12:57:17.071296 [error] [MainThread]:   LINE 27: FROM "postgres"."justeattakeaway"."product_dimension"  prd_d...
[0m12:57:17.071296 [error] [MainThread]:                 ^
[0m12:57:17.072295 [info ] [MainThread]: 
[0m12:57:17.072295 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:57:17.073294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022AAC6F17E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022AAC6F1750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022AAC6F38B0>]}
[0m12:57:17.073294 [debug] [MainThread]: Flushing usage events


============================== 2023-04-04 12:58:09.005888 | 3d5e4162-8192-407a-8db7-9d2c27611988 ==============================
[0m12:58:09.005888 [info ] [MainThread]: Running with dbt=1.4.5
[0m12:58:09.005888 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Furqan\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['fact'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:58:09.014199 [debug] [MainThread]: Tracking: tracking
[0m12:58:09.024195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002464404FF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002464404E500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002464404ED10>]}
[0m12:58:09.036890 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m12:58:09.097288 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:58:09.097288 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:58:09.114770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d5e4162-8192-407a-8db7-9d2c27611988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024640928310>]}
[0m12:58:09.128326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d5e4162-8192-407a-8db7-9d2c27611988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246408EEEF0>]}
[0m12:58:09.129326 [info ] [MainThread]: Found 6 models, 45 tests, 1 snapshot, 0 analyses, 403 macros, 0 operations, 0 seed files, 10 sources, 0 exposures, 0 metrics
[0m12:58:09.129326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d5e4162-8192-407a-8db7-9d2c27611988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246408EEE00>]}
[0m12:58:09.131325 [info ] [MainThread]: 
[0m12:58:09.133328 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:58:09.134326 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m12:58:09.143569 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m12:58:09.143569 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m12:58:09.144325 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:58:09.178854 [debug] [ThreadPool]: SQL status: SELECT 25 in 0 seconds
[0m12:58:09.180853 [debug] [ThreadPool]: On list_postgres: Close
[0m12:58:09.181853 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_justeattakeaway'
[0m12:58:09.187855 [debug] [ThreadPool]: Using postgres connection "list_postgres_justeattakeaway"
[0m12:58:09.187855 [debug] [ThreadPool]: On list_postgres_justeattakeaway: BEGIN
[0m12:58:09.187855 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:58:09.217847 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m12:58:09.218845 [debug] [ThreadPool]: Using postgres connection "list_postgres_justeattakeaway"
[0m12:58:09.218845 [debug] [ThreadPool]: On list_postgres_justeattakeaway: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "connection_name": "list_postgres_justeattakeaway"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'justeattakeaway'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'justeattakeaway'
  
[0m12:58:09.223877 [debug] [ThreadPool]: SQL status: SELECT 262 in 0 seconds
[0m12:58:09.224893 [debug] [ThreadPool]: On list_postgres_justeattakeaway: ROLLBACK
[0m12:58:09.229062 [debug] [ThreadPool]: On list_postgres_justeattakeaway: Close
[0m12:58:09.245240 [debug] [MainThread]: Using postgres connection "master"
[0m12:58:09.245240 [debug] [MainThread]: On master: BEGIN
[0m12:58:09.245240 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:58:09.275741 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m12:58:09.275741 [debug] [MainThread]: Using postgres connection "master"
[0m12:58:09.277046 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:58:09.278046 [debug] [MainThread]: SQL status: SELECT 7 in 0 seconds
[0m12:58:09.293859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d5e4162-8192-407a-8db7-9d2c27611988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024640967430>]}
[0m12:58:09.294860 [debug] [MainThread]: On master: ROLLBACK
[0m12:58:09.295245 [debug] [MainThread]: Using postgres connection "master"
[0m12:58:09.295245 [debug] [MainThread]: On master: BEGIN
[0m12:58:09.295245 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m12:58:09.296246 [debug] [MainThread]: On master: COMMIT
[0m12:58:09.296246 [debug] [MainThread]: Using postgres connection "master"
[0m12:58:09.296246 [debug] [MainThread]: On master: COMMIT
[0m12:58:09.297246 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m12:58:09.297246 [debug] [MainThread]: On master: Close
[0m12:58:09.298246 [info ] [MainThread]: Concurrency: 3 threads (target='prod')
[0m12:58:09.298246 [info ] [MainThread]: 
[0m12:58:09.303249 [debug] [Thread-1 (]: Began running node model.Product_Reviews_DWH.product_reviews_fact
[0m12:58:09.303249 [info ] [Thread-1 (]: 1 of 1 START sql incremental model justeattakeaway.product_reviews_fact ........ [RUN]
[0m12:58:09.304246 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Product_Reviews_DWH.product_reviews_fact'
[0m12:58:09.305201 [debug] [Thread-1 (]: Began compiling node model.Product_Reviews_DWH.product_reviews_fact
[0m12:58:09.308246 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.product_reviews_fact"
[0m12:58:09.308246 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "node_id": "model.Product_Reviews_DWH.product_reviews_fact"} */

        select coalesce(max(sk_product_reviews_fact),0) from  "postgres"."justeattakeaway"."product_reviews_fact"
    
[0m12:58:09.308246 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:58:09.353306 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0 seconds
[0m12:58:09.355180 [debug] [Thread-1 (]: Writing injected SQL for node "model.Product_Reviews_DWH.product_reviews_fact"
[0m12:58:09.356178 [debug] [Thread-1 (]: Timing info for model.Product_Reviews_DWH.product_reviews_fact (compile): 2023-04-04 12:58:09.305201 => 2023-04-04 12:58:09.356178
[0m12:58:09.356178 [debug] [Thread-1 (]: Began executing node model.Product_Reviews_DWH.product_reviews_fact
[0m12:58:09.397057 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.product_reviews_fact"
[0m12:58:09.397057 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "node_id": "model.Product_Reviews_DWH.product_reviews_fact"} */

    
  
    

  create temporary table "product_reviews_fact__dbt_tmp155809379182"
  as (
    

    

SELECT  
row_number() over()+0 as sk_product_reviews_fact,
'2000-01-01'::date as date,
coalesce(prd_dim.sk_product_dim,-1)::int4 as sk_product_dim,
coalesce(category.sk_category_dim,-1) as sk_category_dim,
coalesce(prd_bucket.sk_price_bucket_dim,-1) as sk_price_bucket_dim,
coalesce(reviewer_dim.sk_reviewer_dim,-1)::int4 as sk_reviewer_dim,
prd_dim_stg.price as product_price,
prd_dim_stg.sales_rank::int4 as sales_rank,
reviews_stag.overall::int4 as overall_rating,
reviews_stag.up_votes as review_likes,
reviews_stag.down_votes as review_dislikes,
prd_dim_stg.viewed_and_bought_count::int4 as viewed_and_bought_count
-- products dim table
FROM "postgres"."justeattakeaway"."product_dimension"  prd_dim
-- products staging table
JOIN "postgres"."justeattakeaway"."products_dim_staging"  prd_dim_stg 
ON prd_dim.asin = prd_dim_stg.asin
-- products category dim table
left join "postgres"."justeattakeaway"."product_category_dimension"  category
ON prd_dim_stg.category= category.category and prd_dim_stg.sub_category = category.sub_category 
-- price bucket dim table
LEFT JOIN "postgres"."justeattakeaway"."price_bucket_dimension"  prd_bucket
ON prd_dim_stg.price >= prd_bucket.bucket_lower_limit  and  prd_dim_stg.price<=prd_bucket.bucket_upper_limit
-- reviews staging table
LEFT JOIN "postgres"."justeattakeaway"."reviews_dim_staging"  as reviews_stag
ON prd_dim.asin = reviews_stag.asin and reviews_stag.review_date = '2000-01-01'
-- reviewer dim table
LEFT JOIN "postgres"."justeattakeaway"."reviewer_dimension"  reviewer_dim
ON reviews_stag.reviewerid =reviewer_dim.reviewerid and reviews_stag.review_date >=reviewer_dim.valid_from and reviews_stag.review_date <reviewer_dim.valid_to
  );
  
  
[0m12:59:19.321599 [debug] [Thread-1 (]: SQL status: SELECT 9430276 in 70 seconds
[0m12:59:19.328597 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.product_reviews_fact"
[0m12:59:19.328597 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: BEGIN
[0m12:59:19.330628 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m12:59:19.330628 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.product_reviews_fact"
[0m12:59:19.330628 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "node_id": "model.Product_Reviews_DWH.product_reviews_fact"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'product_reviews_fact__dbt_tmp155809379182'
        
      order by ordinal_position

  
[0m12:59:19.347628 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0 seconds
[0m12:59:19.353628 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.product_reviews_fact"
[0m12:59:19.354868 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "node_id": "model.Product_Reviews_DWH.product_reviews_fact"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'product_reviews_fact'
        
        and table_schema = 'justeattakeaway'
        
      order by ordinal_position

  
[0m12:59:19.358627 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0 seconds
[0m12:59:19.370450 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.product_reviews_fact"
[0m12:59:19.371449 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "node_id": "model.Product_Reviews_DWH.product_reviews_fact"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'product_reviews_fact__dbt_tmp155809379182'
        
      order by ordinal_position

  
[0m12:59:19.373920 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0 seconds
[0m12:59:19.378001 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.product_reviews_fact"
[0m12:59:19.378001 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "node_id": "model.Product_Reviews_DWH.product_reviews_fact"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'product_reviews_fact'
        
        and table_schema = 'justeattakeaway'
        
      order by ordinal_position

  
[0m12:59:19.382922 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0 seconds
[0m12:59:19.395927 [debug] [Thread-1 (]: 
    In "postgres"."justeattakeaway"."product_reviews_fact":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m12:59:19.413926 [debug] [Thread-1 (]: Writing runtime sql for node "model.Product_Reviews_DWH.product_reviews_fact"
[0m12:59:19.415925 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.product_reviews_fact"
[0m12:59:19.416926 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "node_id": "model.Product_Reviews_DWH.product_reviews_fact"} */

      
        
            delete from "postgres"."justeattakeaway"."product_reviews_fact"
            where (
                sk_product_reviews_fact) in (
                select (sk_product_reviews_fact)
                from "product_reviews_fact__dbt_tmp155809379182"
            );

        
    

    insert into "postgres"."justeattakeaway"."product_reviews_fact" ("sk_product_reviews_fact", "date", "sk_product_dim", "sk_category_dim", "sk_price_bucket_dim", "sk_reviewer_dim", "product_price", "sales_rank", "overall_rating", "review_likes", "review_dislikes", "viewed_and_bought_count")
    (
        select "sk_product_reviews_fact", "date", "sk_product_dim", "sk_category_dim", "sk_price_bucket_dim", "sk_reviewer_dim", "product_price", "sales_rank", "overall_rating", "review_likes", "review_dislikes", "viewed_and_bought_count"
        from "product_reviews_fact__dbt_tmp155809379182"
    )
  
[0m12:59:19.505922 [debug] [Thread-1 (]: Postgres adapter: Postgres error: no partition of relation "product_reviews_fact" found for row
DETAIL:  Partition key of the failing row contains (date) = (2000-01-01).

[0m12:59:19.507238 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: ROLLBACK
[0m12:59:19.507922 [debug] [Thread-1 (]: Timing info for model.Product_Reviews_DWH.product_reviews_fact (execute): 2023-04-04 12:58:09.357178 => 2023-04-04 12:59:19.507922
[0m12:59:19.508921 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: Close
[0m12:59:19.541922 [debug] [Thread-1 (]: Database Error in model product_reviews_fact (models\fact\product_reviews_fact.sql)
  no partition of relation "product_reviews_fact" found for row
  DETAIL:  Partition key of the failing row contains (date) = (2000-01-01).
  compiled Code at target\run\Product_Reviews_DWH\models\fact\product_reviews_fact.sql
[0m12:59:19.542922 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d5e4162-8192-407a-8db7-9d2c27611988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002464463D150>]}
[0m12:59:19.543922 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model justeattakeaway.product_reviews_fact  [[31mERROR[0m in 70.24s]
[0m12:59:19.546926 [debug] [Thread-1 (]: Finished running node model.Product_Reviews_DWH.product_reviews_fact
[0m12:59:19.549922 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:59:19.549922 [debug] [MainThread]: Using postgres connection "master"
[0m12:59:19.550923 [debug] [MainThread]: On master: BEGIN
[0m12:59:19.550923 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:59:19.606923 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m12:59:19.607923 [debug] [MainThread]: On master: COMMIT
[0m12:59:19.608922 [debug] [MainThread]: Using postgres connection "master"
[0m12:59:19.608922 [debug] [MainThread]: On master: COMMIT
[0m12:59:19.609922 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m12:59:19.610922 [debug] [MainThread]: On master: Close
[0m12:59:19.611925 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:59:19.612922 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m12:59:19.612922 [debug] [MainThread]: Connection 'list_postgres_justeattakeaway' was properly closed.
[0m12:59:19.613922 [debug] [MainThread]: Connection 'model.Product_Reviews_DWH.product_reviews_fact' was properly closed.
[0m12:59:19.614996 [info ] [MainThread]: 
[0m12:59:19.615927 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 1 minutes and 10.48 seconds (70.48s).
[0m12:59:19.616921 [debug] [MainThread]: Command end result
[0m12:59:19.758212 [info ] [MainThread]: 
[0m12:59:19.759212 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:59:19.760429 [info ] [MainThread]: 
[0m12:59:19.761212 [error] [MainThread]: [33mDatabase Error in model product_reviews_fact (models\fact\product_reviews_fact.sql)[0m
[0m12:59:19.762214 [error] [MainThread]:   no partition of relation "product_reviews_fact" found for row
[0m12:59:19.763215 [error] [MainThread]:   DETAIL:  Partition key of the failing row contains (date) = (2000-01-01).
[0m12:59:19.764213 [error] [MainThread]:   compiled Code at target\run\Product_Reviews_DWH\models\fact\product_reviews_fact.sql
[0m12:59:19.764213 [info ] [MainThread]: 
[0m12:59:19.765213 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:59:19.766212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246416324A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246440FA740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246440FB1C0>]}
[0m12:59:19.766981 [debug] [MainThread]: Flushing usage events


============================== 2023-04-04 13:03:01.366832 | a8380a6d-0fa5-4729-9681-5f8411b43a7d ==============================
[0m13:03:01.366832 [info ] [MainThread]: Running with dbt=1.4.5
[0m13:03:01.369118 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Furqan\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['fact'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:03:01.369118 [debug] [MainThread]: Tracking: tracking
[0m13:03:01.381087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A6ED0FF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A6ED0E500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A6ED0ED10>]}
[0m13:03:01.394086 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m13:03:01.479515 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:03:01.479515 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:03:01.490161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a8380a6d-0fa5-4729-9681-5f8411b43a7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A6B5E8310>]}
[0m13:03:01.504538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a8380a6d-0fa5-4729-9681-5f8411b43a7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A6B5AEEF0>]}
[0m13:03:01.505539 [info ] [MainThread]: Found 6 models, 45 tests, 1 snapshot, 0 analyses, 403 macros, 0 operations, 0 seed files, 10 sources, 0 exposures, 0 metrics
[0m13:03:01.505539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8380a6d-0fa5-4729-9681-5f8411b43a7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A6B5AEE00>]}
[0m13:03:01.507583 [info ] [MainThread]: 
[0m13:03:01.509140 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:03:01.511139 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m13:03:01.520278 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m13:03:01.521141 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:03:01.521141 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:03:01.562239 [debug] [ThreadPool]: SQL status: SELECT 25 in 0 seconds
[0m13:03:01.563335 [debug] [ThreadPool]: On list_postgres: Close
[0m13:03:01.565237 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_justeattakeaway'
[0m13:03:01.570236 [debug] [ThreadPool]: Using postgres connection "list_postgres_justeattakeaway"
[0m13:03:01.570236 [debug] [ThreadPool]: On list_postgres_justeattakeaway: BEGIN
[0m13:03:01.570905 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:03:01.600920 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m13:03:01.600920 [debug] [ThreadPool]: Using postgres connection "list_postgres_justeattakeaway"
[0m13:03:01.601935 [debug] [ThreadPool]: On list_postgres_justeattakeaway: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "connection_name": "list_postgres_justeattakeaway"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'justeattakeaway'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'justeattakeaway'
  
[0m13:03:01.607683 [debug] [ThreadPool]: SQL status: SELECT 490 in 0 seconds
[0m13:03:01.607683 [debug] [ThreadPool]: On list_postgres_justeattakeaway: ROLLBACK
[0m13:03:01.615083 [debug] [ThreadPool]: On list_postgres_justeattakeaway: Close
[0m13:03:01.639802 [debug] [MainThread]: Using postgres connection "master"
[0m13:03:01.639802 [debug] [MainThread]: On master: BEGIN
[0m13:03:01.639802 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:03:01.770921 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:03:01.770921 [debug] [MainThread]: Using postgres connection "master"
[0m13:03:01.771922 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:03:01.791902 [debug] [MainThread]: SQL status: SELECT 7 in 0 seconds
[0m13:03:01.791902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8380a6d-0fa5-4729-9681-5f8411b43a7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A6B627520>]}
[0m13:03:01.791902 [debug] [MainThread]: On master: ROLLBACK
[0m13:03:01.798657 [debug] [MainThread]: Using postgres connection "master"
[0m13:03:01.798657 [debug] [MainThread]: On master: BEGIN
[0m13:03:01.798657 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:03:01.799674 [debug] [MainThread]: On master: COMMIT
[0m13:03:01.799674 [debug] [MainThread]: Using postgres connection "master"
[0m13:03:01.799674 [debug] [MainThread]: On master: COMMIT
[0m13:03:01.799674 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m13:03:01.800729 [debug] [MainThread]: On master: Close
[0m13:03:01.801021 [info ] [MainThread]: Concurrency: 3 threads (target='prod')
[0m13:03:01.801021 [info ] [MainThread]: 
[0m13:03:01.808045 [debug] [Thread-1 (]: Began running node model.Product_Reviews_DWH.product_reviews_fact
[0m13:03:01.808045 [info ] [Thread-1 (]: 1 of 1 START sql incremental model justeattakeaway.product_reviews_fact ........ [RUN]
[0m13:03:01.809044 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Product_Reviews_DWH.product_reviews_fact'
[0m13:03:01.809745 [debug] [Thread-1 (]: Began compiling node model.Product_Reviews_DWH.product_reviews_fact
[0m13:03:01.812181 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.product_reviews_fact"
[0m13:03:01.812181 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "node_id": "model.Product_Reviews_DWH.product_reviews_fact"} */

        select coalesce(max(sk_product_reviews_fact),0) from  "postgres"."justeattakeaway"."product_reviews_fact"
    
[0m13:03:01.812181 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:03:02.139260 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0 seconds
[0m13:03:02.140258 [debug] [Thread-1 (]: Writing injected SQL for node "model.Product_Reviews_DWH.product_reviews_fact"
[0m13:03:02.140258 [debug] [Thread-1 (]: Timing info for model.Product_Reviews_DWH.product_reviews_fact (compile): 2023-04-04 13:03:01.810044 => 2023-04-04 13:03:02.140258
[0m13:03:02.142264 [debug] [Thread-1 (]: Began executing node model.Product_Reviews_DWH.product_reviews_fact
[0m13:03:02.176304 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.product_reviews_fact"
[0m13:03:02.176304 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "node_id": "model.Product_Reviews_DWH.product_reviews_fact"} */

    
  
    

  create temporary table "product_reviews_fact__dbt_tmp160302161246"
  as (
    

    

SELECT  
row_number() over()+0 as sk_product_reviews_fact,
'2000-01-01'::date as date,
coalesce(prd_dim.sk_product_dim,-1)::int4 as sk_product_dim,
coalesce(category.sk_category_dim,-1) as sk_category_dim,
coalesce(prd_bucket.sk_price_bucket_dim,-1) as sk_price_bucket_dim,
coalesce(reviewer_dim.sk_reviewer_dim,-1)::int4 as sk_reviewer_dim,
prd_dim_stg.price as product_price,
prd_dim_stg.sales_rank::int4 as sales_rank,
reviews_stag.overall::int4 as overall_rating,
reviews_stag.up_votes as review_likes,
reviews_stag.down_votes as review_dislikes,
prd_dim_stg.viewed_and_bought_count::int4 as viewed_and_bought_count
-- products dim table
FROM "postgres"."justeattakeaway"."product_dimension"  prd_dim
-- products staging table
JOIN "postgres"."justeattakeaway"."products_dim_staging"  prd_dim_stg 
ON prd_dim.asin = prd_dim_stg.asin
-- products category dim table
left join "postgres"."justeattakeaway"."product_category_dimension"  category
ON prd_dim_stg.category= category.category and prd_dim_stg.sub_category = category.sub_category 
-- price bucket dim table
LEFT JOIN "postgres"."justeattakeaway"."price_bucket_dimension"  prd_bucket
ON prd_dim_stg.price >= prd_bucket.bucket_lower_limit  and  prd_dim_stg.price<=prd_bucket.bucket_upper_limit
-- reviews staging table
LEFT JOIN "postgres"."justeattakeaway"."reviews_dim_staging"  as reviews_stag
ON prd_dim.asin = reviews_stag.asin and reviews_stag.review_date = '2000-01-01'
-- reviewer dim table
LEFT JOIN "postgres"."justeattakeaway"."reviewer_dimension"  reviewer_dim
ON reviews_stag.reviewerid =reviewer_dim.reviewerid and reviews_stag.review_date >=reviewer_dim.valid_from and reviews_stag.review_date <reviewer_dim.valid_to
  );
  
  
[0m13:04:13.579452 [debug] [Thread-1 (]: SQL status: SELECT 9430276 in 71 seconds
[0m13:04:13.580470 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.product_reviews_fact"
[0m13:04:13.580470 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: BEGIN
[0m13:04:13.590662 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m13:04:13.590662 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.product_reviews_fact"
[0m13:04:13.590662 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "node_id": "model.Product_Reviews_DWH.product_reviews_fact"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'product_reviews_fact__dbt_tmp160302161246'
        
      order by ordinal_position

  
[0m13:04:13.599033 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0 seconds
[0m13:04:13.600320 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.product_reviews_fact"
[0m13:04:13.600320 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "node_id": "model.Product_Reviews_DWH.product_reviews_fact"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'product_reviews_fact'
        
        and table_schema = 'justeattakeaway'
        
      order by ordinal_position

  
[0m13:04:13.606589 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0 seconds
[0m13:04:13.608551 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.product_reviews_fact"
[0m13:04:13.608551 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "node_id": "model.Product_Reviews_DWH.product_reviews_fact"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'product_reviews_fact__dbt_tmp160302161246'
        
      order by ordinal_position

  
[0m13:04:13.619280 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0 seconds
[0m13:04:13.671775 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.product_reviews_fact"
[0m13:04:13.671775 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "node_id": "model.Product_Reviews_DWH.product_reviews_fact"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'product_reviews_fact'
        
        and table_schema = 'justeattakeaway'
        
      order by ordinal_position

  
[0m13:04:13.675493 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0 seconds
[0m13:04:13.677808 [debug] [Thread-1 (]: 
    In "postgres"."justeattakeaway"."product_reviews_fact":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m13:04:13.695667 [debug] [Thread-1 (]: Writing runtime sql for node "model.Product_Reviews_DWH.product_reviews_fact"
[0m13:04:13.695667 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.product_reviews_fact"
[0m13:04:13.697327 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "node_id": "model.Product_Reviews_DWH.product_reviews_fact"} */

      
        
            delete from "postgres"."justeattakeaway"."product_reviews_fact"
            where (
                sk_product_reviews_fact) in (
                select (sk_product_reviews_fact)
                from "product_reviews_fact__dbt_tmp160302161246"
            );

        
    

    insert into "postgres"."justeattakeaway"."product_reviews_fact" ("sk_product_reviews_fact", "date", "sk_product_dim", "sk_category_dim", "sk_price_bucket_dim", "sk_reviewer_dim", "product_price", "sales_rank", "overall_rating", "review_likes", "review_dislikes", "viewed_and_bought_count")
    (
        select "sk_product_reviews_fact", "date", "sk_product_dim", "sk_category_dim", "sk_price_bucket_dim", "sk_reviewer_dim", "product_price", "sales_rank", "overall_rating", "review_likes", "review_dislikes", "viewed_and_bought_count"
        from "product_reviews_fact__dbt_tmp160302161246"
    )
  
[0m13:07:40.971273 [debug] [Thread-1 (]: Postgres adapter: Postgres error: insert or update on table "product_reviews_fact_2000_01" violates foreign key constraint "sk_reviewer_fk"
DETAIL:  Key (sk_reviewer_dim)=(-1) is not present in table "reviewer_dimension".

[0m13:07:40.971273 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: ROLLBACK
[0m13:07:40.972936 [debug] [Thread-1 (]: Timing info for model.Product_Reviews_DWH.product_reviews_fact (execute): 2023-04-04 13:03:02.142264 => 2023-04-04 13:07:40.972936
[0m13:07:40.973990 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.product_reviews_fact: Close
[0m13:07:41.001842 [debug] [Thread-1 (]: Database Error in model product_reviews_fact (models\fact\product_reviews_fact.sql)
  insert or update on table "product_reviews_fact_2000_01" violates foreign key constraint "sk_reviewer_fk"
  DETAIL:  Key (sk_reviewer_dim)=(-1) is not present in table "reviewer_dimension".
  compiled Code at target\run\Product_Reviews_DWH\models\fact\product_reviews_fact.sql
[0m13:07:41.002841 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8380a6d-0fa5-4729-9681-5f8411b43a7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A6F3BE530>]}
[0m13:07:41.003840 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model justeattakeaway.product_reviews_fact  [[31mERROR[0m in 279.19s]
[0m13:07:41.006047 [debug] [Thread-1 (]: Finished running node model.Product_Reviews_DWH.product_reviews_fact
[0m13:07:41.008846 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:07:41.009845 [debug] [MainThread]: Using postgres connection "master"
[0m13:07:41.010847 [debug] [MainThread]: On master: BEGIN
[0m13:07:41.011846 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:07:41.169962 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:07:41.169962 [debug] [MainThread]: On master: COMMIT
[0m13:07:41.170962 [debug] [MainThread]: Using postgres connection "master"
[0m13:07:41.170962 [debug] [MainThread]: On master: COMMIT
[0m13:07:41.172223 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m13:07:41.172223 [debug] [MainThread]: On master: Close
[0m13:07:41.173223 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:07:41.173223 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m13:07:41.173223 [debug] [MainThread]: Connection 'list_postgres_justeattakeaway' was properly closed.
[0m13:07:41.174222 [debug] [MainThread]: Connection 'model.Product_Reviews_DWH.product_reviews_fact' was properly closed.
[0m13:07:41.174222 [info ] [MainThread]: 
[0m13:07:41.174621 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 4 minutes and 39.67 seconds (279.67s).
[0m13:07:41.175224 [debug] [MainThread]: Command end result
[0m13:07:41.186225 [info ] [MainThread]: 
[0m13:07:41.187224 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:07:41.188229 [info ] [MainThread]: 
[0m13:07:41.189226 [error] [MainThread]: [33mDatabase Error in model product_reviews_fact (models\fact\product_reviews_fact.sql)[0m
[0m13:07:41.190226 [error] [MainThread]:   insert or update on table "product_reviews_fact_2000_01" violates foreign key constraint "sk_reviewer_fk"
[0m13:07:41.190226 [error] [MainThread]:   DETAIL:  Key (sk_reviewer_dim)=(-1) is not present in table "reviewer_dimension".
[0m13:07:41.191297 [error] [MainThread]:   compiled Code at target\run\Product_Reviews_DWH\models\fact\product_reviews_fact.sql
[0m13:07:41.191297 [info ] [MainThread]: 
[0m13:07:41.192224 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:07:41.192224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A6F3BE410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A6F3BE530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A6F3BE560>]}
[0m13:07:41.193225 [debug] [MainThread]: Flushing usage events


============================== 2023-04-04 14:05:59.065758 | 38f37d50-3eb0-492e-a1c6-ac5751bb772c ==============================
[0m14:05:59.065758 [info ] [MainThread]: Running with dbt=1.4.5
[0m14:05:59.067647 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Furqan\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['calendar_dimension'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:05:59.068334 [debug] [MainThread]: Tracking: tracking
[0m14:05:59.078332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C8864EA70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C8864FDC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C8864D480>]}
[0m14:05:59.090331 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m14:05:59.188462 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:05:59.188462 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:05:59.195331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '38f37d50-3eb0-492e-a1c6-ac5751bb772c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C84F28490>]}
[0m14:05:59.206547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '38f37d50-3eb0-492e-a1c6-ac5751bb772c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C84EEF070>]}
[0m14:05:59.207331 [info ] [MainThread]: Found 6 models, 45 tests, 1 snapshot, 0 analyses, 403 macros, 0 operations, 0 seed files, 10 sources, 0 exposures, 0 metrics
[0m14:05:59.207331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38f37d50-3eb0-492e-a1c6-ac5751bb772c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C84EEEF80>]}
[0m14:05:59.208331 [info ] [MainThread]: 
[0m14:05:59.210331 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:05:59.211331 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m14:05:59.219331 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m14:05:59.219331 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m14:05:59.219331 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:59.259433 [debug] [ThreadPool]: SQL status: SELECT 25 in 0 seconds
[0m14:05:59.261321 [debug] [ThreadPool]: On list_postgres: Close
[0m14:05:59.263322 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_justeattakeaway'
[0m14:05:59.267321 [debug] [ThreadPool]: Using postgres connection "list_postgres_justeattakeaway"
[0m14:05:59.267321 [debug] [ThreadPool]: On list_postgres_justeattakeaway: BEGIN
[0m14:05:59.268416 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:59.404050 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m14:05:59.404740 [debug] [ThreadPool]: Using postgres connection "list_postgres_justeattakeaway"
[0m14:05:59.405055 [debug] [ThreadPool]: On list_postgres_justeattakeaway: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "connection_name": "list_postgres_justeattakeaway"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'justeattakeaway'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'justeattakeaway'
  
[0m14:05:59.414067 [debug] [ThreadPool]: SQL status: SELECT 496 in 0 seconds
[0m14:05:59.421067 [debug] [ThreadPool]: On list_postgres_justeattakeaway: ROLLBACK
[0m14:05:59.421642 [debug] [ThreadPool]: On list_postgres_justeattakeaway: Close
[0m14:05:59.447089 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:59.447089 [debug] [MainThread]: On master: BEGIN
[0m14:05:59.448279 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:59.477283 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:05:59.477283 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:59.478276 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:05:59.510212 [debug] [MainThread]: SQL status: SELECT 9 in 0 seconds
[0m14:05:59.512213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38f37d50-3eb0-492e-a1c6-ac5751bb772c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C84F676A0>]}
[0m14:05:59.512213 [debug] [MainThread]: On master: ROLLBACK
[0m14:05:59.512213 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:59.513213 [debug] [MainThread]: On master: BEGIN
[0m14:05:59.513213 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:05:59.513213 [debug] [MainThread]: On master: COMMIT
[0m14:05:59.514212 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:59.514212 [debug] [MainThread]: On master: COMMIT
[0m14:05:59.514212 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:05:59.514212 [debug] [MainThread]: On master: Close
[0m14:05:59.515213 [info ] [MainThread]: Concurrency: 3 threads (target='prod')
[0m14:05:59.515213 [info ] [MainThread]: 
[0m14:05:59.525211 [debug] [Thread-1 (]: Began running node model.Product_Reviews_DWH.calendar_dimension
[0m14:05:59.526211 [info ] [Thread-1 (]: 1 of 1 START sql incremental model justeattakeaway.calendar_dimension .......... [RUN]
[0m14:05:59.526211 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Product_Reviews_DWH.calendar_dimension'
[0m14:05:59.527212 [debug] [Thread-1 (]: Began compiling node model.Product_Reviews_DWH.calendar_dimension
[0m14:05:59.535213 [debug] [Thread-1 (]: Writing injected SQL for node "model.Product_Reviews_DWH.calendar_dimension"
[0m14:05:59.536212 [debug] [Thread-1 (]: Timing info for model.Product_Reviews_DWH.calendar_dimension (compile): 2023-04-04 14:05:59.527212 => 2023-04-04 14:05:59.536212
[0m14:05:59.536212 [debug] [Thread-1 (]: Began executing node model.Product_Reviews_DWH.calendar_dimension
[0m14:05:59.581212 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.calendar_dimension"
[0m14:05:59.582213 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.calendar_dimension: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "node_id": "model.Product_Reviews_DWH.calendar_dimension"} */

    
  
    

  create temporary table "calendar_dimension__dbt_tmp170559559212"
  as (
    
WITH calendar_dimension AS (
    SELECT generate_series('1994-01-01'::date, current_date, '1 day'::interval)::date AS "date"
)
SELECT 
    "date",
    extract('year' from "date") AS year,
    extract('quarter' from "date") AS quarter,
    extract('month' from "date") AS month
FROM calendar_dimension

where "date" > coalesce((select max("date") from "postgres"."justeattakeaway"."calendar_dimension"),'1994-01-01')

ORDER BY "date"
  );
  
  
[0m14:05:59.582213 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:59.620212 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0 seconds
[0m14:05:59.626213 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.calendar_dimension"
[0m14:05:59.626213 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.calendar_dimension: BEGIN
[0m14:05:59.627014 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:05:59.627520 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.calendar_dimension"
[0m14:05:59.627520 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.calendar_dimension: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "node_id": "model.Product_Reviews_DWH.calendar_dimension"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'calendar_dimension__dbt_tmp170559559212'
        
      order by ordinal_position

  
[0m14:05:59.644787 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0 seconds
[0m14:05:59.649367 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.calendar_dimension"
[0m14:05:59.649367 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.calendar_dimension: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "node_id": "model.Product_Reviews_DWH.calendar_dimension"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'calendar_dimension'
        
        and table_schema = 'justeattakeaway'
        
      order by ordinal_position

  
[0m14:05:59.653672 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0 seconds
[0m14:05:59.663770 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.calendar_dimension"
[0m14:05:59.664672 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.calendar_dimension: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "node_id": "model.Product_Reviews_DWH.calendar_dimension"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'calendar_dimension__dbt_tmp170559559212'
        
      order by ordinal_position

  
[0m14:05:59.667670 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0 seconds
[0m14:05:59.721672 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.calendar_dimension"
[0m14:05:59.721672 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.calendar_dimension: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "node_id": "model.Product_Reviews_DWH.calendar_dimension"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'calendar_dimension'
        
        and table_schema = 'justeattakeaway'
        
      order by ordinal_position

  
[0m14:05:59.725857 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0 seconds
[0m14:05:59.732671 [debug] [Thread-1 (]: 
    In "postgres"."justeattakeaway"."calendar_dimension":
        Schema changed: True
        Source columns not in target: []
        Target columns not in source: []
        New column types: [{'column_name': 'year', 'new_type': 'numeric'}, {'column_name': 'quarter', 'new_type': 'numeric'}, {'column_name': 'month', 'new_type': 'numeric'}]
  
[0m14:05:59.732671 [debug] [Thread-1 (]: Timing info for model.Product_Reviews_DWH.calendar_dimension (execute): 2023-04-04 14:05:59.537212 => 2023-04-04 14:05:59.732671
[0m14:05:59.732671 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.calendar_dimension: ROLLBACK
[0m14:05:59.735089 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.calendar_dimension: Close
[0m14:05:59.751671 [debug] [Thread-1 (]: Compilation Error in model calendar_dimension (models\dimensions\calendar_dimension.sql)
  
                The source and target schemas on this incremental model are out of sync!
                They can be reconciled in several ways:
                  - set the `on_schema_change` config to either append_new_columns or sync_all_columns, depending on your situation.
                  - Re-run the incremental model with `full_refresh: True` to update the target schema.
                  - update the schema manually and re-run the process.
  
                Additional troubleshooting context:
                   Source columns not in target: []
                   Target columns not in source: []
                   New column types: [{'column_name': 'year', 'new_type': 'numeric'}, {'column_name': 'quarter', 'new_type': 'numeric'}, {'column_name': 'month', 'new_type': 'numeric'}]
            
  
  > in macro process_schema_changes (macros\materializations\models\incremental\on_schema_change.sql)
  > called by macro materialization_incremental_default (macros\materializations\models\incremental\incremental.sql)
  > called by model calendar_dimension (models\dimensions\calendar_dimension.sql)
[0m14:05:59.752671 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38f37d50-3eb0-492e-a1c6-ac5751bb772c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C88D0E6B0>]}
[0m14:05:59.753005 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model justeattakeaway.calendar_dimension . [[31mERROR[0m in 0.23s]
[0m14:05:59.753671 [debug] [Thread-1 (]: Finished running node model.Product_Reviews_DWH.calendar_dimension
[0m14:05:59.755672 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:05:59.755672 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:59.755672 [debug] [MainThread]: On master: BEGIN
[0m14:05:59.756846 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:59.885822 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:05:59.886289 [debug] [MainThread]: On master: COMMIT
[0m14:05:59.887021 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:59.887289 [debug] [MainThread]: On master: COMMIT
[0m14:05:59.887289 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:05:59.887289 [debug] [MainThread]: On master: Close
[0m14:05:59.888289 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:59.888289 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m14:05:59.888638 [debug] [MainThread]: Connection 'list_postgres_justeattakeaway' was properly closed.
[0m14:05:59.888638 [debug] [MainThread]: Connection 'model.Product_Reviews_DWH.calendar_dimension' was properly closed.
[0m14:05:59.888638 [info ] [MainThread]: 
[0m14:05:59.889289 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.68 seconds (0.68s).
[0m14:05:59.889289 [debug] [MainThread]: Command end result
[0m14:05:59.897269 [info ] [MainThread]: 
[0m14:05:59.898361 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:05:59.898361 [info ] [MainThread]: 
[0m14:05:59.898361 [error] [MainThread]: [33mCompilation Error in model calendar_dimension (models\dimensions\calendar_dimension.sql)[0m
[0m14:05:59.898361 [error] [MainThread]:   
[0m14:05:59.899290 [error] [MainThread]:                 The source and target schemas on this incremental model are out of sync!
[0m14:05:59.899290 [error] [MainThread]:                 They can be reconciled in several ways:
[0m14:05:59.899290 [error] [MainThread]:                   - set the `on_schema_change` config to either append_new_columns or sync_all_columns, depending on your situation.
[0m14:05:59.899290 [error] [MainThread]:                   - Re-run the incremental model with `full_refresh: True` to update the target schema.
[0m14:05:59.900289 [error] [MainThread]:                   - update the schema manually and re-run the process.
[0m14:05:59.900289 [error] [MainThread]:   
[0m14:05:59.900289 [error] [MainThread]:                 Additional troubleshooting context:
[0m14:05:59.900289 [error] [MainThread]:                    Source columns not in target: []
[0m14:05:59.901289 [error] [MainThread]:                    Target columns not in source: []
[0m14:05:59.901289 [error] [MainThread]:                    New column types: [{'column_name': 'year', 'new_type': 'numeric'}, {'column_name': 'quarter', 'new_type': 'numeric'}, {'column_name': 'month', 'new_type': 'numeric'}]
[0m14:05:59.901289 [error] [MainThread]:             
[0m14:05:59.901289 [error] [MainThread]:   
[0m14:05:59.902289 [error] [MainThread]:   > in macro process_schema_changes (macros\materializations\models\incremental\on_schema_change.sql)
[0m14:05:59.902289 [error] [MainThread]:   > called by macro materialization_incremental_default (macros\materializations\models\incremental\incremental.sql)
[0m14:05:59.902289 [error] [MainThread]:   > called by model calendar_dimension (models\dimensions\calendar_dimension.sql)
[0m14:05:59.902289 [info ] [MainThread]: 
[0m14:05:59.903290 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:05:59.903290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C88CAD8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C88CAD240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C88CAD090>]}
[0m14:05:59.903290 [debug] [MainThread]: Flushing usage events


============================== 2023-04-04 14:06:51.364083 | 7bc12f49-29fd-494a-b045-b31313b8297c ==============================
[0m14:06:51.364083 [info ] [MainThread]: Running with dbt=1.4.5
[0m14:06:51.365083 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Furqan\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['calendar_dimension'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:06:51.365083 [debug] [MainThread]: Tracking: tracking
[0m14:06:51.375084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001336A13ED70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001336A13DE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001336A13E7A0>]}
[0m14:06:51.387311 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m14:06:51.460847 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:06:51.461947 [debug] [MainThread]: Partial parsing: updated file: Product_Reviews_DWH://models\dimensions\calendar_dimension.sql
[0m14:06:51.472086 [debug] [MainThread]: 1603: static parser failed on dimensions\calendar_dimension.sql
[0m14:06:51.484168 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dimensions\calendar_dimension.sql
[0m14:06:51.513533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7bc12f49-29fd-494a-b045-b31313b8297c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013366A7C0D0>]}
[0m14:06:51.522735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7bc12f49-29fd-494a-b045-b31313b8297c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133669CF880>]}
[0m14:06:51.522735 [info ] [MainThread]: Found 6 models, 45 tests, 1 snapshot, 0 analyses, 403 macros, 0 operations, 0 seed files, 10 sources, 0 exposures, 0 metrics
[0m14:06:51.522735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7bc12f49-29fd-494a-b045-b31313b8297c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133669B2440>]}
[0m14:06:51.524735 [info ] [MainThread]: 
[0m14:06:51.525737 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:06:51.526990 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m14:06:51.534951 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m14:06:51.534951 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m14:06:51.535485 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:06:51.568134 [debug] [ThreadPool]: SQL status: SELECT 25 in 0 seconds
[0m14:06:51.570131 [debug] [ThreadPool]: On list_postgres: Close
[0m14:06:51.571133 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_justeattakeaway'
[0m14:06:51.576265 [debug] [ThreadPool]: Using postgres connection "list_postgres_justeattakeaway"
[0m14:06:51.576265 [debug] [ThreadPool]: On list_postgres_justeattakeaway: BEGIN
[0m14:06:51.576985 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:06:51.605855 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m14:06:51.605855 [debug] [ThreadPool]: Using postgres connection "list_postgres_justeattakeaway"
[0m14:06:51.606854 [debug] [ThreadPool]: On list_postgres_justeattakeaway: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "connection_name": "list_postgres_justeattakeaway"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'justeattakeaway'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'justeattakeaway'
  
[0m14:06:51.612986 [debug] [ThreadPool]: SQL status: SELECT 496 in 0 seconds
[0m14:06:51.618040 [debug] [ThreadPool]: On list_postgres_justeattakeaway: ROLLBACK
[0m14:06:51.619313 [debug] [ThreadPool]: On list_postgres_justeattakeaway: Close
[0m14:06:51.697958 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:51.697958 [debug] [MainThread]: On master: BEGIN
[0m14:06:51.698546 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:06:51.730609 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:06:51.731557 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:51.731557 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:06:51.754292 [debug] [MainThread]: SQL status: SELECT 9 in 0 seconds
[0m14:06:51.756295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7bc12f49-29fd-494a-b045-b31313b8297c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001336A2386D0>]}
[0m14:06:51.757293 [debug] [MainThread]: On master: ROLLBACK
[0m14:06:51.757293 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:51.757293 [debug] [MainThread]: On master: BEGIN
[0m14:06:51.758293 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:06:51.758293 [debug] [MainThread]: On master: COMMIT
[0m14:06:51.759292 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:51.759400 [debug] [MainThread]: On master: COMMIT
[0m14:06:51.759400 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:06:51.759400 [debug] [MainThread]: On master: Close
[0m14:06:51.760293 [info ] [MainThread]: Concurrency: 3 threads (target='prod')
[0m14:06:51.761084 [info ] [MainThread]: 
[0m14:06:51.764292 [debug] [Thread-1 (]: Began running node model.Product_Reviews_DWH.calendar_dimension
[0m14:06:51.765293 [info ] [Thread-1 (]: 1 of 1 START sql incremental model justeattakeaway.calendar_dimension .......... [RUN]
[0m14:06:51.765681 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Product_Reviews_DWH.calendar_dimension'
[0m14:06:51.765681 [debug] [Thread-1 (]: Began compiling node model.Product_Reviews_DWH.calendar_dimension
[0m14:06:51.771520 [debug] [Thread-1 (]: Writing injected SQL for node "model.Product_Reviews_DWH.calendar_dimension"
[0m14:06:51.772638 [debug] [Thread-1 (]: Timing info for model.Product_Reviews_DWH.calendar_dimension (compile): 2023-04-04 14:06:51.766291 => 2023-04-04 14:06:51.772638
[0m14:06:51.772638 [debug] [Thread-1 (]: Began executing node model.Product_Reviews_DWH.calendar_dimension
[0m14:06:51.818000 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.calendar_dimension"
[0m14:06:51.818000 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.calendar_dimension: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "node_id": "model.Product_Reviews_DWH.calendar_dimension"} */

    
  
    

  create temporary table "calendar_dimension__dbt_tmp170651795978"
  as (
    
WITH calendar_dimension AS (
    SELECT generate_series('1994-01-01'::date, current_date, '1 day'::interval)::date AS "date"
)
SELECT 
    "date",
    extract('year' from "date")::int4 AS year,
    extract('quarter' from "date")::int4 AS quarter,
    extract('month' from "date")::int4 AS month
FROM calendar_dimension

where "date" > coalesce((select max("date") from "postgres"."justeattakeaway"."calendar_dimension"),'1994-01-01')

ORDER BY "date"
  );
  
  
[0m14:06:51.818946 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:06:51.854984 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0 seconds
[0m14:06:51.860089 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.calendar_dimension"
[0m14:06:51.861089 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.calendar_dimension: BEGIN
[0m14:06:51.861377 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:06:51.861377 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.calendar_dimension"
[0m14:06:51.862093 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.calendar_dimension: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "node_id": "model.Product_Reviews_DWH.calendar_dimension"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'calendar_dimension__dbt_tmp170651795978'
        
      order by ordinal_position

  
[0m14:06:51.871090 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0 seconds
[0m14:06:51.875090 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.calendar_dimension"
[0m14:06:51.875090 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.calendar_dimension: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "node_id": "model.Product_Reviews_DWH.calendar_dimension"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'calendar_dimension'
        
        and table_schema = 'justeattakeaway'
        
      order by ordinal_position

  
[0m14:06:51.879089 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0 seconds
[0m14:06:51.888389 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.calendar_dimension"
[0m14:06:51.888389 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.calendar_dimension: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "node_id": "model.Product_Reviews_DWH.calendar_dimension"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'calendar_dimension__dbt_tmp170651795978'
        
      order by ordinal_position

  
[0m14:06:51.891389 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0 seconds
[0m14:06:51.894387 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.calendar_dimension"
[0m14:06:51.894781 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.calendar_dimension: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "node_id": "model.Product_Reviews_DWH.calendar_dimension"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'calendar_dimension'
        
        and table_schema = 'justeattakeaway'
        
      order by ordinal_position

  
[0m14:06:51.897388 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0 seconds
[0m14:06:51.903503 [debug] [Thread-1 (]: 
    In "postgres"."justeattakeaway"."calendar_dimension":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m14:06:51.914922 [debug] [Thread-1 (]: Writing runtime sql for node "model.Product_Reviews_DWH.calendar_dimension"
[0m14:06:51.916887 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.calendar_dimension"
[0m14:06:51.916887 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.calendar_dimension: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "Product_Reviews_DWH", "target_name": "prod", "node_id": "model.Product_Reviews_DWH.calendar_dimension"} */

      
        
            delete from "postgres"."justeattakeaway"."calendar_dimension"
            where (
                date) in (
                select (date)
                from "calendar_dimension__dbt_tmp170651795978"
            );

        
    

    insert into "postgres"."justeattakeaway"."calendar_dimension" ("date", "year", "quarter", "month")
    (
        select "date", "year", "quarter", "month"
        from "calendar_dimension__dbt_tmp170651795978"
    )
  
[0m14:06:51.922122 [debug] [Thread-1 (]: SQL status: INSERT 0 3 in 0 seconds
[0m14:06:51.932417 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.calendar_dimension: COMMIT
[0m14:06:51.932417 [debug] [Thread-1 (]: Using postgres connection "model.Product_Reviews_DWH.calendar_dimension"
[0m14:06:51.933587 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.calendar_dimension: COMMIT
[0m14:06:51.934418 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:06:51.935417 [debug] [Thread-1 (]: Timing info for model.Product_Reviews_DWH.calendar_dimension (execute): 2023-04-04 14:06:51.773397 => 2023-04-04 14:06:51.934418
[0m14:06:51.935668 [debug] [Thread-1 (]: On model.Product_Reviews_DWH.calendar_dimension: Close
[0m14:06:51.935668 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bc12f49-29fd-494a-b045-b31313b8297c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013366A44760>]}
[0m14:06:51.936676 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model justeattakeaway.calendar_dimension ..... [[32mINSERT 0 3[0m in 0.17s]
[0m14:06:51.937908 [debug] [Thread-1 (]: Finished running node model.Product_Reviews_DWH.calendar_dimension
[0m14:06:51.939727 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:06:51.939727 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:51.939727 [debug] [MainThread]: On master: BEGIN
[0m14:06:51.940676 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:06:51.968744 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:06:51.968744 [debug] [MainThread]: On master: COMMIT
[0m14:06:51.969747 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:51.969747 [debug] [MainThread]: On master: COMMIT
[0m14:06:51.970376 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:06:51.970744 [debug] [MainThread]: On master: Close
[0m14:06:51.970744 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:06:51.970744 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m14:06:51.971744 [debug] [MainThread]: Connection 'list_postgres_justeattakeaway' was properly closed.
[0m14:06:51.971744 [debug] [MainThread]: Connection 'model.Product_Reviews_DWH.calendar_dimension' was properly closed.
[0m14:06:51.971744 [info ] [MainThread]: 
[0m14:06:51.971744 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m14:06:51.972951 [debug] [MainThread]: Command end result
[0m14:06:51.981227 [info ] [MainThread]: 
[0m14:06:51.981895 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:06:51.982560 [info ] [MainThread]: 
[0m14:06:51.982560 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:06:51.982899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133669FFA60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133669B2410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001336A797580>]}
[0m14:06:51.982899 [debug] [MainThread]: Flushing usage events
